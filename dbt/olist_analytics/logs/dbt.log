[0m23:10:10.055398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d42150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122de4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122de5910>]}


============================== 23:10:10.058315 | 60a68088-458b-4376-8da3-466d8cd08673 ==============================
[0m23:10:10.058315 [info ] [MainThread]: Running with dbt=1.9.6
[0m23:10:10.058677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:10:13.118889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1781eea50>]}
[0m23:10:13.154571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c7e610>]}
[0m23:10:13.154950 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m23:10:13.373468 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m23:10:13.374067 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:10:13.374319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1785eea50>]}
[0m23:10:14.114372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17a0b1c10>]}
[0m23:10:14.162946 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m23:10:14.164160 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m23:10:14.177574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b973c90>]}
[0m23:10:14.177901 [info ] [MainThread]: Found 11 models, 4 data tests, 9 sources, 494 macros
[0m23:10:14.178103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b8f7450>]}
[0m23:10:14.179242 [info ] [MainThread]: 
[0m23:10:14.179466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:10:14.179629 [info ] [MainThread]: 
[0m23:10:14.179896 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:10:14.182237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m23:10:14.182473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:14.757597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw)
[0m23:10:14.758557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:15.170543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17a1dce50>]}
[0m23:10:15.171762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:15.178030 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m23:10:15.180319 [info ] [Thread-1 (]: 1 of 9 START sql view model olist_raw.stg_customers ............................ [RUN]
[0m23:10:15.180905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw, now model.olist_analytics.stg_customers)
[0m23:10:15.181327 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m23:10:15.190751 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m23:10:15.192084 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m23:10:15.215224 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m23:10:15.216226 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m23:10:15.216558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:15.984004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:9a3d16a6-4bf7-4e79-b969-ef274124b321&page=queryresults
[0m23:10:16.982006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b787dd0>]}
[0m23:10:16.982422 [info ] [Thread-1 (]: 1 of 9 OK created sql view model olist_raw.stg_customers ....................... [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m23:10:16.982756 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m23:10:16.982979 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m23:10:16.983261 [info ] [Thread-1 (]: 2 of 9 START sql view model olist_raw.stg_geolocation .......................... [RUN]
[0m23:10:16.983488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m23:10:16.983677 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m23:10:16.985271 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m23:10:16.985673 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m23:10:16.987186 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m23:10:16.987555 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m23:10:16.987776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:17.722426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:b2571661-6dd6-4183-ab2f-f8b7a6041dda&page=queryresults
[0m23:10:18.650833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120577990>]}
[0m23:10:18.651796 [info ] [Thread-1 (]: 2 of 9 OK created sql view model olist_raw.stg_geolocation ..................... [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m23:10:18.652336 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m23:10:18.652708 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m23:10:18.653260 [info ] [Thread-1 (]: 3 of 9 START sql view model olist_raw.stg_order_items .......................... [RUN]
[0m23:10:18.653713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m23:10:18.654050 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m23:10:18.657251 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m23:10:18.658053 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m23:10:18.660830 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m23:10:18.661787 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m23:10:18.662145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:19.229226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:b32a45fc-8e52-486c-a504-5c8c46163ea8&page=queryresults
[0m23:10:20.335312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17bfeb090>]}
[0m23:10:20.336492 [info ] [Thread-1 (]: 3 of 9 OK created sql view model olist_raw.stg_order_items ..................... [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m23:10:20.337259 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m23:10:20.337792 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m23:10:20.338516 [info ] [Thread-1 (]: 4 of 9 START sql view model olist_raw.stg_order_payments ....................... [RUN]
[0m23:10:20.339176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m23:10:20.339667 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m23:10:20.343959 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m23:10:20.344874 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m23:10:20.350058 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m23:10:20.351043 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m23:10:20.351524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:21.415587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:dc2a0533-4fbd-489c-b7f8-1968a2307b75&page=queryresults
[0m23:10:22.368527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17d921ed0>]}
[0m23:10:22.369807 [info ] [Thread-1 (]: 4 of 9 OK created sql view model olist_raw.stg_order_payments .................. [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m23:10:22.370619 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m23:10:22.371157 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m23:10:22.371858 [info ] [Thread-1 (]: 5 of 9 START sql view model olist_raw.stg_order_reviews ........................ [RUN]
[0m23:10:22.372512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m23:10:22.372992 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m23:10:22.377169 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m23:10:22.378341 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m23:10:22.381622 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m23:10:22.382561 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m23:10:22.383354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:22.956800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:65f56648-f01b-4562-a430-3686a7865984&page=queryresults
[0m23:10:23.875333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17d921ed0>]}
[0m23:10:23.876520 [info ] [Thread-1 (]: 5 of 9 OK created sql view model olist_raw.stg_order_reviews ................... [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m23:10:23.877300 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m23:10:23.877832 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m23:10:23.878552 [info ] [Thread-1 (]: 6 of 9 START sql view model olist_raw.stg_orders ............................... [RUN]
[0m23:10:23.879230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m23:10:23.879715 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m23:10:23.883864 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m23:10:23.885030 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m23:10:23.888800 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m23:10:23.889886 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m23:10:23.890344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:24.455531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:a29f23ac-36a2-4794-b672-36adb5bfb03b&page=queryresults
[0m23:10:25.208975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17d9189d0>]}
[0m23:10:25.210252 [info ] [Thread-1 (]: 6 of 9 OK created sql view model olist_raw.stg_orders .......................... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m23:10:25.211006 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m23:10:25.211565 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m23:10:25.212326 [info ] [Thread-1 (]: 7 of 9 START sql view model olist_raw.stg_product_category_name_translation .... [RUN]
[0m23:10:25.212997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m23:10:25.213511 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m23:10:25.218059 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m23:10:25.219351 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m23:10:25.223103 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m23:10:25.224320 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed;


[0m23:10:25.224812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:26.137833 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:ae92689e-c89c-40d2-b49f-631ed440559c&page=queryresults
[0m23:10:26.633008 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:ae92689e-c89c-40d2-b49f-631ed440559c&page=queryresults
[0m23:10:26.650774 [debug] [Thread-1 (]: Database Error in model stg_product_category_name_translation (models/staging/stg_product_category_name_translation.sql)
  Unrecognized name: product_category_name at [12:9]
  compiled code at target/run/olist_analytics/models/staging/stg_product_category_name_translation.sql
[0m23:10:26.651644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17d88d510>]}
[0m23:10:26.652352 [error] [Thread-1 (]: 7 of 9 ERROR creating sql view model olist_raw.stg_product_category_name_translation  [[31mERROR[0m in 1.44s]
[0m23:10:26.652909 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m23:10:26.653310 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m23:10:26.654046 [debug] [Thread-4 (]: Marking all children of 'model.olist_analytics.stg_product_category_name_translation' to be skipped because of status 'error'.  Reason: Database Error in model stg_product_category_name_translation (models/staging/stg_product_category_name_translation.sql)
  Unrecognized name: product_category_name at [12:9]
  compiled code at target/run/olist_analytics/models/staging/stg_product_category_name_translation.sql.
[0m23:10:26.654848 [info ] [Thread-1 (]: 8 of 9 START sql view model olist_raw.stg_products ............................. [RUN]
[0m23:10:26.656544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m23:10:26.656950 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m23:10:26.660567 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m23:10:26.661632 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m23:10:26.664376 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m23:10:26.664999 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m23:10:26.665370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:27.420096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:e2e78ba7-114e-478b-aba4-868469b49f91&page=queryresults
[0m23:10:28.585012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17d82ffd0>]}
[0m23:10:28.586273 [info ] [Thread-1 (]: 8 of 9 OK created sql view model olist_raw.stg_products ........................ [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m23:10:28.587082 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m23:10:28.587617 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m23:10:28.588168 [info ] [Thread-1 (]: 9 of 9 START sql view model olist_raw.stg_sellers .............................. [RUN]
[0m23:10:28.588702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m23:10:28.589299 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m23:10:28.596077 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m23:10:28.597219 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m23:10:28.600523 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m23:10:28.601674 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m23:10:28.602128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:29.191929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:64c913da-5470-4d5e-adb8-4633c37013dd&page=queryresults
[0m23:10:30.221652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a68088-458b-4376-8da3-466d8cd08673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17dc01650>]}
[0m23:10:30.222745 [info ] [Thread-1 (]: 9 of 9 OK created sql view model olist_raw.stg_sellers ......................... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m23:10:30.223511 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m23:10:30.225281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:10:30.226011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:30.226372 [debug] [MainThread]: Connection 'model.olist_analytics.stg_sellers' was properly closed.
[0m23:10:30.226851 [info ] [MainThread]: 
[0m23:10:30.227249 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 16.05 seconds (16.05s).
[0m23:10:30.229043 [debug] [MainThread]: Command end result
[0m23:10:30.254060 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m23:10:30.255652 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m23:10:30.260238 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m23:10:30.260504 [info ] [MainThread]: 
[0m23:10:30.260767 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:10:30.260979 [info ] [MainThread]: 
[0m23:10:30.261243 [error] [MainThread]:   Database Error in model stg_product_category_name_translation (models/staging/stg_product_category_name_translation.sql)
  Unrecognized name: product_category_name at [12:9]
  compiled code at target/run/olist_analytics/models/staging/stg_product_category_name_translation.sql
[0m23:10:30.261462 [info ] [MainThread]: 
[0m23:10:30.261680 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m23:10:30.262079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.250414, "process_in_blocks": "0", "process_kernel_time": 2.696252, "process_mem_max_rss": "478380032", "process_out_blocks": "0", "process_user_time": 5.099797}
[0m23:10:30.262390 [debug] [MainThread]: Command `dbt run` failed at 23:10:30.262337 after 20.25 seconds
[0m23:10:30.262677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d30690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b8969d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b845290>]}
[0m23:10:30.262929 [debug] [MainThread]: Flushing usage events
[0m23:10:32.467658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:38.135917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df52710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfe58d0>]}


============================== 23:13:38.138874 | 15f5faed-b8ab-42e0-b8e6-e8081cece860 ==============================
[0m23:13:38.138874 [info ] [MainThread]: Running with dbt=1.9.6
[0m23:13:38.139227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m23:13:40.558468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b622910>]}
[0m23:13:40.594243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f796d0>]}
[0m23:13:40.594624 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m23:13:40.764098 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m23:13:40.844741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:13:40.845144 [debug] [MainThread]: Partial parsing: updated file: olist_analytics://models/staging/stg_product_category_name_translation.sql
[0m23:13:41.000516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bf01590>]}
[0m23:13:41.044499 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m23:13:41.045744 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m23:13:41.058344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c156410>]}
[0m23:13:41.058706 [info ] [MainThread]: Found 11 models, 4 data tests, 9 sources, 494 macros
[0m23:13:41.058916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b6c7410>]}
[0m23:13:41.060053 [info ] [MainThread]: 
[0m23:13:41.060271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:41.060436 [info ] [MainThread]: 
[0m23:13:41.060723 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:13:41.063015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m23:13:41.063237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:41.617682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw)
[0m23:13:41.618894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:13:42.020757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b6fba10>]}
[0m23:13:42.022164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:42.027965 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m23:13:42.028694 [info ] [Thread-1 (]: 1 of 9 START sql view model olist_raw.stg_customers ............................ [RUN]
[0m23:13:42.029245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw, now model.olist_analytics.stg_customers)
[0m23:13:42.029625 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m23:13:42.039629 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m23:13:42.040762 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m23:13:42.064468 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m23:13:42.065164 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m23:13:42.065467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:42.731533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:49283833-f7e5-4f8e-90c5-a45d5edb2f50&page=queryresults
[0m23:13:43.512187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17e18fd90>]}
[0m23:13:43.512659 [info ] [Thread-1 (]: 1 of 9 OK created sql view model olist_raw.stg_customers ....................... [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m23:13:43.513027 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m23:13:43.513269 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m23:13:43.513551 [info ] [Thread-1 (]: 2 of 9 START sql view model olist_raw.stg_geolocation .......................... [RUN]
[0m23:13:43.513858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m23:13:43.514121 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m23:13:43.515863 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m23:13:43.516305 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m23:13:43.518097 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m23:13:43.518480 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m23:13:43.518729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:44.081057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:f965ac8d-f5cf-4d33-982f-e35daf7b5b96&page=queryresults
[0m23:13:45.220157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17e0fb050>]}
[0m23:13:45.221462 [info ] [Thread-1 (]: 2 of 9 OK created sql view model olist_raw.stg_geolocation ..................... [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m23:13:45.222239 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m23:13:45.222782 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m23:13:45.223529 [info ] [Thread-1 (]: 3 of 9 START sql view model olist_raw.stg_order_items .......................... [RUN]
[0m23:13:45.224231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m23:13:45.224695 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m23:13:45.228910 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m23:13:45.229872 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m23:13:45.232872 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m23:13:45.234038 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m23:13:45.234648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:45.802935 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:6ae8fe12-02b4-4a61-bb48-3f45c6ed6534&page=queryresults
[0m23:13:46.627762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f49ad90>]}
[0m23:13:46.629934 [info ] [Thread-1 (]: 3 of 9 OK created sql view model olist_raw.stg_order_items ..................... [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m23:13:46.630709 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m23:13:46.631184 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m23:13:46.631679 [info ] [Thread-1 (]: 4 of 9 START sql view model olist_raw.stg_order_payments ....................... [RUN]
[0m23:13:46.632249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m23:13:46.632681 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m23:13:46.636701 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m23:13:46.637682 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m23:13:46.640680 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m23:13:46.641600 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m23:13:46.642012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:47.355463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:d19f29f9-af38-4546-a206-873d64e375a8&page=queryresults
[0m23:13:48.163765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17e0b6850>]}
[0m23:13:48.164975 [info ] [Thread-1 (]: 4 of 9 OK created sql view model olist_raw.stg_order_payments .................. [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m23:13:48.165762 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m23:13:48.166297 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m23:13:48.167030 [info ] [Thread-1 (]: 5 of 9 START sql view model olist_raw.stg_order_reviews ........................ [RUN]
[0m23:13:48.167701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m23:13:48.168199 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m23:13:48.172488 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m23:13:48.173671 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m23:13:48.178985 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m23:13:48.180265 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m23:13:48.180853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:48.937641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:4e4699a1-30df-4133-88e9-dd1fcf7e3d7e&page=queryresults
[0m23:13:49.600577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f5b7990>]}
[0m23:13:49.601709 [info ] [Thread-1 (]: 5 of 9 OK created sql view model olist_raw.stg_order_reviews ................... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m23:13:49.602460 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m23:13:49.602975 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m23:13:49.603700 [info ] [Thread-1 (]: 6 of 9 START sql view model olist_raw.stg_orders ............................... [RUN]
[0m23:13:49.604368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m23:13:49.604846 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m23:13:49.608831 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m23:13:49.609912 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m23:13:49.613062 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m23:13:49.613883 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m23:13:49.614308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:50.310033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:f3998e40-7bd2-4a82-88a5-8c7d0f973dc1&page=queryresults
[0m23:13:51.030000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f463950>]}
[0m23:13:51.031185 [info ] [Thread-1 (]: 6 of 9 OK created sql view model olist_raw.stg_orders .......................... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m23:13:51.031969 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m23:13:51.032498 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m23:13:51.033215 [info ] [Thread-1 (]: 7 of 9 START sql view model olist_raw.stg_product_category_name_translation .... [RUN]
[0m23:13:51.033846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m23:13:51.034342 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m23:13:51.038319 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m23:13:51.039473 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m23:13:51.042789 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m23:13:51.043594 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        product_category_name_english
    from source
)

select * from renamed;


[0m23:13:51.043994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:51.742185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3f33ad1b-1875-4650-bfd8-9fd88ef315c3&page=queryresults
[0m23:13:52.050313 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3f33ad1b-1875-4650-bfd8-9fd88ef315c3&page=queryresults
[0m23:13:52.067208 [debug] [Thread-1 (]: Database Error in model stg_product_category_name_translation (models/staging/stg_product_category_name_translation.sql)
  Unrecognized name: product_category_name_english at [13:9]
  compiled code at target/run/olist_analytics/models/staging/stg_product_category_name_translation.sql
[0m23:13:52.068049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f5100d0>]}
[0m23:13:52.068832 [error] [Thread-1 (]: 7 of 9 ERROR creating sql view model olist_raw.stg_product_category_name_translation  [[31mERROR[0m in 1.03s]
[0m23:13:52.069380 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m23:13:52.069779 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m23:13:52.070287 [debug] [Thread-4 (]: Marking all children of 'model.olist_analytics.stg_product_category_name_translation' to be skipped because of status 'error'.  Reason: Database Error in model stg_product_category_name_translation (models/staging/stg_product_category_name_translation.sql)
  Unrecognized name: product_category_name_english at [13:9]
  compiled code at target/run/olist_analytics/models/staging/stg_product_category_name_translation.sql.
[0m23:13:52.070793 [info ] [Thread-1 (]: 8 of 9 START sql view model olist_raw.stg_products ............................. [RUN]
[0m23:13:52.072084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m23:13:52.072464 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m23:13:52.076269 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m23:13:52.077044 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m23:13:52.079575 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m23:13:52.080174 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m23:13:52.080541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:52.663999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:6b86107c-2f45-45da-8602-bd7dd1963f56&page=queryresults
[0m23:13:53.385884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17c275010>]}
[0m23:13:53.387137 [info ] [Thread-1 (]: 8 of 9 OK created sql view model olist_raw.stg_products ........................ [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m23:13:53.387901 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m23:13:53.388425 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m23:13:53.389144 [info ] [Thread-1 (]: 9 of 9 START sql view model olist_raw.stg_sellers .............................. [RUN]
[0m23:13:53.389819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m23:13:53.390306 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m23:13:53.394107 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m23:13:53.395160 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m23:13:53.398378 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m23:13:53.399098 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m23:13:53.399494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:13:54.102091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:965ebc88-891d-44af-994b-e2226fc248cc&page=queryresults
[0m23:13:54.820888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f5faed-b8ab-42e0-b8e6-e8081cece860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f532e90>]}
[0m23:13:54.822046 [info ] [Thread-1 (]: 9 of 9 OK created sql view model olist_raw.stg_sellers ......................... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m23:13:54.822797 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m23:13:54.824593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:54.825354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:54.825745 [debug] [MainThread]: Connection 'model.olist_analytics.stg_sellers' was properly closed.
[0m23:13:54.826304 [info ] [MainThread]: 
[0m23:13:54.826713 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 13.77 seconds (13.77s).
[0m23:13:54.828512 [debug] [MainThread]: Command end result
[0m23:13:54.855155 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m23:13:54.856775 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m23:13:54.861216 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m23:13:54.861468 [info ] [MainThread]: 
[0m23:13:54.861742 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:13:54.861957 [info ] [MainThread]: 
[0m23:13:54.862223 [error] [MainThread]:   Database Error in model stg_product_category_name_translation (models/staging/stg_product_category_name_translation.sql)
  Unrecognized name: product_category_name_english at [13:9]
  compiled code at target/run/olist_analytics/models/staging/stg_product_category_name_translation.sql
[0m23:13:54.862440 [info ] [MainThread]: 
[0m23:13:54.862670 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m23:13:54.863061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.768158, "process_in_blocks": "0", "process_kernel_time": 2.766903, "process_mem_max_rss": "474906624", "process_out_blocks": "0", "process_user_time": 4.419371}
[0m23:13:54.863375 [debug] [MainThread]: Command `dbt run` failed at 23:13:54.863323 after 16.77 seconds
[0m23:13:54.863666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d044410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c17e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c17290>]}
[0m23:13:54.863915 [debug] [MainThread]: Flushing usage events
[0m23:13:56.861106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:44.946434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113730910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137e4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137e55d0>]}


============================== 23:14:44.949345 | 2a058fa3-7c10-40fa-85f9-f4977c9a6a55 ==============================
[0m23:14:44.949345 [info ] [MainThread]: Running with dbt=1.9.6
[0m23:14:44.949714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'debug': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:14:47.074799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b2c5010>]}
[0m23:14:47.110557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11097f150>]}
[0m23:14:47.110944 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m23:14:47.275722 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m23:14:47.352595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:14:47.353029 [debug] [MainThread]: Partial parsing: updated file: olist_analytics://models/staging/stg_product_category_name_translation.sql
[0m23:14:47.508526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b8d5690>]}
[0m23:14:47.553401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m23:14:47.554566 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m23:14:47.566998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b523e50>]}
[0m23:14:47.567332 [info ] [MainThread]: Found 11 models, 4 data tests, 9 sources, 494 macros
[0m23:14:47.567538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b5091d0>]}
[0m23:14:47.568673 [info ] [MainThread]: 
[0m23:14:47.568884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:14:47.569049 [info ] [MainThread]: 
[0m23:14:47.569331 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:14:47.571648 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m23:14:47.571879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:48.072663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw)
[0m23:14:48.073693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:14:48.479254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b606f10>]}
[0m23:14:48.480337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:48.485490 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m23:14:48.486081 [info ] [Thread-1 (]: 1 of 9 START sql view model olist_raw.stg_customers ............................ [RUN]
[0m23:14:48.486602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw, now model.olist_analytics.stg_customers)
[0m23:14:48.486978 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m23:14:48.495538 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m23:14:48.496357 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m23:14:48.519171 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m23:14:48.519871 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m23:14:48.520175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:49.291682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:ef28b61c-0760-4d74-8418-8c09a4425deb&page=queryresults
[0m23:14:49.976754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b5303d0>]}
[0m23:14:49.977228 [info ] [Thread-1 (]: 1 of 9 OK created sql view model olist_raw.stg_customers ....................... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m23:14:49.977586 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m23:14:49.977823 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m23:14:49.978151 [info ] [Thread-1 (]: 2 of 9 START sql view model olist_raw.stg_geolocation .......................... [RUN]
[0m23:14:49.978443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m23:14:49.978659 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m23:14:49.980349 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m23:14:49.980770 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m23:14:49.982492 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m23:14:49.982863 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m23:14:49.983097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:50.726295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:19829d64-f308-4ac4-b284-e8527c9daa2f&page=queryresults
[0m23:14:51.449618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b2a5350>]}
[0m23:14:51.451085 [info ] [Thread-1 (]: 2 of 9 OK created sql view model olist_raw.stg_geolocation ..................... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m23:14:51.451859 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m23:14:51.452390 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m23:14:51.452964 [info ] [Thread-1 (]: 3 of 9 START sql view model olist_raw.stg_order_items .......................... [RUN]
[0m23:14:51.453675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m23:14:51.454238 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m23:14:51.458482 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m23:14:51.459566 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m23:14:51.463154 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m23:14:51.464113 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m23:14:51.464566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:52.158855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:65764501-8595-4d87-8dfc-7ac1e46f6490&page=queryresults
[0m23:14:52.881073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17d5c5650>]}
[0m23:14:52.882280 [info ] [Thread-1 (]: 3 of 9 OK created sql view model olist_raw.stg_order_items ..................... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m23:14:52.883040 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m23:14:52.883587 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m23:14:52.884323 [info ] [Thread-1 (]: 4 of 9 START sql view model olist_raw.stg_order_payments ....................... [RUN]
[0m23:14:52.885000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m23:14:52.885498 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m23:14:52.889510 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m23:14:52.890727 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m23:14:52.894191 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m23:14:52.894970 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m23:14:52.895595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:53.594169 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:23c49b88-08e7-4e1d-a103-5a38245b496f&page=queryresults
[0m23:14:54.318495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17fa06bd0>]}
[0m23:14:54.319758 [info ] [Thread-1 (]: 4 of 9 OK created sql view model olist_raw.stg_order_payments .................. [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m23:14:54.320544 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m23:14:54.321072 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m23:14:54.321630 [info ] [Thread-1 (]: 5 of 9 START sql view model olist_raw.stg_order_reviews ........................ [RUN]
[0m23:14:54.322302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m23:14:54.322857 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m23:14:54.326815 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m23:14:54.327806 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m23:14:54.333025 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m23:14:54.334145 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m23:14:54.334632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:55.026100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:ea106f46-e236-4d94-b86d-d6762ade45d3&page=queryresults
[0m23:14:55.748686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17fb4ae50>]}
[0m23:14:55.749862 [info ] [Thread-1 (]: 5 of 9 OK created sql view model olist_raw.stg_order_reviews ................... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m23:14:55.750524 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m23:14:55.750983 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m23:14:55.751616 [info ] [Thread-1 (]: 6 of 9 START sql view model olist_raw.stg_orders ............................... [RUN]
[0m23:14:55.752183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m23:14:55.752601 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m23:14:55.756424 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m23:14:55.757307 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m23:14:55.760223 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m23:14:55.761084 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m23:14:55.761559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:56.363314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:0a67779f-ee20-4d26-91a2-6225278159d5&page=queryresults
[0m23:14:57.012994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f9f7a50>]}
[0m23:14:57.014165 [info ] [Thread-1 (]: 6 of 9 OK created sql view model olist_raw.stg_orders .......................... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m23:14:57.014920 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m23:14:57.015466 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m23:14:57.016204 [info ] [Thread-1 (]: 7 of 9 START sql view model olist_raw.stg_product_category_name_translation .... [RUN]
[0m23:14:57.016860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m23:14:57.017360 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m23:14:57.021562 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m23:14:57.022701 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m23:14:57.026310 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m23:14:57.027143 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m23:14:57.027556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:57.895501 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:fff2cf36-50e3-4b19-b629-4ae7797712c7&page=queryresults
[0m23:14:58.615083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17fa69e50>]}
[0m23:14:58.616270 [info ] [Thread-1 (]: 7 of 9 OK created sql view model olist_raw.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m23:14:58.617040 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m23:14:58.617580 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m23:14:58.618380 [info ] [Thread-1 (]: 8 of 9 START sql view model olist_raw.stg_products ............................. [RUN]
[0m23:14:58.619046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m23:14:58.619546 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m23:14:58.623689 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m23:14:58.624873 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m23:14:58.628579 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m23:14:58.629488 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m23:14:58.629928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:14:59.227438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:c80efc01-ffb0-4f2b-94bd-7ede4966d50a&page=queryresults
[0m23:15:00.067079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17fb6c590>]}
[0m23:15:00.067798 [info ] [Thread-1 (]: 8 of 9 OK created sql view model olist_raw.stg_products ........................ [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m23:15:00.068132 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m23:15:00.068355 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m23:15:00.068681 [info ] [Thread-1 (]: 9 of 9 START sql view model olist_raw.stg_sellers .............................. [RUN]
[0m23:15:00.068963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m23:15:00.069173 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m23:15:00.071026 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m23:15:00.071461 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m23:15:00.072997 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m23:15:00.073375 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m23:15:00.073601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:00.726897 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:5b02a2e5-eeab-40ab-a5ae-9d23049490b3&page=queryresults
[0m23:15:01.486687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a058fa3-7c10-40fa-85f9-f4977c9a6a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17fab8f90>]}
[0m23:15:01.487940 [info ] [Thread-1 (]: 9 of 9 OK created sql view model olist_raw.stg_sellers ......................... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m23:15:01.488684 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m23:15:01.490459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:15:01.491224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:01.491620 [debug] [MainThread]: Connection 'model.olist_analytics.stg_sellers' was properly closed.
[0m23:15:01.492107 [info ] [MainThread]: 
[0m23:15:01.492501 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 13.92 seconds (13.92s).
[0m23:15:01.494272 [debug] [MainThread]: Command end result
[0m23:15:01.522876 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m23:15:01.524436 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m23:15:01.528800 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m23:15:01.529044 [info ] [MainThread]: 
[0m23:15:01.529325 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:15:01.529543 [info ] [MainThread]: 
[0m23:15:01.529787 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m23:15:01.530290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.626472, "process_in_blocks": "0", "process_kernel_time": 2.667196, "process_mem_max_rss": "472137728", "process_out_blocks": "0", "process_user_time": 4.405531}
[0m23:15:01.530631 [debug] [MainThread]: Command `dbt run` succeeded at 23:15:01.530573 after 16.63 seconds
[0m23:15:01.530926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137b8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113575690>]}
[0m23:15:01.531189 [debug] [MainThread]: Flushing usage events
[0m23:15:02.963293 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:25.631441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a184090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20d510>]}


============================== 00:06:25.635033 | 793d3005-caf4-4d42-9b19-7bb440099e6b ==============================
[0m00:06:25.635033 [info ] [MainThread]: Running with dbt=1.9.6
[0m00:06:25.635547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:06:28.744944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a194290>]}
[0m00:06:28.782357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107916b50>]}
[0m00:06:28.782789 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m00:06:28.951819 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m00:06:29.004138 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:06:29.004496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a5dd0>]}
[0m00:06:29.745719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30c2ec550>]}
[0m00:06:29.789674 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m00:06:29.790833 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m00:06:29.804602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30ef53ed0>]}
[0m00:06:29.804933 [info ] [MainThread]: Found 18 models, 4 data tests, 9 sources, 494 macros
[0m00:06:29.805132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30ee37510>]}
[0m00:06:29.806527 [info ] [MainThread]: 
[0m00:06:29.806747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:29.806909 [info ] [MainThread]: 
[0m00:06:29.807176 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:06:29.809735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m00:06:29.809972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:30.340077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:30.845113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:31.255515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now create_stellar-verve-478012-n6_olist_raw_staging)
[0m00:06:31.258256 [debug] [ThreadPool]: Creating schema "database: "stellar-verve-478012-n6"
schema: "olist_raw_staging"
"
[0m00:06:31.270333 [debug] [ThreadPool]: On create_stellar-verve-478012-n6_olist_raw_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "connection_name": "create_stellar-verve-478012-n6_olist_raw_staging"} */
create schema if not exists `stellar-verve-478012-n6`.`olist_raw_staging`
  
[0m00:06:31.270860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:31.762802 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:33dc81ce-9ed0-4efb-b222-cf0e7471a780&page=queryresults
[0m00:06:32.847622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_stellar-verve-478012-n6_olist_raw_staging, now create_stellar-verve-478012-n6_olist_raw_analytics)
[0m00:06:32.848041 [debug] [ThreadPool]: Creating schema "database: "stellar-verve-478012-n6"
schema: "olist_raw_analytics"
"
[0m00:06:32.849400 [debug] [ThreadPool]: On create_stellar-verve-478012-n6_olist_raw_analytics: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "connection_name": "create_stellar-verve-478012-n6_olist_raw_analytics"} */
create schema if not exists `stellar-verve-478012-n6`.`olist_raw_analytics`
  
[0m00:06:32.849620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:33.297191 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:c96d8389-07ad-4f2f-8c0c-fa7fb4e92d6c&page=queryresults
[0m00:06:34.220061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_stellar-verve-478012-n6_olist_raw_analytics, now list_stellar-verve-478012-n6_olist_raw_staging)
[0m00:06:34.220584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:34.632411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_staging, now list_stellar-verve-478012-n6_olist_raw_analytics)
[0m00:06:34.633493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:35.039152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_analytics, now list_stellar-verve-478012-n6_olist_raw)
[0m00:06:35.039905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:35.431048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30c635510>]}
[0m00:06:35.431544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:35.434848 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_date
[0m00:06:35.435266 [info ] [Thread-1 (]: 1 of 18 START sql table model olist_raw_analytics.dim_date ..................... [RUN]
[0m00:06:35.435551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw, now model.olist_analytics.dim_date)
[0m00:06:35.435753 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_date
[0m00:06:35.439773 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_date"
[0m00:06:35.440725 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_date
[0m00:06:35.463783 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_date"
[0m00:06:35.464913 [debug] [Thread-1 (]: On model.olist_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_date"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_date`
      
    
    

    OPTIONS()
    as (
      -- Standard BigQuery SQL to generate dates
with date_spine as (
  select 
    * from 
    unnest(generate_date_array('2016-01-01', '2020-01-01', interval 1 day)) as date_day
)

select
  date_day,
  extract(year from date_day) as year,
  extract(month from date_day) as month,
  extract(day from date_day) as day,
  extract(dayofweek from date_day) as day_of_week,
  format_date('%B', date_day) as month_name,
  format_date('%A', date_day) as day_name,
  case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend
from date_spine
    );
  
[0m00:06:35.465251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:36.060766 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:87e7e67c-92b1-4e00-b08f-eead1cab3efa&page=queryresults
[0m00:06:38.229863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30ef1d910>]}
[0m00:06:38.230597 [info ] [Thread-1 (]: 1 of 18 OK created sql table model olist_raw_analytics.dim_date ................ [[32mCREATE TABLE (1.5k rows, 0 processed)[0m in 2.79s]
[0m00:06:38.231146 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_date
[0m00:06:38.231616 [debug] [Thread-1 (]: Began running node model.olist_analytics.my_first_dbt_model
[0m00:06:38.232133 [info ] [Thread-1 (]: 2 of 18 START sql table model olist_raw.my_first_dbt_model ..................... [RUN]
[0m00:06:38.232572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_date, now model.olist_analytics.my_first_dbt_model)
[0m00:06:38.232851 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.my_first_dbt_model
[0m00:06:38.235086 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.my_first_dbt_model"
[0m00:06:38.235842 [debug] [Thread-1 (]: Began executing node model.olist_analytics.my_first_dbt_model
[0m00:06:38.238063 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.my_first_dbt_model"
[0m00:06:38.238843 [debug] [Thread-1 (]: On model.olist_analytics.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.my_first_dbt_model"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m00:06:38.239277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:38.866536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:90fb0d71-35ff-4fa5-8dd0-c6e97603c0be&page=queryresults
[0m00:06:40.900610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30ef08110>]}
[0m00:06:40.901876 [info ] [Thread-1 (]: 2 of 18 OK created sql table model olist_raw.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.67s]
[0m00:06:40.902659 [debug] [Thread-1 (]: Finished running node model.olist_analytics.my_first_dbt_model
[0m00:06:40.903180 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m00:06:40.903928 [info ] [Thread-1 (]: 3 of 18 START sql view model olist_raw_staging.stg_customers ................... [RUN]
[0m00:06:40.904694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.my_first_dbt_model, now model.olist_analytics.stg_customers)
[0m00:06:40.905188 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m00:06:40.909228 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m00:06:40.910535 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m00:06:40.929323 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m00:06:40.930105 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m00:06:40.930442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:41.592937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:adedfa3e-1fcf-404b-a6c7-a211c48dc29e&page=queryresults
[0m00:06:42.411795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x310650510>]}
[0m00:06:42.412329 [info ] [Thread-1 (]: 3 of 18 OK created sql view model olist_raw_staging.stg_customers .............. [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m00:06:42.412684 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m00:06:42.412935 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m00:06:42.413189 [info ] [Thread-1 (]: 4 of 18 START sql view model olist_raw_staging.stg_geolocation ................. [RUN]
[0m00:06:42.413558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m00:06:42.413820 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m00:06:42.415616 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m00:06:42.416095 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m00:06:42.417813 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m00:06:42.418247 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m00:06:42.418628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:43.129151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:af89e1b5-7df8-4314-864c-5df17d602292&page=queryresults
[0m00:06:43.949750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x310651410>]}
[0m00:06:43.950301 [info ] [Thread-1 (]: 4 of 18 OK created sql view model olist_raw_staging.stg_geolocation ............ [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m00:06:43.950687 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m00:06:43.950942 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m00:06:43.951207 [info ] [Thread-1 (]: 5 of 18 START sql view model olist_raw_staging.stg_order_items ................. [RUN]
[0m00:06:43.951470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m00:06:43.951688 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m00:06:43.953603 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m00:06:43.954131 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m00:06:43.957462 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m00:06:43.958018 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m00:06:43.958265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:44.565025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:d07dba90-c1fb-415c-8b93-fdad4189e51c&page=queryresults
[0m00:06:45.284487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3106a4810>]}
[0m00:06:45.285777 [info ] [Thread-1 (]: 5 of 18 OK created sql view model olist_raw_staging.stg_order_items ............ [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m00:06:45.286677 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m00:06:45.287214 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m00:06:45.287884 [info ] [Thread-1 (]: 6 of 18 START sql view model olist_raw_staging.stg_order_payments .............. [RUN]
[0m00:06:45.288505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m00:06:45.288939 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m00:06:45.292879 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m00:06:45.293866 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m00:06:45.297163 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m00:06:45.298239 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m00:06:45.299035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:45.920140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:9ae54fb3-6fc3-4b70-a666-597de7b9a444&page=queryresults
[0m00:06:46.615554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x31066e290>]}
[0m00:06:46.616715 [info ] [Thread-1 (]: 6 of 18 OK created sql view model olist_raw_staging.stg_order_payments ......... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m00:06:46.617489 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m00:06:46.618009 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m00:06:46.618563 [info ] [Thread-1 (]: 7 of 18 START sql view model olist_raw_staging.stg_order_reviews ............... [RUN]
[0m00:06:46.619117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m00:06:46.619575 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m00:06:46.624123 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m00:06:46.625289 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m00:06:46.628517 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m00:06:46.629188 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m00:06:46.629612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:47.328901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:bab429f6-9748-4167-9868-5dc19053ffb9&page=queryresults
[0m00:06:47.942359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x31059d1d0>]}
[0m00:06:47.943680 [info ] [Thread-1 (]: 7 of 18 OK created sql view model olist_raw_staging.stg_order_reviews .......... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m00:06:47.944497 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m00:06:47.945048 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m00:06:47.945773 [info ] [Thread-1 (]: 8 of 18 START sql view model olist_raw_staging.stg_orders ...................... [RUN]
[0m00:06:47.946438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m00:06:47.946930 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m00:06:47.951359 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m00:06:47.953859 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m00:06:47.956894 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m00:06:47.957901 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m00:06:47.958379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:48.529125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:13d36b86-c127-4ed3-9344-e1514ae888ee&page=queryresults
[0m00:06:49.281725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x31066e4d0>]}
[0m00:06:49.282981 [info ] [Thread-1 (]: 8 of 18 OK created sql view model olist_raw_staging.stg_orders ................. [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m00:06:49.283745 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m00:06:49.284294 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m00:06:49.285071 [info ] [Thread-1 (]: 9 of 18 START sql view model olist_raw_staging.stg_product_category_name_translation  [RUN]
[0m00:06:49.285882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m00:06:49.286447 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m00:06:49.290436 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m00:06:49.291563 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m00:06:49.294764 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m00:06:49.295631 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m00:06:49.296084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:49.995983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:6ba21b45-09b5-4faa-9361-8436c08d5aa5&page=queryresults
[0m00:06:50.819705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3106bd650>]}
[0m00:06:50.821031 [info ] [Thread-1 (]: 9 of 18 OK created sql view model olist_raw_staging.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m00:06:50.821797 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m00:06:50.822354 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m00:06:50.822914 [info ] [Thread-1 (]: 10 of 18 START sql view model olist_raw_staging.stg_products ................... [RUN]
[0m00:06:50.823465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m00:06:50.823917 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m00:06:50.831076 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m00:06:50.832297 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m00:06:50.835221 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m00:06:50.835916 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m00:06:50.836360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:51.432051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:e09df40c-32d4-4590-9228-9c4b6aee8c08&page=queryresults
[0m00:06:52.054416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x31055bb50>]}
[0m00:06:52.055590 [info ] [Thread-1 (]: 10 of 18 OK created sql view model olist_raw_staging.stg_products .............. [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m00:06:52.056661 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m00:06:52.057279 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m00:06:52.058026 [info ] [Thread-1 (]: 11 of 18 START sql view model olist_raw_staging.stg_sellers .................... [RUN]
[0m00:06:52.058805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m00:06:52.059278 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m00:06:52.063605 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m00:06:52.066260 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m00:06:52.069556 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m00:06:52.070283 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m00:06:52.070714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:52.676455 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:e82b460e-9c62-44e9-a8be-c8d2a8a4cc13&page=queryresults
[0m00:06:53.374283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x310573290>]}
[0m00:06:53.375584 [info ] [Thread-1 (]: 11 of 18 OK created sql view model olist_raw_staging.stg_sellers ............... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m00:06:53.376332 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m00:06:53.376857 [debug] [Thread-1 (]: Began running node model.olist_analytics.my_second_dbt_model
[0m00:06:53.377402 [info ] [Thread-1 (]: 12 of 18 START sql view model olist_raw.my_second_dbt_model .................... [RUN]
[0m00:06:53.377942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_sellers, now model.olist_analytics.my_second_dbt_model)
[0m00:06:53.378576 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.my_second_dbt_model
[0m00:06:53.382973 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.my_second_dbt_model"
[0m00:06:53.384284 [debug] [Thread-1 (]: Began executing node model.olist_analytics.my_second_dbt_model
[0m00:06:53.387447 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.my_second_dbt_model"
[0m00:06:53.388155 [debug] [Thread-1 (]: On model.olist_analytics.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.my_second_dbt_model"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `stellar-verve-478012-n6`.`olist_raw`.`my_first_dbt_model`
where id = 1;


[0m00:06:53.388560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:53.996495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:27aec812-e6ad-4798-8457-8e0217b612c9&page=queryresults
[0m00:06:54.810320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x310629650>]}
[0m00:06:54.811547 [info ] [Thread-1 (]: 12 of 18 OK created sql view model olist_raw.my_second_dbt_model ............... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m00:06:54.812315 [debug] [Thread-1 (]: Finished running node model.olist_analytics.my_second_dbt_model
[0m00:06:54.812841 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_customers
[0m00:06:54.813386 [info ] [Thread-1 (]: 13 of 18 START sql table model olist_raw_analytics.dim_customers ............... [RUN]
[0m00:06:54.813928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.my_second_dbt_model, now model.olist_analytics.dim_customers)
[0m00:06:54.814543 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_customers
[0m00:06:54.818372 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m00:06:54.819716 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_customers
[0m00:06:54.823205 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m00:06:54.824164 [debug] [Thread-1 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
),

unique_customers as (
    -- Deduplicate to get one row per unique person
    select
        customer_unique_id,
        -- We use MAX/ANY_VALUE to just grab one valid location per person
        -- In a real scenario, you might want their "current" address logic
        max(zip_code) as zip_code,
        max(city) as city,
        max(state) as state
    from customers
    group by customer_unique_id
)

select
    customer_unique_id,
    zip_code,
    city,
    state
from unique_customers
    );
  
[0m00:06:54.824619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:55.730299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:0f40f11c-1cb4-4abd-8144-d2f821fe4313&page=queryresults
[0m00:06:59.528214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x31055d6d0>]}
[0m00:06:59.529767 [info ] [Thread-1 (]: 13 of 18 OK created sql table model olist_raw_analytics.dim_customers .......... [[32mCREATE TABLE (96.1k rows, 8.6 MiB processed)[0m in 4.71s]
[0m00:06:59.530371 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_customers
[0m00:06:59.530757 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_geolocation
[0m00:06:59.531270 [info ] [Thread-1 (]: 14 of 18 START sql table model olist_raw_analytics.dim_geolocation ............. [RUN]
[0m00:06:59.531833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_customers, now model.olist_analytics.dim_geolocation)
[0m00:06:59.532243 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_geolocation
[0m00:06:59.535540 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_geolocation"
[0m00:06:59.536436 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_geolocation
[0m00:06:59.539811 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_geolocation"
[0m00:06:59.541244 [debug] [Thread-1 (]: On model.olist_analytics.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_geolocation"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      with geolocation as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
)

select
    zip_code,
    -- Calculate the center point of the zip code
    avg(latitude) as latitude,
    avg(longitude) as longitude,
    max(city) as city,
    max(state) as state
from geolocation
group by zip_code
    );
  
[0m00:06:59.541810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:00.436881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:38a9b4cc-9091-48b6-afd3-b6313062aa96&page=queryresults
[0m00:07:06.892691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3106b1850>]}
[0m00:07:06.894025 [info ] [Thread-1 (]: 14 of 18 OK created sql table model olist_raw_analytics.dim_geolocation ........ [[32mCREATE TABLE (19.0k rows, 58.4 MiB processed)[0m in 7.36s]
[0m00:07:06.894837 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_geolocation
[0m00:07:06.895372 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_order_items
[0m00:07:06.896057 [info ] [Thread-1 (]: 15 of 18 START sql table model olist_raw_analytics.fct_order_items ............. [RUN]
[0m00:07:06.896729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_geolocation, now model.olist_analytics.fct_order_items)
[0m00:07:06.897218 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_order_items
[0m00:07:06.901923 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_order_items"
[0m00:07:06.903245 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_order_items
[0m00:07:06.906555 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_order_items"
[0m00:07:06.907312 [debug] [Thread-1 (]: On model.olist_analytics.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_order_items"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_order_items`
      
    
    

    OPTIONS()
    as (
      with items as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
),

orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    -- Surrogate Key (Good practice to have a unique string for every row)
    concat(items.order_id, '-', cast(items.order_item_id as string)) as order_item_sk,
    
    items.order_id,
    items.order_item_id,
    items.product_id,
    items.seller_id,
    
    -- We bring in Customer ID from the orders table so we can slice sales by customer location later
    orders.customer_id,
    
    items.price,
    items.freight_value,
    
    -- Calculated Total
    (items.price + items.freight_value) as total_order_value

from items
left join orders 
    on items.order_id = orders.order_id
    );
  
[0m00:07:06.907764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:07.808627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:a07e3a46-d597-4744-b191-58b41ef4ae72&page=queryresults
[0m00:07:14.013193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x313a0a4d0>]}
[0m00:07:14.013833 [info ] [Thread-1 (]: 15 of 18 OK created sql table model olist_raw_analytics.fct_order_items ........ [[32mCREATE TABLE (112.7k rows, 31.6 MiB processed)[0m in 7.12s]
[0m00:07:14.014405 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_order_items
[0m00:07:14.014643 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m00:07:14.014899 [info ] [Thread-1 (]: 16 of 18 START sql table model olist_raw_analytics.fct_orders .................. [RUN]
[0m00:07:14.015271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_order_items, now model.olist_analytics.fct_orders)
[0m00:07:14.015629 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m00:07:14.017790 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m00:07:14.018344 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m00:07:14.019997 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m00:07:14.020498 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_orders`
      
    
    

    OPTIONS()
    as (
      with orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    order_id,
    customer_id,
    order_status,
    
    -- Timestamps
    purchase_at,
    approved_at,
    delivered_carrier_at,
    delivered_customer_at,
    estimated_delivery_at,

    -- Calculated Metrics (BigQuery Syntax)
    -- 1. How long did it take to deliver?
    timestamp_diff(delivered_customer_at, purchase_at, hour) as time_to_delivery_hours,
    
    -- 2. Was it late? (Difference between estimated and actual)
    -- Positive numbers mean it arrived early, Negative means it was late
    timestamp_diff(estimated_delivery_at, delivered_customer_at, day) as days_early_or_late

from orders
    );
  
[0m00:07:14.020748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:14.872605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:561a0f10-84b9-4bdd-8839-8546633436f5&page=queryresults
[0m00:07:18.804335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x313a0a550>]}
[0m00:07:18.806400 [info ] [Thread-1 (]: 16 of 18 OK created sql table model olist_raw_analytics.fct_orders ............. [[32mCREATE TABLE (99.4k rows, 16.8 MiB processed)[0m in 4.79s]
[0m00:07:18.807213 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m00:07:18.807744 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m00:07:18.808402 [info ] [Thread-1 (]: 17 of 18 START sql table model olist_raw_analytics.dim_products ................ [RUN]
[0m00:07:18.808983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_orders, now model.olist_analytics.dim_products)
[0m00:07:18.809461 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m00:07:18.813957 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m00:07:18.815221 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m00:07:18.818762 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m00:07:18.819744 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with products as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
),

translations as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
)

select
    p.product_id,
    -- If english name is null, fall back to original name, then to 'Unknown'
    coalesce(t.product_category_name_english, p.product_category_name, 'Unknown') as category_name,
    p.photos_quantity,
    p.weight_g,
    p.length_cm,
    p.height_cm,
    p.width_cm
from products p
left join translations t 
    on p.product_category_name = t.product_category_name
    );
  
[0m00:07:18.820255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:19.689163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:1bd20311-d0b3-4aaf-8de1-84b417df0a3b&page=queryresults
[0m00:07:22.457789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30c719790>]}
[0m00:07:22.459034 [info ] [Thread-1 (]: 17 of 18 OK created sql table model olist_raw_analytics.dim_products ........... [[32mCREATE TABLE (33.0k rows, 2.3 MiB processed)[0m in 3.65s]
[0m00:07:22.459779 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m00:07:22.460305 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_sellers
[0m00:07:22.460850 [info ] [Thread-1 (]: 18 of 18 START sql table model olist_raw_analytics.dim_sellers ................. [RUN]
[0m00:07:22.461523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_products, now model.olist_analytics.dim_sellers)
[0m00:07:22.462109 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_sellers
[0m00:07:22.466318 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_sellers"
[0m00:07:22.467845 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_sellers
[0m00:07:22.471144 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_sellers"
[0m00:07:22.472379 [debug] [Thread-1 (]: On model.olist_analytics.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_sellers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_sellers`
      
    
    

    OPTIONS()
    as (
      with sellers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
)

select
    seller_id,
    zip_code,
    city,
    state
from sellers
    );
  
[0m00:07:22.472860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:23.168693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:6cbf2b3f-647f-4857-b941-7a0679a7685b&page=queryresults
[0m00:07:25.630589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793d3005-caf4-4d42-9b19-7bb440099e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3106e4b90>]}
[0m00:07:25.631880 [info ] [Thread-1 (]: 18 of 18 OK created sql table model olist_raw_analytics.dim_sellers ............ [[32mCREATE TABLE (3.1k rows, 170.5 KiB processed)[0m in 3.17s]
[0m00:07:25.632651 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_sellers
[0m00:07:25.634490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:25.635283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:25.635621 [debug] [MainThread]: Connection 'model.olist_analytics.dim_sellers' was properly closed.
[0m00:07:25.636150 [info ] [MainThread]: 
[0m00:07:25.636540 [info ] [MainThread]: Finished running 8 table models, 10 view models in 0 hours 0 minutes and 55.83 seconds (55.83s).
[0m00:07:25.639923 [debug] [MainThread]: Command end result
[0m00:07:25.668117 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m00:07:25.669963 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m00:07:25.675232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m00:07:25.675546 [info ] [MainThread]: 
[0m00:07:25.675831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:25.676053 [info ] [MainThread]: 
[0m00:07:25.676273 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m00:07:25.676674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 60.09132, "process_in_blocks": "0", "process_kernel_time": 2.948401, "process_mem_max_rss": "481574912", "process_out_blocks": "0", "process_user_time": 5.718168}
[0m00:07:25.676974 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:25.676922 after 60.09 seconds
[0m00:07:25.677239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7fd10>]}
[0m00:07:25.677479 [debug] [MainThread]: Flushing usage events
[0m00:07:27.098471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:13:13.585724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676d750>]}


============================== 00:13:13.588922 | 267442ac-5ddf-4e86-9385-83a4fc61cb0c ==============================
[0m00:13:13.588922 [info ] [MainThread]: Running with dbt=1.9.6
[0m00:13:13.589314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:13:16.514608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dfc5210>]}
[0m00:13:16.550510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6ee10>]}
[0m00:13:16.550899 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m00:13:16.718833 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m00:13:16.803194 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m00:13:16.803718 [debug] [MainThread]: Partial parsing: deleted file: olist_analytics://models/example/my_first_dbt_model.sql
[0m00:13:16.803917 [debug] [MainThread]: Partial parsing: deleted file: olist_analytics://models/example/my_second_dbt_model.sql
[0m00:13:16.842520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f4d71d0>]}
[0m00:13:16.880427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m00:13:16.881511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m00:13:16.894926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104654150>]}
[0m00:13:16.895288 [info ] [MainThread]: Found 16 models, 9 sources, 494 macros
[0m00:13:16.895510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104654c10>]}
[0m00:13:16.896905 [info ] [MainThread]: 
[0m00:13:16.897118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:16.897288 [info ] [MainThread]: 
[0m00:13:16.897576 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:16.900097 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m00:13:16.900339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:17.594282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:18.101614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now create_stellar-verve-478012-n6_olist_raw_analytics)
[0m00:13:18.102912 [debug] [ThreadPool]: Creating schema "database: "stellar-verve-478012-n6"
schema: "olist_raw_analytics"
"
[0m00:13:18.117885 [debug] [ThreadPool]: On create_stellar-verve-478012-n6_olist_raw_analytics: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "connection_name": "create_stellar-verve-478012-n6_olist_raw_analytics"} */
create schema if not exists `stellar-verve-478012-n6`.`olist_raw_analytics`
  
[0m00:13:18.118387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:18.638252 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:4301c84d-fd45-449e-843d-46ab0a705a57&page=queryresults
[0m00:13:19.597079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_stellar-verve-478012-n6_olist_raw_analytics, now list_stellar-verve-478012-n6_olist_raw_staging)
[0m00:13:19.597403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:20.043863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_staging, now list_stellar-verve-478012-n6_olist_raw_analytics)
[0m00:13:20.046322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:20.557512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f69fad0>]}
[0m00:13:20.558723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:13:20.564783 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_date
[0m00:13:20.565525 [info ] [Thread-1 (]: 1 of 16 START sql table model olist_raw_analytics.dim_date ..................... [RUN]
[0m00:13:20.566334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_analytics, now model.olist_analytics.dim_date)
[0m00:13:20.567057 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_date
[0m00:13:20.575058 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_date"
[0m00:13:20.576109 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_date
[0m00:13:20.604056 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_date"
[0m00:13:20.605229 [debug] [Thread-1 (]: On model.olist_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_date"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_date`
      
    
    

    OPTIONS()
    as (
      -- Standard BigQuery SQL to generate dates
with date_spine as (
  select 
    * from 
    unnest(generate_date_array('2016-01-01', '2020-01-01', interval 1 day)) as date_day
)

select
  date_day,
  extract(year from date_day) as year,
  extract(month from date_day) as month,
  extract(day from date_day) as day,
  extract(dayofweek from date_day) as day_of_week,
  format_date('%B', date_day) as month_name,
  format_date('%A', date_day) as day_name,
  case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend
from date_spine
    );
  
[0m00:13:20.605573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:21.272039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:90144d8f-8181-4f0f-b56b-fd3c06282209&page=queryresults
[0m00:13:23.374269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f4c1090>]}
[0m00:13:23.375224 [info ] [Thread-1 (]: 1 of 16 OK created sql table model olist_raw_analytics.dim_date ................ [[32mCREATE TABLE (1.5k rows, 0 processed)[0m in 2.81s]
[0m00:13:23.375860 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_date
[0m00:13:23.376289 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m00:13:23.376855 [info ] [Thread-1 (]: 2 of 16 START sql view model olist_raw_staging.stg_customers ................... [RUN]
[0m00:13:23.377318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_date, now model.olist_analytics.stg_customers)
[0m00:13:23.377653 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m00:13:23.380607 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m00:13:23.381533 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m00:13:23.397961 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m00:13:23.398683 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m00:13:23.399006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:24.035812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:36f76d5b-7050-4750-ad19-e8aa3c43730f&page=queryresults
[0m00:13:24.691540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f634350>]}
[0m00:13:24.692754 [info ] [Thread-1 (]: 2 of 16 OK created sql view model olist_raw_staging.stg_customers .............. [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m00:13:24.693536 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m00:13:24.694138 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m00:13:24.694709 [info ] [Thread-1 (]: 3 of 16 START sql view model olist_raw_staging.stg_geolocation ................. [RUN]
[0m00:13:24.695490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m00:13:24.696015 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m00:13:24.699858 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m00:13:24.700832 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m00:13:24.703868 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m00:13:24.704924 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m00:13:24.705354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:25.372541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:0afd2c9e-2822-4f8c-bbb3-ae0957c93132&page=queryresults
[0m00:13:26.089655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f60bf10>]}
[0m00:13:26.091007 [info ] [Thread-1 (]: 3 of 16 OK created sql view model olist_raw_staging.stg_geolocation ............ [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m00:13:26.091810 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m00:13:26.092342 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m00:13:26.093067 [info ] [Thread-1 (]: 4 of 16 START sql view model olist_raw_staging.stg_order_items ................. [RUN]
[0m00:13:26.093852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m00:13:26.094359 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m00:13:26.098642 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m00:13:26.099810 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m00:13:26.102916 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m00:13:26.104296 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m00:13:26.104880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:26.904844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:14762ca0-afd1-4a63-9dfe-d7aff4218bbf&page=queryresults
[0m00:13:27.535322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172082f10>]}
[0m00:13:27.536292 [info ] [Thread-1 (]: 4 of 16 OK created sql view model olist_raw_staging.stg_order_items ............ [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m00:13:27.536926 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m00:13:27.537339 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m00:13:27.537944 [info ] [Thread-1 (]: 5 of 16 START sql view model olist_raw_staging.stg_order_payments .............. [RUN]
[0m00:13:27.538519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m00:13:27.538947 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m00:13:27.543031 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m00:13:27.543983 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m00:13:27.547096 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m00:13:27.547860 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m00:13:27.548278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:28.438364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:ff5afc0d-0546-4b75-bc07-2c94f9f5e54b&page=queryresults
[0m00:13:29.160876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172098850>]}
[0m00:13:29.162106 [info ] [Thread-1 (]: 5 of 16 OK created sql view model olist_raw_staging.stg_order_payments ......... [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m00:13:29.162885 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m00:13:29.163406 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m00:13:29.164151 [info ] [Thread-1 (]: 6 of 16 START sql view model olist_raw_staging.stg_order_reviews ............... [RUN]
[0m00:13:29.164820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m00:13:29.165315 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m00:13:29.169528 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m00:13:29.170783 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m00:13:29.174146 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m00:13:29.175573 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m00:13:29.176052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:29.874321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:253000b3-a174-4d17-baa3-9656e6663dbf&page=queryresults
[0m00:13:30.594772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1720ce150>]}
[0m00:13:30.596046 [info ] [Thread-1 (]: 6 of 16 OK created sql view model olist_raw_staging.stg_order_reviews .......... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m00:13:30.596808 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m00:13:30.597332 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m00:13:30.598046 [info ] [Thread-1 (]: 7 of 16 START sql view model olist_raw_staging.stg_orders ...................... [RUN]
[0m00:13:30.598730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m00:13:30.599223 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m00:13:30.603146 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m00:13:30.604303 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m00:13:30.609691 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m00:13:30.610489 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m00:13:30.610932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:31.614795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:d3cf3c20-391d-4a61-924b-d2673c6c26ea&page=queryresults
[0m00:13:32.291789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1720cf6d0>]}
[0m00:13:32.292559 [info ] [Thread-1 (]: 7 of 16 OK created sql view model olist_raw_staging.stg_orders ................. [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m00:13:32.292914 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m00:13:32.293182 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m00:13:32.293425 [info ] [Thread-1 (]: 8 of 16 START sql view model olist_raw_staging.stg_product_category_name_translation  [RUN]
[0m00:13:32.293676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m00:13:32.293872 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m00:13:32.295596 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m00:13:32.296088 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m00:13:32.297613 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m00:13:32.297980 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m00:13:32.298210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:32.843927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:db776564-31ea-4ddb-9f46-76acec44354c&page=queryresults
[0m00:13:33.475125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ffc9990>]}
[0m00:13:33.476364 [info ] [Thread-1 (]: 8 of 16 OK created sql view model olist_raw_staging.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m00:13:33.477132 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m00:13:33.477689 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m00:13:33.478250 [info ] [Thread-1 (]: 9 of 16 START sql view model olist_raw_staging.stg_products .................... [RUN]
[0m00:13:33.478783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m00:13:33.479406 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m00:13:33.483433 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m00:13:33.484533 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m00:13:33.488040 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m00:13:33.489131 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m00:13:33.489907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:34.357995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:4e75ff49-d183-41ed-8186-57264228cfed&page=queryresults
[0m00:13:34.996448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f5ff3d0>]}
[0m00:13:34.997606 [info ] [Thread-1 (]: 9 of 16 OK created sql view model olist_raw_staging.stg_products ............... [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m00:13:34.998355 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m00:13:34.998878 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m00:13:34.999428 [info ] [Thread-1 (]: 10 of 16 START sql view model olist_raw_staging.stg_sellers .................... [RUN]
[0m00:13:35.000082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m00:13:35.000666 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m00:13:35.004602 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m00:13:35.006942 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m00:13:35.010306 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m00:13:35.011219 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m00:13:35.011631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:35.568648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:06b8ffca-daf1-4c0e-be00-743f088ea058&page=queryresults
[0m00:13:36.226817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ff617d0>]}
[0m00:13:36.227906 [info ] [Thread-1 (]: 10 of 16 OK created sql view model olist_raw_staging.stg_sellers ............... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m00:13:36.228653 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m00:13:36.229172 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_customers
[0m00:13:36.229872 [info ] [Thread-1 (]: 11 of 16 START sql table model olist_raw_analytics.dim_customers ............... [RUN]
[0m00:13:36.230593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_sellers, now model.olist_analytics.dim_customers)
[0m00:13:36.231020 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_customers
[0m00:13:36.235067 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m00:13:36.236273 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_customers
[0m00:13:36.239408 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m00:13:36.240355 [debug] [Thread-1 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
),

unique_customers as (
    -- Deduplicate to get one row per unique person
    select
        customer_unique_id,
        -- We use MAX/ANY_VALUE to just grab one valid location per person
        -- In a real scenario, you might want their "current" address logic
        max(zip_code) as zip_code,
        max(city) as city,
        max(state) as state
    from customers
    group by customer_unique_id
)

select
    customer_unique_id,
    zip_code,
    city,
    state
from unique_customers
    );
  
[0m00:13:36.241081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:37.039951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:98d049a4-a03e-4aa0-8573-fad173105629&page=queryresults
[0m00:13:40.628167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ffbf350>]}
[0m00:13:40.629636 [info ] [Thread-1 (]: 11 of 16 OK created sql table model olist_raw_analytics.dim_customers .......... [[32mCREATE TABLE (96.1k rows, 8.6 MiB processed)[0m in 4.40s]
[0m00:13:40.630450 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_customers
[0m00:13:40.630973 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_geolocation
[0m00:13:40.631666 [info ] [Thread-1 (]: 12 of 16 START sql table model olist_raw_analytics.dim_geolocation ............. [RUN]
[0m00:13:40.632340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_customers, now model.olist_analytics.dim_geolocation)
[0m00:13:40.632842 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_geolocation
[0m00:13:40.639757 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_geolocation"
[0m00:13:40.642171 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_geolocation
[0m00:13:40.645041 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_geolocation"
[0m00:13:40.645911 [debug] [Thread-1 (]: On model.olist_analytics.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_geolocation"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      with geolocation as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
)

select
    zip_code,
    -- Calculate the center point of the zip code
    avg(latitude) as latitude,
    avg(longitude) as longitude,
    max(city) as city,
    max(state) as state
from geolocation
group by zip_code
    );
  
[0m00:13:40.646412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:41.446185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:0cb2e18b-dfe5-4fb3-a9cb-4c9986d4b9df&page=queryresults
[0m00:13:48.412936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172105cd0>]}
[0m00:13:48.414099 [info ] [Thread-1 (]: 12 of 16 OK created sql table model olist_raw_analytics.dim_geolocation ........ [[32mCREATE TABLE (19.0k rows, 58.4 MiB processed)[0m in 7.78s]
[0m00:13:48.414877 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_geolocation
[0m00:13:48.415415 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_order_items
[0m00:13:48.416135 [info ] [Thread-1 (]: 13 of 16 START sql table model olist_raw_analytics.fct_order_items ............. [RUN]
[0m00:13:48.416817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_geolocation, now model.olist_analytics.fct_order_items)
[0m00:13:48.417334 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_order_items
[0m00:13:48.422070 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_order_items"
[0m00:13:48.423055 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_order_items
[0m00:13:48.426276 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_order_items"
[0m00:13:48.427326 [debug] [Thread-1 (]: On model.olist_analytics.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_order_items"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_order_items`
      
    
    

    OPTIONS()
    as (
      with items as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
),

orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    -- Surrogate Key (Good practice to have a unique string for every row)
    concat(items.order_id, '-', cast(items.order_item_id as string)) as order_item_sk,
    
    items.order_id,
    items.order_item_id,
    items.product_id,
    items.seller_id,
    
    -- We bring in Customer ID from the orders table so we can slice sales by customer location later
    orders.customer_id,
    
    items.price,
    items.freight_value,
    
    -- Calculated Total
    (items.price + items.freight_value) as total_order_value

from items
left join orders 
    on items.order_id = orders.order_id
    );
  
[0m00:13:48.427802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:49.285722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:03066630-1002-43c8-a163-b5f94850df69&page=queryresults
[0m00:13:55.312793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fef91d0>]}
[0m00:13:55.314604 [info ] [Thread-1 (]: 13 of 16 OK created sql table model olist_raw_analytics.fct_order_items ........ [[32mCREATE TABLE (112.7k rows, 31.6 MiB processed)[0m in 6.90s]
[0m00:13:55.315542 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_order_items
[0m00:13:55.316127 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m00:13:55.316855 [info ] [Thread-1 (]: 14 of 16 START sql table model olist_raw_analytics.fct_orders .................. [RUN]
[0m00:13:55.317697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_order_items, now model.olist_analytics.fct_orders)
[0m00:13:55.318232 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m00:13:55.322479 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m00:13:55.324674 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m00:13:55.327412 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m00:13:55.328144 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_orders`
      
    
    

    OPTIONS()
    as (
      with orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    order_id,
    customer_id,
    order_status,
    
    -- Timestamps
    purchase_at,
    approved_at,
    delivered_carrier_at,
    delivered_customer_at,
    estimated_delivery_at,

    -- Calculated Metrics (BigQuery Syntax)
    -- 1. How long did it take to deliver?
    timestamp_diff(delivered_customer_at, purchase_at, hour) as time_to_delivery_hours,
    
    -- 2. Was it late? (Difference between estimated and actual)
    -- Positive numbers mean it arrived early, Negative means it was late
    timestamp_diff(estimated_delivery_at, delivered_customer_at, day) as days_early_or_late

from orders
    );
  
[0m00:13:55.328567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:56.101703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:18630ca0-2028-446b-99d0-1d638ae6b29a&page=queryresults
[0m00:14:00.084904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17208e390>]}
[0m00:14:00.085818 [info ] [Thread-1 (]: 14 of 16 OK created sql table model olist_raw_analytics.fct_orders ............. [[32mCREATE TABLE (99.4k rows, 16.8 MiB processed)[0m in 4.77s]
[0m00:14:00.086375 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m00:14:00.086745 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m00:14:00.087223 [info ] [Thread-1 (]: 15 of 16 START sql table model olist_raw_analytics.dim_products ................ [RUN]
[0m00:14:00.087692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_orders, now model.olist_analytics.dim_products)
[0m00:14:00.088025 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m00:14:00.091279 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m00:14:00.092195 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m00:14:00.094833 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m00:14:00.095847 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with products as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
),

translations as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
)

select
    p.product_id,
    -- If english name is null, fall back to original name, then to 'Unknown'
    coalesce(t.product_category_name_english, p.product_category_name, 'Unknown') as category_name,
    p.photos_quantity,
    p.weight_g,
    p.length_cm,
    p.height_cm,
    p.width_cm
from products p
left join translations t 
    on p.product_category_name = t.product_category_name
    );
  
[0m00:14:00.096355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:00.901138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:02a74663-aa28-43cc-8500-d50008033e96&page=queryresults
[0m00:14:05.000077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1720d6b50>]}
[0m00:14:05.001471 [info ] [Thread-1 (]: 15 of 16 OK created sql table model olist_raw_analytics.dim_products ........... [[32mCREATE TABLE (33.0k rows, 2.3 MiB processed)[0m in 4.91s]
[0m00:14:05.002077 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m00:14:05.002492 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_sellers
[0m00:14:05.003020 [info ] [Thread-1 (]: 16 of 16 START sql table model olist_raw_analytics.dim_sellers ................. [RUN]
[0m00:14:05.003535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_products, now model.olist_analytics.dim_sellers)
[0m00:14:05.003922 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_sellers
[0m00:14:05.007305 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_sellers"
[0m00:14:05.008349 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_sellers
[0m00:14:05.014739 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_sellers"
[0m00:14:05.015853 [debug] [Thread-1 (]: On model.olist_analytics.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_sellers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_sellers`
      
    
    

    OPTIONS()
    as (
      with sellers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
)

select
    seller_id,
    zip_code,
    city,
    state
from sellers
    );
  
[0m00:14:05.016290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:05.920910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:ebe796ee-fd96-4d83-8214-f97820c42f38&page=queryresults
[0m00:14:08.276748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267442ac-5ddf-4e86-9385-83a4fc61cb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175151190>]}
[0m00:14:08.277655 [info ] [Thread-1 (]: 16 of 16 OK created sql table model olist_raw_analytics.dim_sellers ............ [[32mCREATE TABLE (3.1k rows, 170.5 KiB processed)[0m in 3.27s]
[0m00:14:08.278135 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_sellers
[0m00:14:08.279490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:14:08.280186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:08.280963 [debug] [MainThread]: Connection 'model.olist_analytics.dim_sellers' was properly closed.
[0m00:14:08.281699 [info ] [MainThread]: 
[0m00:14:08.282202 [info ] [MainThread]: Finished running 7 table models, 9 view models in 0 hours 0 minutes and 51.38 seconds (51.38s).
[0m00:14:08.285003 [debug] [MainThread]: Command end result
[0m00:14:08.311121 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m00:14:08.312865 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m00:14:08.317971 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m00:14:08.318251 [info ] [MainThread]: 
[0m00:14:08.318524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:08.318749 [info ] [MainThread]: 
[0m00:14:08.318977 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m00:14:08.319392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 54.776676, "process_in_blocks": "0", "process_kernel_time": 2.844842, "process_mem_max_rss": "468467712", "process_out_blocks": "0", "process_user_time": 4.798052}
[0m00:14:08.319788 [debug] [MainThread]: Command `dbt run` succeeded at 00:14:08.319726 after 54.78 seconds
[0m00:14:08.320107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10129f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10129fd10>]}
[0m00:14:08.320390 [debug] [MainThread]: Flushing usage events
[0m00:14:09.810973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:46:25.430130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba51090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b86fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bae6390>]}


============================== 17:46:25.433064 | b15d5a44-7e60-454e-b0e1-91d8768bd54b ==============================
[0m17:46:25.433064 [info ] [MainThread]: Running with dbt=1.9.6
[0m17:46:25.433435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:46:28.696442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3023f8450>]}
[0m17:46:28.734814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817b990>]}
[0m17:46:28.735286 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:46:28.918339 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m17:46:28.998980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m17:46:28.999427 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models/marts/dim_reviews.sql
[0m17:46:28.999638 [debug] [MainThread]: Partial parsing: added file: olist_analytics://models/marts/dim_payments.sql
[0m17:46:28.999882 [debug] [MainThread]: Partial parsing: updated file: olist_analytics://models/marts/dim_customers.sql
[0m17:46:29.153931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x302324f10>]}
[0m17:46:29.191244 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m17:46:29.192519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m17:46:29.206423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x302653850>]}
[0m17:46:29.206737 [info ] [MainThread]: Found 18 models, 9 sources, 494 macros
[0m17:46:29.206943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16da392d0>]}
[0m17:46:29.208334 [info ] [MainThread]: 
[0m17:46:29.208548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:29.208708 [info ] [MainThread]: 
[0m17:46:29.208968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:46:29.211516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m17:46:29.211745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:29.818528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:30.227200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw_staging)
[0m17:46:30.228180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:30.653686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_staging, now list_stellar-verve-478012-n6_olist_raw_analytics)
[0m17:46:30.655669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:31.056810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x302361190>]}
[0m17:46:31.057459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:31.061834 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_date
[0m17:46:31.062329 [info ] [Thread-1 (]: 1 of 18 START sql table model olist_raw_analytics.dim_date ..................... [RUN]
[0m17:46:31.062741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_analytics, now model.olist_analytics.dim_date)
[0m17:46:31.063048 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_date
[0m17:46:31.070502 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_date"
[0m17:46:31.071841 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_date
[0m17:46:31.086563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:31.496111 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_date"
[0m17:46:31.498893 [debug] [Thread-1 (]: On model.olist_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_date"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_date`
      
    
    

    OPTIONS()
    as (
      -- Standard BigQuery SQL to generate dates
with date_spine as (
  select 
    * from 
    unnest(generate_date_array('2016-01-01', '2020-01-01', interval 1 day)) as date_day
)

select
  date_day,
  extract(year from date_day) as year,
  extract(month from date_day) as month,
  extract(day from date_day) as day,
  extract(dayofweek from date_day) as day_of_week,
  format_date('%B', date_day) as month_name,
  format_date('%A', date_day) as day_name,
  case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend
from date_spine
    );
  
[0m17:46:32.396742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:dd4a98ac-3776-4fa0-be7c-0eebb0d1ae0d&page=queryresults
[0m17:46:34.771376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16da3da10>]}
[0m17:46:34.771987 [info ] [Thread-1 (]: 1 of 18 OK created sql table model olist_raw_analytics.dim_date ................ [[32mCREATE TABLE (1.5k rows, 0 processed)[0m in 3.71s]
[0m17:46:34.772419 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_date
[0m17:46:34.772697 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m17:46:34.773082 [info ] [Thread-1 (]: 2 of 18 START sql view model olist_raw_staging.stg_customers ................... [RUN]
[0m17:46:34.773428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_date, now model.olist_analytics.stg_customers)
[0m17:46:34.773683 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m17:46:34.775824 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m17:46:34.776523 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m17:46:34.790106 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m17:46:34.791043 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m17:46:34.791448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:35.411855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:97af6b71-20d3-426a-be53-a6d7e4f7b265&page=queryresults
[0m17:46:36.082501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30762ccd0>]}
[0m17:46:36.083742 [info ] [Thread-1 (]: 2 of 18 OK created sql view model olist_raw_staging.stg_customers .............. [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m17:46:36.084721 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m17:46:36.085399 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m17:46:36.086266 [info ] [Thread-1 (]: 3 of 18 START sql view model olist_raw_staging.stg_geolocation ................. [RUN]
[0m17:46:36.086999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m17:46:36.087479 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m17:46:36.091372 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m17:46:36.093699 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m17:46:36.096965 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m17:46:36.098151 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m17:46:36.098595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:36.799289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:580646e9-5594-4c3b-a6ce-872a4e6f6f7c&page=queryresults
[0m17:46:37.517323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307a2bbd0>]}
[0m17:46:37.518348 [info ] [Thread-1 (]: 3 of 18 OK created sql view model olist_raw_staging.stg_geolocation ............ [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m17:46:37.518989 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m17:46:37.519437 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m17:46:37.520150 [info ] [Thread-1 (]: 4 of 18 START sql view model olist_raw_staging.stg_order_items ................. [RUN]
[0m17:46:37.520725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m17:46:37.521143 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m17:46:37.524426 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m17:46:37.525355 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m17:46:37.528841 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m17:46:37.530444 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m17:46:37.530883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:38.227109 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:bbf77c40-7304-488c-9e9f-c8fd0e7ea465&page=queryresults
[0m17:46:38.950624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3079637d0>]}
[0m17:46:38.951962 [info ] [Thread-1 (]: 4 of 18 OK created sql view model olist_raw_staging.stg_order_items ............ [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m17:46:38.952781 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m17:46:38.953317 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m17:46:38.954087 [info ] [Thread-1 (]: 5 of 18 START sql view model olist_raw_staging.stg_order_payments .............. [RUN]
[0m17:46:38.954860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m17:46:38.955410 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m17:46:38.959568 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m17:46:38.960587 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m17:46:38.963699 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m17:46:38.964353 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m17:46:38.964792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:39.660646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:d73e5cd3-9cb8-4089-be51-934e34b7ad1a&page=queryresults
[0m17:46:40.902920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30762ed10>]}
[0m17:46:40.904248 [info ] [Thread-1 (]: 5 of 18 OK created sql view model olist_raw_staging.stg_order_payments ......... [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m17:46:40.905013 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m17:46:40.905545 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m17:46:40.906302 [info ] [Thread-1 (]: 6 of 18 START sql view model olist_raw_staging.stg_order_reviews ............... [RUN]
[0m17:46:40.907049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m17:46:40.907560 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m17:46:40.911962 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m17:46:40.913165 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m17:46:40.916408 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m17:46:40.917120 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m17:46:40.917554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:41.606747 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:4d3bdb12-24d0-4b34-9de6-c315aa2d7428&page=queryresults
[0m17:46:42.323106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307987450>]}
[0m17:46:42.323763 [info ] [Thread-1 (]: 6 of 18 OK created sql view model olist_raw_staging.stg_order_reviews .......... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m17:46:42.324208 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m17:46:42.324510 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m17:46:42.324901 [info ] [Thread-1 (]: 7 of 18 START sql view model olist_raw_staging.stg_orders ...................... [RUN]
[0m17:46:42.325367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m17:46:42.325668 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m17:46:42.327976 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m17:46:42.328559 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m17:46:42.330693 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m17:46:42.331285 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m17:46:42.331583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:42.936919 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:f153677d-7866-4b77-8384-00912c42fcee&page=queryresults
[0m17:46:43.660093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x302710150>]}
[0m17:46:43.661431 [info ] [Thread-1 (]: 7 of 18 OK created sql view model olist_raw_staging.stg_orders ................. [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m17:46:43.662219 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m17:46:43.662779 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m17:46:43.663659 [info ] [Thread-1 (]: 8 of 18 START sql view model olist_raw_staging.stg_product_category_name_translation  [RUN]
[0m17:46:43.664322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m17:46:43.664824 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m17:46:43.668745 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m17:46:43.669669 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m17:46:43.675122 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m17:46:43.676492 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m17:46:43.677056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:44.272081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:7b5b134e-66d1-4870-a9b3-9c321b07f168&page=queryresults
[0m17:46:45.094647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307a9d210>]}
[0m17:46:45.096099 [info ] [Thread-1 (]: 8 of 18 OK created sql view model olist_raw_staging.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m17:46:45.096954 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m17:46:45.097507 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m17:46:45.098074 [info ] [Thread-1 (]: 9 of 18 START sql view model olist_raw_staging.stg_products .................... [RUN]
[0m17:46:45.098640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m17:46:45.099223 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m17:46:45.103417 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m17:46:45.104378 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m17:46:45.108014 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m17:46:45.109689 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m17:46:45.110287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:45.708076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:36255c63-369c-48c0-95ff-e4a5bca7d14c&page=queryresults
[0m17:46:46.334009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307a5c310>]}
[0m17:46:46.335224 [info ] [Thread-1 (]: 9 of 18 OK created sql view model olist_raw_staging.stg_products ............... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m17:46:46.336193 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m17:46:46.336875 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m17:46:46.337661 [info ] [Thread-1 (]: 10 of 18 START sql view model olist_raw_staging.stg_sellers .................... [RUN]
[0m17:46:46.338624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m17:46:46.339166 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m17:46:46.343016 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m17:46:46.345331 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m17:46:46.348625 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m17:46:46.349492 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m17:46:46.350117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:46.934413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:fe2b439d-9740-40ba-8074-cd94d4594c28&page=queryresults
[0m17:46:47.863713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307962710>]}
[0m17:46:47.864871 [info ] [Thread-1 (]: 10 of 18 OK created sql view model olist_raw_staging.stg_sellers ............... [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m17:46:47.865561 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m17:46:47.866037 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_customers
[0m17:46:47.866687 [info ] [Thread-1 (]: 11 of 18 START sql table model olist_raw_analytics.dim_customers ............... [RUN]
[0m17:46:47.867390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_sellers, now model.olist_analytics.dim_customers)
[0m17:46:47.867756 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_customers
[0m17:46:47.871596 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m17:46:47.872688 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_customers
[0m17:46:47.875272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:48.265580 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m17:46:48.267757 [debug] [Thread-1 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
),

with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
)

select
    customer_id,        -- Included as requested (Primary Key)
    customer_unique_id, -- The actual person's ID (Foreign Key to user history)
    zip_code,
    city,
    state
from customers
    );
  
[0m17:46:48.675239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3e74dd66-725e-4353-9b2a-45ea903bffee&page=queryresults
[0m17:46:48.676916 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3e74dd66-725e-4353-9b2a-45ea903bffee&page=queryresults
[0m17:46:48.691490 [debug] [Thread-1 (]: Database Error in model dim_customers (models/marts/dim_customers.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [17:1]
  compiled code at target/run/olist_analytics/models/marts/dim_customers.sql
[0m17:46:48.692307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3079c0190>]}
[0m17:46:48.693205 [error] [Thread-1 (]: 11 of 18 ERROR creating sql table model olist_raw_analytics.dim_customers ...... [[31mERROR[0m in 0.82s]
[0m17:46:48.693874 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_customers
[0m17:46:48.694264 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_geolocation
[0m17:46:48.694831 [debug] [Thread-4 (]: Marking all children of 'model.olist_analytics.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models/marts/dim_customers.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [17:1]
  compiled code at target/run/olist_analytics/models/marts/dim_customers.sql.
[0m17:46:48.695369 [info ] [Thread-1 (]: 12 of 18 START sql table model olist_raw_analytics.dim_geolocation ............. [RUN]
[0m17:46:48.696679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_customers, now model.olist_analytics.dim_geolocation)
[0m17:46:48.697142 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_geolocation
[0m17:46:48.700105 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_geolocation"
[0m17:46:48.701111 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_geolocation
[0m17:46:48.703445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:49.189268 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_geolocation"
[0m17:46:49.191138 [debug] [Thread-1 (]: On model.olist_analytics.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_geolocation"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      with geolocation as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
)

select
    zip_code,
    -- Calculate the center point of the zip code
    avg(latitude) as latitude,
    avg(longitude) as longitude,
    max(city) as city,
    max(state) as state
from geolocation
group by zip_code
    );
  
[0m17:46:50.005768 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:cf7313b1-6159-416d-bb6c-88deb9176b28&page=queryresults
[0m17:46:56.149826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30793fc10>]}
[0m17:46:56.151141 [info ] [Thread-1 (]: 12 of 18 OK created sql table model olist_raw_analytics.dim_geolocation ........ [[32mCREATE TABLE (19.0k rows, 58.4 MiB processed)[0m in 7.45s]
[0m17:46:56.151931 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_geolocation
[0m17:46:56.152515 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_payments
[0m17:46:56.153214 [info ] [Thread-1 (]: 13 of 18 START sql table model olist_raw_analytics.dim_payments ................ [RUN]
[0m17:46:56.153890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_geolocation, now model.olist_analytics.dim_payments)
[0m17:46:56.154320 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_payments
[0m17:46:56.161203 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_payments"
[0m17:46:56.162277 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_payments
[0m17:46:56.165675 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_payments"
[0m17:46:56.166419 [debug] [Thread-1 (]: On model.olist_analytics.dim_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_payments"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_payments`
      
    
    

    OPTIONS()
    as (
      with payments as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
)

select
    -- Generate a unique key for each payment row
    concat(order_id, '-', cast(payment_sequential as string)) as payment_sk,
    
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from payments
    );
  
[0m17:46:56.166840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:56.916184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3bac4194-dddb-4ce6-aba2-c2f93edb71b1&page=queryresults
[0m17:46:59.945412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307a501d0>]}
[0m17:46:59.946420 [info ] [Thread-1 (]: 13 of 18 OK created sql table model olist_raw_analytics.dim_payments ........... [[32mCREATE TABLE (103.9k rows, 5.5 MiB processed)[0m in 3.79s]
[0m17:46:59.946938 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_payments
[0m17:46:59.947326 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_reviews
[0m17:46:59.947803 [info ] [Thread-1 (]: 14 of 18 START sql table model olist_raw_analytics.dim_reviews ................. [RUN]
[0m17:46:59.948265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_payments, now model.olist_analytics.dim_reviews)
[0m17:46:59.948590 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_reviews
[0m17:46:59.951816 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_reviews"
[0m17:46:59.952763 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_reviews
[0m17:46:59.955193 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_reviews"
[0m17:46:59.955973 [debug] [Thread-1 (]: On model.olist_analytics.dim_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_reviews"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_reviews`
      
    
    

    OPTIONS()
    as (
      with reviews as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
)

select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    created_at as review_created_at,
    answer_timestamp as review_answered_at
from reviews
    );
  
[0m17:46:59.956321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:00.756489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:00d95a3c-3fc1-4359-8818-32d538826d31&page=queryresults
[0m17:47:01.341559 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:00d95a3c-3fc1-4359-8818-32d538826d31&page=queryresults
[0m17:47:01.351453 [debug] [Thread-1 (]: Database Error in model dim_reviews (models/marts/dim_reviews.sql)
  Error while reading table: stellar-verve-478012-n6.olist_raw.reviews, error message: Missing close quote character (").; line_number: 14 byte_offset_to_start_of_line: 1841 column_index: 4 column_name: "review_comment_me..." column_type: STRING value: "Mas um pouco ,tra..." File: gs://dsai2-olist-raw-data/raw/olist/olist_order_reviews_dataset.csv
  compiled code at target/run/olist_analytics/models/marts/dim_reviews.sql
[0m17:47:01.352607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3079a3010>]}
[0m17:47:01.353511 [error] [Thread-1 (]: 14 of 18 ERROR creating sql table model olist_raw_analytics.dim_reviews ........ [[31mERROR[0m in 1.40s]
[0m17:47:01.354259 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_reviews
[0m17:47:01.354967 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_order_items
[0m17:47:01.355911 [debug] [Thread-4 (]: Marking all children of 'model.olist_analytics.dim_reviews' to be skipped because of status 'error'.  Reason: Database Error in model dim_reviews (models/marts/dim_reviews.sql)
  Error while reading table: stellar-verve-478012-n6.olist_raw.reviews, error message: Missing close quote character (").; line_number: 14 byte_offset_to_start_of_line: 1841 column_index: 4 column_name: "review_comment_me..." column_type: STRING value: "Mas um pouco ,tra..." File: gs://dsai2-olist-raw-data/raw/olist/olist_order_reviews_dataset.csv
  compiled code at target/run/olist_analytics/models/marts/dim_reviews.sql.
[0m17:47:01.356700 [info ] [Thread-1 (]: 15 of 18 START sql table model olist_raw_analytics.fct_order_items ............. [RUN]
[0m17:47:01.357554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_reviews, now model.olist_analytics.fct_order_items)
[0m17:47:01.358084 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_order_items
[0m17:47:01.363524 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_order_items"
[0m17:47:01.364732 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_order_items
[0m17:47:01.367253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:01.787889 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_order_items"
[0m17:47:01.789273 [debug] [Thread-1 (]: On model.olist_analytics.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_order_items"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_order_items`
      
    
    

    OPTIONS()
    as (
      with items as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
),

orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    -- Surrogate Key (Good practice to have a unique string for every row)
    concat(items.order_id, '-', cast(items.order_item_id as string)) as order_item_sk,
    
    items.order_id,
    items.order_item_id,
    items.product_id,
    items.seller_id,
    
    -- We bring in Customer ID from the orders table so we can slice sales by customer location later
    orders.customer_id,
    
    items.price,
    items.freight_value,
    
    -- Calculated Total
    (items.price + items.freight_value) as total_order_value

from items
left join orders 
    on items.order_id = orders.order_id
    );
  
[0m17:47:02.699996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:1ce36d48-319e-4a78-a033-fa047008d1c7&page=queryresults
[0m17:47:13.970653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307630790>]}
[0m17:47:13.972545 [info ] [Thread-1 (]: 15 of 18 OK created sql table model olist_raw_analytics.fct_order_items ........ [[32mCREATE TABLE (112.7k rows, 31.6 MiB processed)[0m in 12.61s]
[0m17:47:13.973254 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_order_items
[0m17:47:13.973733 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m17:47:13.974238 [info ] [Thread-1 (]: 16 of 18 START sql table model olist_raw_analytics.fct_orders .................. [RUN]
[0m17:47:13.974889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_order_items, now model.olist_analytics.fct_orders)
[0m17:47:13.975395 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m17:47:13.979623 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m17:47:13.980773 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m17:47:13.983673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:14.481219 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m17:47:14.484396 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_orders`
      
    
    

    OPTIONS()
    as (
      with orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    order_id,
    customer_id,
    order_status,
    
    -- Timestamps
    purchase_at,
    approved_at,
    delivered_carrier_at,
    delivered_customer_at,
    estimated_delivery_at,

    -- Calculated Metrics (BigQuery Syntax)
    -- 1. How long did it take to deliver?
    timestamp_diff(delivered_customer_at, purchase_at, hour) as time_to_delivery_hours,
    
    -- 2. Was it late? (Difference between estimated and actual)
    -- Positive numbers mean it arrived early, Negative means it was late
    timestamp_diff(estimated_delivery_at, delivered_customer_at, day) as days_early_or_late

from orders
    );
  
[0m17:47:15.296549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:e1c8dffe-a59f-4b4e-be17-c43068c34c55&page=queryresults
[0m17:47:19.603006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x302767c10>]}
[0m17:47:19.604091 [info ] [Thread-1 (]: 16 of 18 OK created sql table model olist_raw_analytics.fct_orders ............. [[32mCREATE TABLE (99.4k rows, 16.8 MiB processed)[0m in 5.63s]
[0m17:47:19.604620 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m17:47:19.605006 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m17:47:19.605379 [info ] [Thread-1 (]: 17 of 18 START sql table model olist_raw_analytics.dim_products ................ [RUN]
[0m17:47:19.605836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_orders, now model.olist_analytics.dim_products)
[0m17:47:19.606139 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m17:47:19.609693 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m17:47:19.610767 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m17:47:19.613891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:20.011614 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m17:47:20.013656 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with products as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
),

translations as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
)

select
    p.product_id,
    -- If english name is null, fall back to original name, then to 'Unknown'
    coalesce(t.product_category_name_english, p.product_category_name, 'Unknown') as category_name,
    p.photos_quantity,
    p.weight_g,
    p.length_cm,
    p.height_cm,
    p.width_cm
from products p
left join translations t 
    on p.product_category_name = t.product_category_name
    );
  
[0m17:47:20.825272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:5315b366-66fd-4896-b031-d314d86f306c&page=queryresults
[0m17:47:23.806593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307de1ed0>]}
[0m17:47:23.808658 [info ] [Thread-1 (]: 17 of 18 OK created sql table model olist_raw_analytics.dim_products ........... [[32mCREATE TABLE (33.0k rows, 2.3 MiB processed)[0m in 4.20s]
[0m17:47:23.809319 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m17:47:23.809728 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_sellers
[0m17:47:23.810140 [info ] [Thread-1 (]: 18 of 18 START sql table model olist_raw_analytics.dim_sellers ................. [RUN]
[0m17:47:23.810654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_products, now model.olist_analytics.dim_sellers)
[0m17:47:23.811070 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_sellers
[0m17:47:23.814638 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_sellers"
[0m17:47:23.815865 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_sellers
[0m17:47:23.818154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:24.209532 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_sellers"
[0m17:47:24.211680 [debug] [Thread-1 (]: On model.olist_analytics.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_sellers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_sellers`
      
    
    

    OPTIONS()
    as (
      with sellers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
)

select
    seller_id,
    zip_code,
    city,
    state
from sellers
    );
  
[0m17:47:25.027936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:9201a1b1-3a1e-41ff-ad4c-c4f9a791e494&page=queryresults
[0m17:47:27.140769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b15d5a44-7e60-454e-b0e1-91d8768bd54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x307dd6dd0>]}
[0m17:47:27.141998 [info ] [Thread-1 (]: 18 of 18 OK created sql table model olist_raw_analytics.dim_sellers ............ [[32mCREATE TABLE (3.1k rows, 170.5 KiB processed)[0m in 3.33s]
[0m17:47:27.142789 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_sellers
[0m17:47:27.144712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:27.145452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:27.145808 [debug] [MainThread]: Connection 'model.olist_analytics.dim_sellers' was properly closed.
[0m17:47:27.146340 [info ] [MainThread]: 
[0m17:47:27.146730 [info ] [MainThread]: Finished running 9 table models, 9 view models in 0 hours 0 minutes and 57.94 seconds (57.94s).
[0m17:47:27.149829 [debug] [MainThread]: Command end result
[0m17:47:27.175317 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m17:47:27.177332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m17:47:27.182391 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m17:47:27.182659 [info ] [MainThread]: 
[0m17:47:27.182938 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:47:27.183157 [info ] [MainThread]: 
[0m17:47:27.183418 [error] [MainThread]:   Database Error in model dim_customers (models/marts/dim_customers.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [17:1]
  compiled code at target/run/olist_analytics/models/marts/dim_customers.sql
[0m17:47:27.183626 [info ] [MainThread]: 
[0m17:47:27.183864 [error] [MainThread]:   Database Error in model dim_reviews (models/marts/dim_reviews.sql)
  Error while reading table: stellar-verve-478012-n6.olist_raw.reviews, error message: Missing close quote character (").; line_number: 14 byte_offset_to_start_of_line: 1841 column_index: 4 column_name: "review_comment_me..." column_type: STRING value: "Mas um pouco ,tra..." File: gs://dsai2-olist-raw-data/raw/olist/olist_order_reviews_dataset.csv
  compiled code at target/run/olist_analytics/models/marts/dim_reviews.sql
[0m17:47:27.184156 [info ] [MainThread]: 
[0m17:47:27.184533 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=0 TOTAL=18
[0m17:47:27.184955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 61.80088, "process_in_blocks": "0", "process_kernel_time": 2.914557, "process_mem_max_rss": "477151232", "process_out_blocks": "0", "process_user_time": 5.174589}
[0m17:47:27.185257 [debug] [MainThread]: Command `dbt run` failed at 17:47:27.185205 after 61.80 seconds
[0m17:47:27.185526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d00150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3079b5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a212b50>]}
[0m17:47:27.185755 [debug] [MainThread]: Flushing usage events
[0m17:47:28.816028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:33.927401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d550b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d533590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5e5f10>]}


============================== 18:18:33.930152 | 29ef9fa3-75aa-4b85-ad19-3aa92f28be35 ==============================
[0m18:18:33.930152 [info ] [MainThread]: Running with dbt=1.9.6
[0m18:18:33.930519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:18:36.879133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c7e3ed0>]}
[0m18:18:36.914930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11917b990>]}
[0m18:18:36.915332 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:18:37.081509 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m18:18:37.156433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:18:37.156814 [debug] [MainThread]: Partial parsing: updated file: olist_analytics://models/marts/dim_customers.sql
[0m18:18:37.308670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c19eb90>]}
[0m18:18:37.345872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m18:18:37.346991 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m18:18:37.360138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16caa84d0>]}
[0m18:18:37.360440 [info ] [MainThread]: Found 18 models, 9 sources, 494 macros
[0m18:18:37.360640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c153a10>]}
[0m18:18:37.362016 [info ] [MainThread]: 
[0m18:18:37.362228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:37.362391 [info ] [MainThread]: 
[0m18:18:37.362650 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:18:37.365198 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m18:18:37.365426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:37.935447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:38.452067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw_staging)
[0m18:18:38.452863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:38.860852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_staging, now list_stellar-verve-478012-n6_olist_raw_analytics)
[0m18:18:38.863496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:39.271979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ca56ad0>]}
[0m18:18:39.273043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:39.279535 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_date
[0m18:18:39.280279 [info ] [Thread-1 (]: 1 of 18 START sql table model olist_raw_analytics.dim_date ..................... [RUN]
[0m18:18:39.280863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_analytics, now model.olist_analytics.dim_date)
[0m18:18:39.281304 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_date
[0m18:18:39.289661 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_date"
[0m18:18:39.290751 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_date
[0m18:18:39.303608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:39.811941 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_date"
[0m18:18:39.814076 [debug] [Thread-1 (]: On model.olist_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_date"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_date`
      
    
    

    OPTIONS()
    as (
      -- Standard BigQuery SQL to generate dates
with date_spine as (
  select 
    * from 
    unnest(generate_date_array('2016-01-01', '2020-01-01', interval 1 day)) as date_day
)

select
  date_day,
  extract(year from date_day) as year,
  extract(month from date_day) as month,
  extract(day from date_day) as day,
  extract(dayofweek from date_day) as day_of_week,
  format_date('%B', date_day) as month_name,
  format_date('%A', date_day) as day_name,
  case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend
from date_spine
    );
  
[0m18:18:40.495720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:d32efb32-d98e-4303-82c9-f5af30f53653&page=queryresults
[0m18:18:44.215966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ca69550>]}
[0m18:18:44.216917 [info ] [Thread-1 (]: 1 of 18 OK created sql table model olist_raw_analytics.dim_date ................ [[32mCREATE TABLE (1.5k rows, 0 processed)[0m in 4.93s]
[0m18:18:44.217502 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_date
[0m18:18:44.217890 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m18:18:44.218414 [info ] [Thread-1 (]: 2 of 18 START sql view model olist_raw_staging.stg_customers ................... [RUN]
[0m18:18:44.218860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_date, now model.olist_analytics.stg_customers)
[0m18:18:44.219182 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m18:18:44.222149 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m18:18:44.223112 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m18:18:44.237307 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m18:18:44.238026 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m18:18:44.238333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:44.863109 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:5610a30e-fe50-443f-9444-9cba6b01bb7d&page=queryresults
[0m18:18:45.467188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16caa8850>]}
[0m18:18:45.468352 [info ] [Thread-1 (]: 2 of 18 OK created sql view model olist_raw_staging.stg_customers .............. [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m18:18:45.469146 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m18:18:45.469686 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m18:18:45.470246 [info ] [Thread-1 (]: 3 of 18 START sql view model olist_raw_staging.stg_geolocation ................. [RUN]
[0m18:18:45.470952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m18:18:45.471627 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m18:18:45.475399 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m18:18:45.476545 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m18:18:45.480818 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m18:18:45.481593 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m18:18:45.482157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:46.228806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:c4906397-79d9-4678-86b3-91dcaf57702e&page=queryresults
[0m18:18:46.850253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f544f90>]}
[0m18:18:46.851385 [info ] [Thread-1 (]: 3 of 18 OK created sql view model olist_raw_staging.stg_geolocation ............ [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m18:18:46.852033 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m18:18:46.852476 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m18:18:46.853119 [info ] [Thread-1 (]: 4 of 18 START sql view model olist_raw_staging.stg_order_items ................. [RUN]
[0m18:18:46.853765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m18:18:46.854159 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m18:18:46.857845 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m18:18:46.858913 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m18:18:46.862102 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m18:18:46.863183 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m18:18:46.863805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:47.461816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:4a5766bf-175b-4ab8-955a-151012604c9b&page=queryresults
[0m18:18:48.181165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f55cf10>]}
[0m18:18:48.182164 [info ] [Thread-1 (]: 4 of 18 OK created sql view model olist_raw_staging.stg_order_items ............ [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m18:18:48.182967 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m18:18:48.183475 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m18:18:48.184161 [info ] [Thread-1 (]: 5 of 18 START sql view model olist_raw_staging.stg_order_payments .............. [RUN]
[0m18:18:48.184812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m18:18:48.185289 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m18:18:48.189120 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m18:18:48.190289 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m18:18:48.193868 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m18:18:48.194786 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m18:18:48.195210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:48.894507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:b6a58a70-e18a-4269-b0c7-7ac5e020f48d&page=queryresults
[0m18:18:49.526264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f501e50>]}
[0m18:18:49.527293 [info ] [Thread-1 (]: 5 of 18 OK created sql view model olist_raw_staging.stg_order_payments ......... [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m18:18:49.528036 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m18:18:49.528548 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m18:18:49.529117 [info ] [Thread-1 (]: 6 of 18 START sql view model olist_raw_staging.stg_order_reviews ............... [RUN]
[0m18:18:49.529844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m18:18:49.530545 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m18:18:49.535081 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m18:18:49.537279 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m18:18:49.540635 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m18:18:49.541615 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m18:18:49.542036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:50.160589 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:ea9954a2-6ec6-4710-bd5b-06a2200d6bd6&page=queryresults
[0m18:18:50.841992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e15a2d0>]}
[0m18:18:50.843234 [info ] [Thread-1 (]: 6 of 18 OK created sql view model olist_raw_staging.stg_order_reviews .......... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m18:18:50.844017 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m18:18:50.844527 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m18:18:50.845184 [info ] [Thread-1 (]: 7 of 18 START sql view model olist_raw_staging.stg_orders ...................... [RUN]
[0m18:18:50.845885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m18:18:50.846356 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m18:18:50.850330 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m18:18:50.851322 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m18:18:50.854571 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m18:18:50.855466 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m18:18:50.856127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:51.458061 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:cf464f07-b557-41f2-bc02-f2928abce3de&page=queryresults
[0m18:18:52.173238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e0e1f90>]}
[0m18:18:52.174284 [info ] [Thread-1 (]: 7 of 18 OK created sql view model olist_raw_staging.stg_orders ................. [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m18:18:52.174999 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m18:18:52.175513 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m18:18:52.176085 [info ] [Thread-1 (]: 8 of 18 START sql view model olist_raw_staging.stg_product_category_name_translation  [RUN]
[0m18:18:52.176869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m18:18:52.177415 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m18:18:52.182971 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m18:18:52.183831 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m18:18:52.187252 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m18:18:52.188783 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m18:18:52.189322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:52.883173 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:517dc83b-8718-4cf6-98af-aee1766997bc&page=queryresults
[0m18:18:53.609973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f66ddd0>]}
[0m18:18:53.611217 [info ] [Thread-1 (]: 8 of 18 OK created sql view model olist_raw_staging.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m18:18:53.612001 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m18:18:53.612538 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m18:18:53.613112 [info ] [Thread-1 (]: 9 of 18 START sql view model olist_raw_staging.stg_products .................... [RUN]
[0m18:18:53.613847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m18:18:53.614409 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m18:18:53.618412 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m18:18:53.619291 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m18:18:53.622563 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m18:18:53.623235 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m18:18:53.623821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:54.320028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:28cf0b65-09c8-4e8c-a8be-bb9cd6f0f0de&page=queryresults
[0m18:18:55.038016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f6290d0>]}
[0m18:18:55.039322 [info ] [Thread-1 (]: 9 of 18 OK created sql view model olist_raw_staging.stg_products ............... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m18:18:55.040102 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m18:18:55.040621 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m18:18:55.041328 [info ] [Thread-1 (]: 10 of 18 START sql view model olist_raw_staging.stg_sellers .................... [RUN]
[0m18:18:55.042094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m18:18:55.042576 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m18:18:55.046414 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m18:18:55.047793 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m18:18:55.050839 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m18:18:55.051746 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m18:18:55.052163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:55.758890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:8fe1090f-aeb4-40af-86e2-1fc89cc88300&page=queryresults
[0m18:18:56.510265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c170c90>]}
[0m18:18:56.511375 [info ] [Thread-1 (]: 10 of 18 OK created sql view model olist_raw_staging.stg_sellers ............... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m18:18:56.512109 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m18:18:56.512631 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_customers
[0m18:18:56.513389 [info ] [Thread-1 (]: 11 of 18 START sql table model olist_raw_analytics.dim_customers ............... [RUN]
[0m18:18:56.514094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_sellers, now model.olist_analytics.dim_customers)
[0m18:18:56.514616 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_customers
[0m18:18:56.518387 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m18:18:56.519562 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_customers
[0m18:18:56.522631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:56.865681 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m18:18:56.867556 [debug] [Thread-1 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
)

select
    customer_id,        -- Included as requested (Primary Key)
    customer_unique_id, -- The actual person's ID (Foreign Key to user history)
    zip_code,
    city,
    state
from customers
    );
  
[0m18:18:57.697003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:04ee59ec-7fff-465c-b1e2-6bebcba42c06&page=queryresults
[0m18:19:00.931119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f683110>]}
[0m18:19:00.932591 [info ] [Thread-1 (]: 11 of 18 OK created sql table model olist_raw_analytics.dim_customers .......... [[32mCREATE TABLE (99.4k rows, 8.6 MiB processed)[0m in 4.42s]
[0m18:19:00.933473 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_customers
[0m18:19:00.934028 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_geolocation
[0m18:19:00.934706 [info ] [Thread-1 (]: 12 of 18 START sql table model olist_raw_analytics.dim_geolocation ............. [RUN]
[0m18:19:00.935376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_customers, now model.olist_analytics.dim_geolocation)
[0m18:19:00.935872 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_geolocation
[0m18:19:00.940293 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_geolocation"
[0m18:19:00.942680 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_geolocation
[0m18:19:00.945603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:01.395549 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_geolocation"
[0m18:19:01.397222 [debug] [Thread-1 (]: On model.olist_analytics.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_geolocation"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      with geolocation as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
)

select
    zip_code,
    -- Calculate the center point of the zip code
    avg(latitude) as latitude,
    avg(longitude) as longitude,
    max(city) as city,
    max(state) as state
from geolocation
group by zip_code
    );
  
[0m18:19:02.205117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:c6713665-2fe2-426f-9466-23495611a7e2&page=queryresults
[0m18:19:08.355777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f62c310>]}
[0m18:19:08.356759 [info ] [Thread-1 (]: 12 of 18 OK created sql table model olist_raw_analytics.dim_geolocation ........ [[32mCREATE TABLE (19.0k rows, 58.4 MiB processed)[0m in 7.42s]
[0m18:19:08.357299 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_geolocation
[0m18:19:08.357679 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_payments
[0m18:19:08.358055 [info ] [Thread-1 (]: 13 of 18 START sql table model olist_raw_analytics.dim_payments ................ [RUN]
[0m18:19:08.358575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_geolocation, now model.olist_analytics.dim_payments)
[0m18:19:08.358964 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_payments
[0m18:19:08.362074 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_payments"
[0m18:19:08.364206 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_payments
[0m18:19:08.366313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:08.760258 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_payments"
[0m18:19:08.762768 [debug] [Thread-1 (]: On model.olist_analytics.dim_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_payments"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_payments`
      
    
    

    OPTIONS()
    as (
      with payments as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
)

select
    -- Generate a unique key for each payment row
    concat(order_id, '-', cast(payment_sequential as string)) as payment_sk,
    
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from payments
    );
  
[0m18:19:09.575507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:2f56d898-77aa-4bf7-9ee0-26946deff5b3&page=queryresults
[0m18:19:12.639283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f4d3050>]}
[0m18:19:12.640436 [info ] [Thread-1 (]: 13 of 18 OK created sql table model olist_raw_analytics.dim_payments ........... [[32mCREATE TABLE (103.9k rows, 5.5 MiB processed)[0m in 4.28s]
[0m18:19:12.641122 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_payments
[0m18:19:12.641787 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_reviews
[0m18:19:12.642635 [info ] [Thread-1 (]: 14 of 18 START sql table model olist_raw_analytics.dim_reviews ................. [RUN]
[0m18:19:12.643339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_payments, now model.olist_analytics.dim_reviews)
[0m18:19:12.643825 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_reviews
[0m18:19:12.648265 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_reviews"
[0m18:19:12.649462 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_reviews
[0m18:19:12.653474 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_reviews"
[0m18:19:12.655392 [debug] [Thread-1 (]: On model.olist_analytics.dim_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_reviews"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_reviews`
      
    
    

    OPTIONS()
    as (
      with reviews as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
)

select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    created_at as review_created_at,
    answer_timestamp as review_answered_at
from reviews
    );
  
[0m18:19:12.655935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:13.570991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:bbcf2a85-1ffd-4c2f-8700-57e9b69ef090&page=queryresults
[0m18:19:14.186874 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:bbcf2a85-1ffd-4c2f-8700-57e9b69ef090&page=queryresults
[0m18:19:14.206043 [debug] [Thread-1 (]: Database Error in model dim_reviews (models/marts/dim_reviews.sql)
  Error while reading table: stellar-verve-478012-n6.olist_raw.reviews, error message: Missing close quote character (").; line_number: 14 byte_offset_to_start_of_line: 1841 column_index: 4 column_name: "review_comment_me..." column_type: STRING value: "Mas um pouco ,tra..." File: gs://dsai2-olist-raw-data/raw/olist/olist_order_reviews_dataset.csv
  compiled code at target/run/olist_analytics/models/marts/dim_reviews.sql
[0m18:19:14.206959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f61f9d0>]}
[0m18:19:14.207714 [error] [Thread-1 (]: 14 of 18 ERROR creating sql table model olist_raw_analytics.dim_reviews ........ [[31mERROR[0m in 1.56s]
[0m18:19:14.208282 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_reviews
[0m18:19:14.208680 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_order_items
[0m18:19:14.209172 [debug] [Thread-4 (]: Marking all children of 'model.olist_analytics.dim_reviews' to be skipped because of status 'error'.  Reason: Database Error in model dim_reviews (models/marts/dim_reviews.sql)
  Error while reading table: stellar-verve-478012-n6.olist_raw.reviews, error message: Missing close quote character (").; line_number: 14 byte_offset_to_start_of_line: 1841 column_index: 4 column_name: "review_comment_me..." column_type: STRING value: "Mas um pouco ,tra..." File: gs://dsai2-olist-raw-data/raw/olist/olist_order_reviews_dataset.csv
  compiled code at target/run/olist_analytics/models/marts/dim_reviews.sql.
[0m18:19:14.209960 [info ] [Thread-1 (]: 15 of 18 START sql table model olist_raw_analytics.fct_order_items ............. [RUN]
[0m18:19:14.211594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_reviews, now model.olist_analytics.fct_order_items)
[0m18:19:14.212151 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_order_items
[0m18:19:14.219522 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_order_items"
[0m18:19:14.221580 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_order_items
[0m18:19:14.225532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:14.592826 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_order_items"
[0m18:19:14.594498 [debug] [Thread-1 (]: On model.olist_analytics.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_order_items"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_order_items`
      
    
    

    OPTIONS()
    as (
      with items as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
),

orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    -- Surrogate Key (Good practice to have a unique string for every row)
    concat(items.order_id, '-', cast(items.order_item_id as string)) as order_item_sk,
    
    items.order_id,
    items.order_item_id,
    items.product_id,
    items.seller_id,
    
    -- We bring in Customer ID from the orders table so we can slice sales by customer location later
    orders.customer_id,
    
    items.price,
    items.freight_value,
    
    -- Calculated Total
    (items.price + items.freight_value) as total_order_value

from items
left join orders 
    on items.order_id = orders.order_id
    );
  
[0m18:19:15.415875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:c73a194d-59a6-47f8-a030-72a62b05ac8e&page=queryresults
[0m18:19:20.281968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f31bf90>]}
[0m18:19:20.283432 [info ] [Thread-1 (]: 15 of 18 OK created sql table model olist_raw_analytics.fct_order_items ........ [[32mCREATE TABLE (112.7k rows, 31.6 MiB processed)[0m in 6.07s]
[0m18:19:20.284186 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_order_items
[0m18:19:20.284707 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m18:19:20.285246 [info ] [Thread-1 (]: 16 of 18 START sql table model olist_raw_analytics.fct_orders .................. [RUN]
[0m18:19:20.285779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_order_items, now model.olist_analytics.fct_orders)
[0m18:19:20.286227 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m18:19:20.290427 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m18:19:20.291809 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m18:19:20.294868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:20.740637 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m18:19:20.743961 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_orders`
      
    
    

    OPTIONS()
    as (
      with orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    order_id,
    customer_id,
    order_status,
    
    -- Timestamps
    purchase_at,
    approved_at,
    delivered_carrier_at,
    delivered_customer_at,
    estimated_delivery_at,

    -- Calculated Metrics (BigQuery Syntax)
    -- 1. How long did it take to deliver?
    timestamp_diff(delivered_customer_at, purchase_at, hour) as time_to_delivery_hours,
    
    -- 2. Was it late? (Difference between estimated and actual)
    -- Positive numbers mean it arrived early, Negative means it was late
    timestamp_diff(estimated_delivery_at, delivered_customer_at, day) as days_early_or_late

from orders
    );
  
[0m18:19:21.561754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:328c3fb0-2f48-48bb-ac4f-4907c3bb8177&page=queryresults
[0m18:19:25.621424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f649c90>]}
[0m18:19:25.622075 [info ] [Thread-1 (]: 16 of 18 OK created sql table model olist_raw_analytics.fct_orders ............. [[32mCREATE TABLE (99.4k rows, 16.8 MiB processed)[0m in 5.34s]
[0m18:19:25.622497 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m18:19:25.622791 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m18:19:25.623158 [info ] [Thread-1 (]: 17 of 18 START sql table model olist_raw_analytics.dim_products ................ [RUN]
[0m18:19:25.623506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_orders, now model.olist_analytics.dim_products)
[0m18:19:25.623775 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m18:19:25.625992 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m18:19:25.626490 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m18:19:25.630310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:25.993682 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m18:19:25.995017 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with products as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
),

translations as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
)

select
    p.product_id,
    -- If english name is null, fall back to original name, then to 'Unknown'
    coalesce(t.product_category_name_english, p.product_category_name, 'Unknown') as category_name,
    p.photos_quantity,
    p.weight_g,
    p.length_cm,
    p.height_cm,
    p.width_cm
from products p
left join translations t 
    on p.product_category_name = t.product_category_name
    );
  
[0m18:19:26.810665 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:f232443b-612b-4e49-9055-82d06b12fc55&page=queryresults
[0m18:19:29.875558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f7c3450>]}
[0m18:19:29.876278 [info ] [Thread-1 (]: 17 of 18 OK created sql table model olist_raw_analytics.dim_products ........... [[32mCREATE TABLE (33.0k rows, 2.3 MiB processed)[0m in 4.25s]
[0m18:19:29.876733 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m18:19:29.877037 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_sellers
[0m18:19:29.877361 [info ] [Thread-1 (]: 18 of 18 START sql table model olist_raw_analytics.dim_sellers ................. [RUN]
[0m18:19:29.877765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_products, now model.olist_analytics.dim_sellers)
[0m18:19:29.878105 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_sellers
[0m18:19:29.880392 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_sellers"
[0m18:19:29.881265 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_sellers
[0m18:19:29.883692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:30.228500 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_sellers"
[0m18:19:30.230154 [debug] [Thread-1 (]: On model.olist_analytics.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_sellers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_sellers`
      
    
    

    OPTIONS()
    as (
      with sellers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
)

select
    seller_id,
    zip_code,
    city,
    state
from sellers
    );
  
[0m18:19:30.965245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:4060bcc8-0dc6-4314-898f-d5f246b3c098&page=queryresults
[0m18:19:33.282705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29ef9fa3-75aa-4b85-ad19-3aa92f28be35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f59f5d0>]}
[0m18:19:33.284086 [info ] [Thread-1 (]: 18 of 18 OK created sql table model olist_raw_analytics.dim_sellers ............ [[32mCREATE TABLE (3.1k rows, 170.5 KiB processed)[0m in 3.40s]
[0m18:19:33.284880 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_sellers
[0m18:19:33.286756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:33.287642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:33.288064 [debug] [MainThread]: Connection 'model.olist_analytics.dim_sellers' was properly closed.
[0m18:19:33.288677 [info ] [MainThread]: 
[0m18:19:33.289082 [info ] [MainThread]: Finished running 9 table models, 9 view models in 0 hours 0 minutes and 55.93 seconds (55.93s).
[0m18:19:33.292246 [debug] [MainThread]: Command end result
[0m18:19:33.319250 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m18:19:33.320922 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m18:19:33.325730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m18:19:33.325982 [info ] [MainThread]: 
[0m18:19:33.326247 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:19:33.326459 [info ] [MainThread]: 
[0m18:19:33.326720 [error] [MainThread]:   Database Error in model dim_reviews (models/marts/dim_reviews.sql)
  Error while reading table: stellar-verve-478012-n6.olist_raw.reviews, error message: Missing close quote character (").; line_number: 14 byte_offset_to_start_of_line: 1841 column_index: 4 column_name: "review_comment_me..." column_type: STRING value: "Mas um pouco ,tra..." File: gs://dsai2-olist-raw-data/raw/olist/olist_order_reviews_dataset.csv
  compiled code at target/run/olist_analytics/models/marts/dim_reviews.sql
[0m18:19:33.326955 [info ] [MainThread]: 
[0m18:19:33.327176 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=1 SKIP=0 TOTAL=18
[0m18:19:33.327559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 59.441017, "process_in_blocks": "0", "process_kernel_time": 2.763696, "process_mem_max_rss": "475627520", "process_out_blocks": "0", "process_user_time": 5.234772}
[0m18:19:33.327868 [debug] [MainThread]: Command `dbt run` failed at 18:19:33.327815 after 59.44 seconds
[0m18:19:33.328177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5e5c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104802650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c13d210>]}
[0m18:19:33.328405 [debug] [MainThread]: Flushing usage events
[0m18:19:35.074543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:11.803467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c50bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c8a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce2690>]}


============================== 18:33:11.805979 | 4fe7d4fc-d75b-4441-912d-968004828f09 ==============================
[0m18:33:11.805979 [info ] [MainThread]: Running with dbt=1.9.6
[0m18:33:11.806383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:33:14.649235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11268f9d0>]}
[0m18:33:14.684309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757b8d0>]}
[0m18:33:14.684657 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:33:14.851177 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m18:33:14.925588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:33:14.925838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:33:14.943499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dd4b590>]}
[0m18:33:14.981938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m18:33:14.983051 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m18:33:14.995799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dd68390>]}
[0m18:33:14.996102 [info ] [MainThread]: Found 18 models, 9 sources, 494 macros
[0m18:33:14.996312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c35f90>]}
[0m18:33:14.997662 [info ] [MainThread]: 
[0m18:33:14.997875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:14.998036 [info ] [MainThread]: 
[0m18:33:14.998300 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:33:15.000869 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m18:33:15.001107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:15.483320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:16.038142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw_analytics)
[0m18:33:16.039059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:16.447291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_analytics, now list_stellar-verve-478012-n6_olist_raw_staging)
[0m18:33:16.450099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:16.861672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dd177d0>]}
[0m18:33:16.862698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:16.869742 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_date
[0m18:33:16.870331 [info ] [Thread-1 (]: 1 of 18 START sql table model olist_raw_analytics.dim_date ..................... [RUN]
[0m18:33:16.870794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_staging, now model.olist_analytics.dim_date)
[0m18:33:16.871153 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_date
[0m18:33:16.880240 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_date"
[0m18:33:16.881256 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_date
[0m18:33:16.893095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:17.350475 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_date"
[0m18:33:17.352264 [debug] [Thread-1 (]: On model.olist_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_date"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_date`
      
    
    

    OPTIONS()
    as (
      -- Standard BigQuery SQL to generate dates
with date_spine as (
  select 
    * from 
    unnest(generate_date_array('2016-01-01', '2020-01-01', interval 1 day)) as date_day
)

select
  date_day,
  extract(year from date_day) as year,
  extract(month from date_day) as month,
  extract(day from date_day) as day,
  extract(dayofweek from date_day) as day_of_week,
  format_date('%B', date_day) as month_name,
  format_date('%A', date_day) as day_name,
  case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend
from date_spine
    );
  
[0m18:33:17.980208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:65bb496a-ccda-4299-80ae-fde4d381c318&page=queryresults
[0m18:33:20.258564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dec7310>]}
[0m18:33:20.259702 [info ] [Thread-1 (]: 1 of 18 OK created sql table model olist_raw_analytics.dim_date ................ [[32mCREATE TABLE (1.5k rows, 0 processed)[0m in 3.39s]
[0m18:33:20.260267 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_date
[0m18:33:20.260649 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m18:33:20.261044 [info ] [Thread-1 (]: 2 of 18 START sql view model olist_raw_staging.stg_customers ................... [RUN]
[0m18:33:20.261545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_date, now model.olist_analytics.stg_customers)
[0m18:33:20.261928 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m18:33:20.264968 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m18:33:20.266289 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m18:33:20.280643 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m18:33:20.281268 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m18:33:20.281570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:20.947214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3e911e8e-42fa-4696-affc-73942f198fd7&page=queryresults
[0m18:33:21.672143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1770e04d0>]}
[0m18:33:21.673403 [info ] [Thread-1 (]: 2 of 18 OK created sql view model olist_raw_staging.stg_customers .............. [[32mCREATE VIEW (0 processed)[0m in 1.41s]
[0m18:33:21.674164 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m18:33:21.674708 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m18:33:21.675289 [info ] [Thread-1 (]: 3 of 18 START sql view model olist_raw_staging.stg_geolocation ................. [RUN]
[0m18:33:21.676117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m18:33:21.676683 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m18:33:21.680868 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m18:33:21.681976 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m18:33:21.685496 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m18:33:21.686260 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m18:33:21.686742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:22.304091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:1018587d-2155-4bee-906f-1d922d3a5cda&page=queryresults
[0m18:33:23.007240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x177164b90>]}
[0m18:33:23.008341 [info ] [Thread-1 (]: 3 of 18 OK created sql view model olist_raw_staging.stg_geolocation ............ [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m18:33:23.009116 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m18:33:23.009644 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m18:33:23.010204 [info ] [Thread-1 (]: 4 of 18 START sql view model olist_raw_staging.stg_order_items ................. [RUN]
[0m18:33:23.010804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m18:33:23.011346 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m18:33:23.014940 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m18:33:23.016055 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m18:33:23.019497 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m18:33:23.021033 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m18:33:23.021603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:23.710424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:dd59cc55-666a-4e85-b39b-66ea20cb5370&page=queryresults
[0m18:33:24.296740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1770a7190>]}
[0m18:33:24.299117 [info ] [Thread-1 (]: 4 of 18 OK created sql view model olist_raw_staging.stg_order_items ............ [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m18:33:24.300172 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m18:33:24.300765 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m18:33:24.301514 [info ] [Thread-1 (]: 5 of 18 START sql view model olist_raw_staging.stg_order_payments .............. [RUN]
[0m18:33:24.302204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m18:33:24.302721 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m18:33:24.307002 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m18:33:24.308332 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m18:33:24.311697 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m18:33:24.312600 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m18:33:24.313054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:24.941889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:97c133d2-64a0-4a67-b768-176e65383d5b&page=queryresults
[0m18:33:25.667456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172441c10>]}
[0m18:33:25.668696 [info ] [Thread-1 (]: 5 of 18 OK created sql view model olist_raw_staging.stg_order_payments ......... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m18:33:25.669487 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m18:33:25.670039 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m18:33:25.670624 [info ] [Thread-1 (]: 6 of 18 START sql view model olist_raw_staging.stg_order_reviews ............... [RUN]
[0m18:33:25.671641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m18:33:25.672373 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m18:33:25.677035 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m18:33:25.678332 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m18:33:25.681724 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m18:33:25.682513 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m18:33:25.682926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:26.374835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:b222d754-a269-4012-9ed0-0c454763b28a&page=queryresults
[0m18:33:26.993498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1727a8650>]}
[0m18:33:26.994527 [info ] [Thread-1 (]: 6 of 18 OK created sql view model olist_raw_staging.stg_order_reviews .......... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m18:33:26.995103 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m18:33:26.995495 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m18:33:26.996069 [info ] [Thread-1 (]: 7 of 18 START sql view model olist_raw_staging.stg_orders ...................... [RUN]
[0m18:33:26.996694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m18:33:26.997107 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m18:33:27.000261 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m18:33:27.001073 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m18:33:27.003961 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m18:33:27.005422 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m18:33:27.005952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:27.542479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:eddae890-1271-4d88-ba6e-cc4a234c34e7&page=queryresults
[0m18:33:28.212003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dd746d0>]}
[0m18:33:28.212600 [info ] [Thread-1 (]: 7 of 18 OK created sql view model olist_raw_staging.stg_orders ................. [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m18:33:28.213003 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m18:33:28.213286 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m18:33:28.213600 [info ] [Thread-1 (]: 8 of 18 START sql view model olist_raw_staging.stg_product_category_name_translation  [RUN]
[0m18:33:28.213960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m18:33:28.214309 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m18:33:28.216444 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m18:33:28.217008 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m18:33:28.220281 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m18:33:28.221203 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m18:33:28.221639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:28.831960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:5234ef3e-94dd-4809-8a3b-7e7209caaf33&page=queryresults
[0m18:33:29.554442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1771c6f90>]}
[0m18:33:29.555360 [info ] [Thread-1 (]: 8 of 18 OK created sql view model olist_raw_staging.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m18:33:29.555890 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m18:33:29.556263 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m18:33:29.556778 [info ] [Thread-1 (]: 9 of 18 START sql view model olist_raw_staging.stg_products .................... [RUN]
[0m18:33:29.557225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m18:33:29.557557 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m18:33:29.560896 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m18:33:29.561862 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m18:33:29.564634 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m18:33:29.565224 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m18:33:29.565554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:30.162666 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:740569e3-3cd5-4d7d-947d-a4394afc390e&page=queryresults
[0m18:33:30.888911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x177191ad0>]}
[0m18:33:30.890032 [info ] [Thread-1 (]: 9 of 18 OK created sql view model olist_raw_staging.stg_products ............... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m18:33:30.890790 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m18:33:30.891319 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m18:33:30.891863 [info ] [Thread-1 (]: 10 of 18 START sql view model olist_raw_staging.stg_sellers .................... [RUN]
[0m18:33:30.892663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m18:33:30.893240 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m18:33:30.897532 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m18:33:30.899998 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m18:33:30.903320 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m18:33:30.904135 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m18:33:30.904515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.598621 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:477e25a5-0d8e-40dc-b01b-37703dae6e5d&page=queryresults
[0m18:33:32.321197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x177178c50>]}
[0m18:33:32.322195 [info ] [Thread-1 (]: 10 of 18 OK created sql view model olist_raw_staging.stg_sellers ............... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m18:33:32.322836 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m18:33:32.323295 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_customers
[0m18:33:32.324043 [info ] [Thread-1 (]: 11 of 18 START sql table model olist_raw_analytics.dim_customers ............... [RUN]
[0m18:33:32.324633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_sellers, now model.olist_analytics.dim_customers)
[0m18:33:32.325046 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_customers
[0m18:33:32.328671 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m18:33:32.329547 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_customers
[0m18:33:32.332158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:32.727479 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m18:33:32.730710 [debug] [Thread-1 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
)

select
    customer_id,        -- Included as requested (Primary Key)
    customer_unique_id, -- The actual person's ID (Foreign Key to user history)
    zip_code,
    city,
    state
from customers
    );
  
[0m18:33:33.485116 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:b44e739f-e69e-4147-a593-45eb1fbe5991&page=queryresults
[0m18:33:37.644471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1770bca10>]}
[0m18:33:37.645867 [info ] [Thread-1 (]: 11 of 18 OK created sql table model olist_raw_analytics.dim_customers .......... [[32mCREATE TABLE (99.4k rows, 8.6 MiB processed)[0m in 5.32s]
[0m18:33:37.646648 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_customers
[0m18:33:37.647189 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_geolocation
[0m18:33:37.647743 [info ] [Thread-1 (]: 12 of 18 START sql table model olist_raw_analytics.dim_geolocation ............. [RUN]
[0m18:33:37.648289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_customers, now model.olist_analytics.dim_geolocation)
[0m18:33:37.648863 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_geolocation
[0m18:33:37.653466 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_geolocation"
[0m18:33:37.656165 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_geolocation
[0m18:33:37.659112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:38.050998 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_geolocation"
[0m18:33:38.052687 [debug] [Thread-1 (]: On model.olist_analytics.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_geolocation"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      with geolocation as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
)

select
    zip_code,
    -- Calculate the center point of the zip code
    avg(latitude) as latitude,
    avg(longitude) as longitude,
    max(city) as city,
    max(state) as state
from geolocation
group by zip_code
    );
  
[0m18:33:38.867826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:c5929b3d-5806-41ad-a1ac-d438fb58f4a0&page=queryresults
[0m18:33:45.332514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x177167cd0>]}
[0m18:33:45.333699 [info ] [Thread-1 (]: 12 of 18 OK created sql table model olist_raw_analytics.dim_geolocation ........ [[32mCREATE TABLE (19.0k rows, 58.4 MiB processed)[0m in 7.68s]
[0m18:33:45.334489 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_geolocation
[0m18:33:45.335027 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_payments
[0m18:33:45.335760 [info ] [Thread-1 (]: 13 of 18 START sql table model olist_raw_analytics.dim_payments ................ [RUN]
[0m18:33:45.336400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_geolocation, now model.olist_analytics.dim_payments)
[0m18:33:45.336896 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_payments
[0m18:33:45.344048 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_payments"
[0m18:33:45.346038 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_payments
[0m18:33:45.348487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:45.693662 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_payments"
[0m18:33:45.695994 [debug] [Thread-1 (]: On model.olist_analytics.dim_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_payments"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_payments`
      
    
    

    OPTIONS()
    as (
      with payments as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
)

select
    -- Generate a unique key for each payment row
    concat(order_id, '-', cast(payment_sequential as string)) as payment_sk,
    
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from payments
    );
  
[0m18:33:46.444857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:8fe6efce-4718-41ed-8061-ba51e73909be&page=queryresults
[0m18:33:51.711465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x177177b10>]}
[0m18:33:51.712710 [info ] [Thread-1 (]: 13 of 18 OK created sql table model olist_raw_analytics.dim_payments ........... [[32mCREATE TABLE (103.9k rows, 5.5 MiB processed)[0m in 6.37s]
[0m18:33:51.713458 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_payments
[0m18:33:51.713998 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_reviews
[0m18:33:51.714674 [info ] [Thread-1 (]: 14 of 18 START sql table model olist_raw_analytics.dim_reviews ................. [RUN]
[0m18:33:51.715334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_payments, now model.olist_analytics.dim_reviews)
[0m18:33:51.715832 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_reviews
[0m18:33:51.719926 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_reviews"
[0m18:33:51.721152 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_reviews
[0m18:33:51.724792 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_reviews"
[0m18:33:51.725905 [debug] [Thread-1 (]: On model.olist_analytics.dim_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_reviews"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_reviews`
      
    
    

    OPTIONS()
    as (
      with reviews as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
)

select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    created_at as review_created_at,
    answer_timestamp as review_answered_at
from reviews
    );
  
[0m18:33:51.726494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:52.462276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:fd42442f-3a97-4a2a-aefd-5b6b43bc3406&page=queryresults
[0m18:33:56.837441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1771ad7d0>]}
[0m18:33:56.838592 [info ] [Thread-1 (]: 14 of 18 OK created sql table model olist_raw_analytics.dim_reviews ............ [[32mCREATE TABLE (99.2k rows, 13.8 MiB processed)[0m in 5.12s]
[0m18:33:56.839020 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_reviews
[0m18:33:56.839266 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_order_items
[0m18:33:56.839586 [info ] [Thread-1 (]: 15 of 18 START sql table model olist_raw_analytics.fct_order_items ............. [RUN]
[0m18:33:56.839902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_reviews, now model.olist_analytics.fct_order_items)
[0m18:33:56.840128 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_order_items
[0m18:33:56.842623 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_order_items"
[0m18:33:56.843704 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_order_items
[0m18:33:56.846511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:57.193890 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_order_items"
[0m18:33:57.195693 [debug] [Thread-1 (]: On model.olist_analytics.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_order_items"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_order_items`
      
    
    

    OPTIONS()
    as (
      with items as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
),

orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    -- Surrogate Key (Good practice to have a unique string for every row)
    concat(items.order_id, '-', cast(items.order_item_id as string)) as order_item_sk,
    
    items.order_id,
    items.order_item_id,
    items.product_id,
    items.seller_id,
    
    -- We bring in Customer ID from the orders table so we can slice sales by customer location later
    orders.customer_id,
    
    items.price,
    items.freight_value,
    
    -- Calculated Total
    (items.price + items.freight_value) as total_order_value

from items
left join orders 
    on items.order_id = orders.order_id
    );
  
[0m18:33:57.924033 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:73707e99-86cb-4174-874f-63b35c2a63e6&page=queryresults
[0m18:34:03.041734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dd49c50>]}
[0m18:34:03.042863 [info ] [Thread-1 (]: 15 of 18 OK created sql table model olist_raw_analytics.fct_order_items ........ [[32mCREATE TABLE (112.7k rows, 31.6 MiB processed)[0m in 6.20s]
[0m18:34:03.043474 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_order_items
[0m18:34:03.043896 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m18:34:03.044437 [info ] [Thread-1 (]: 16 of 18 START sql table model olist_raw_analytics.fct_orders .................. [RUN]
[0m18:34:03.044946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_order_items, now model.olist_analytics.fct_orders)
[0m18:34:03.045318 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m18:34:03.048813 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m18:34:03.049811 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m18:34:03.051996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:03.548461 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m18:34:03.552864 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_orders`
      
    
    

    OPTIONS()
    as (
      with orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    order_id,
    customer_id,
    order_status,
    
    -- Timestamps
    purchase_at,
    approved_at,
    delivered_carrier_at,
    delivered_customer_at,
    estimated_delivery_at,

    -- Calculated Metrics (BigQuery Syntax)
    -- 1. How long did it take to deliver?
    timestamp_diff(delivered_customer_at, purchase_at, hour) as time_to_delivery_hours,
    
    -- 2. Was it late? (Difference between estimated and actual)
    -- Positive numbers mean it arrived early, Negative means it was late
    timestamp_diff(estimated_delivery_at, delivered_customer_at, day) as days_early_or_late

from orders
    );
  
[0m18:34:04.317399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3a8e91cf-474d-4714-8fab-e8f89676d082&page=queryresults
[0m18:34:08.567808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x177088c90>]}
[0m18:34:08.569224 [info ] [Thread-1 (]: 16 of 18 OK created sql table model olist_raw_analytics.fct_orders ............. [[32mCREATE TABLE (99.4k rows, 16.8 MiB processed)[0m in 5.52s]
[0m18:34:08.570059 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m18:34:08.570586 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m18:34:08.571276 [info ] [Thread-1 (]: 17 of 18 START sql table model olist_raw_analytics.dim_products ................ [RUN]
[0m18:34:08.571944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_orders, now model.olist_analytics.dim_products)
[0m18:34:08.572437 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m18:34:08.577023 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m18:34:08.578129 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m18:34:08.581497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:08.980419 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m18:34:08.981998 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with products as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
),

translations as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
)

select
    p.product_id,
    -- If english name is null, fall back to original name, then to 'Unknown'
    coalesce(t.product_category_name_english, p.product_category_name, 'Unknown') as category_name,
    p.photos_quantity,
    p.weight_g,
    p.length_cm,
    p.height_cm,
    p.width_cm
from products p
left join translations t 
    on p.product_category_name = t.product_category_name
    );
  
[0m18:34:09.898165 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:ee232b8a-32da-4438-a232-cd0d589b67e8&page=queryresults
[0m18:34:12.599388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1771f9610>]}
[0m18:34:12.600463 [info ] [Thread-1 (]: 17 of 18 OK created sql table model olist_raw_analytics.dim_products ........... [[32mCREATE TABLE (33.0k rows, 2.3 MiB processed)[0m in 4.03s]
[0m18:34:12.601125 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m18:34:12.601591 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_sellers
[0m18:34:12.602207 [info ] [Thread-1 (]: 18 of 18 START sql table model olist_raw_analytics.dim_sellers ................. [RUN]
[0m18:34:12.602796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_products, now model.olist_analytics.dim_sellers)
[0m18:34:12.603224 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_sellers
[0m18:34:12.606711 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_sellers"
[0m18:34:12.607820 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_sellers
[0m18:34:12.610519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:13.172755 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_sellers"
[0m18:34:13.174668 [debug] [Thread-1 (]: On model.olist_analytics.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_sellers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_sellers`
      
    
    

    OPTIONS()
    as (
      with sellers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
)

select
    seller_id,
    zip_code,
    city,
    state
from sellers
    );
  
[0m18:34:13.890070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:5a98bede-3428-4145-b577-202ca437dce0&page=queryresults
[0m18:34:16.760485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fe7d4fc-d75b-4441-912d-968004828f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1771fae10>]}
[0m18:34:16.761916 [info ] [Thread-1 (]: 18 of 18 OK created sql table model olist_raw_analytics.dim_sellers ............ [[32mCREATE TABLE (3.1k rows, 170.5 KiB processed)[0m in 4.16s]
[0m18:34:16.762684 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_sellers
[0m18:34:16.764541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:16.765379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:16.765794 [debug] [MainThread]: Connection 'model.olist_analytics.dim_sellers' was properly closed.
[0m18:34:16.766416 [info ] [MainThread]: 
[0m18:34:16.766887 [info ] [MainThread]: Finished running 9 table models, 9 view models in 0 hours 1 minutes and 1.77 seconds (61.77s).
[0m18:34:16.770303 [debug] [MainThread]: Command end result
[0m18:34:16.796270 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m18:34:16.797856 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m18:34:16.802635 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m18:34:16.802903 [info ] [MainThread]: 
[0m18:34:16.803191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:16.803424 [info ] [MainThread]: 
[0m18:34:16.803658 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m18:34:16.804041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 65.04203, "process_in_blocks": "0", "process_kernel_time": 2.784744, "process_mem_max_rss": "468156416", "process_out_blocks": "0", "process_user_time": 5.104886}
[0m18:34:16.804373 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:16.804315 after 65.04 seconds
[0m18:34:16.804652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ac7510>]}
[0m18:34:16.804901 [debug] [MainThread]: Flushing usage events
[0m18:34:18.226323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:12.648146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113555e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135dd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135deb90>]}


============================== 11:38:12.651877 | 58042f04-56fc-468c-b6d1-eba9d94b7c25 ==============================
[0m11:38:12.651877 [info ] [MainThread]: Running with dbt=1.9.6
[0m11:38:12.652238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'log_path': '/Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:38:46.446902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17adbd350>]}
[0m11:38:46.485070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106753d50>]}
[0m11:38:46.485600 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:38:46.651741 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m11:38:46.733010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:46.733363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:46.752603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16df490d0>]}
[0m11:38:46.793702 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m11:38:46.795095 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m11:38:46.809109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17ada5a50>]}
[0m11:38:46.809425 [info ] [MainThread]: Found 18 models, 9 sources, 494 macros
[0m11:38:46.809631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17ad99d90>]}
[0m11:38:46.811006 [info ] [MainThread]: 
[0m11:38:46.811219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:46.811386 [info ] [MainThread]: 
[0m11:38:46.811664 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:38:46.814227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m11:38:46.814478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:47.857087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:48.474033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw_analytics)
[0m11:38:48.474969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:49.089687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_analytics, now list_stellar-verve-478012-n6_olist_raw_staging)
[0m11:38:49.092729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:49.701609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17acf6250>]}
[0m11:38:49.702797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:49.708568 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_date
[0m11:38:49.709226 [info ] [Thread-1 (]: 1 of 18 START sql table model olist_raw_analytics.dim_date ..................... [RUN]
[0m11:38:49.709726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_staging, now model.olist_analytics.dim_date)
[0m11:38:49.710091 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_date
[0m11:38:49.718939 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_date"
[0m11:38:49.720004 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_date
[0m11:38:49.732496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:50.345074 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_date"
[0m11:38:50.347879 [debug] [Thread-1 (]: On model.olist_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_date"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_date`
      
    
    

    OPTIONS()
    as (
      -- Standard BigQuery SQL to generate dates
with date_spine as (
  select 
    * from 
    unnest(generate_date_array('2016-01-01', '2020-01-01', interval 1 day)) as date_day
)

select
  date_day,
  extract(year from date_day) as year,
  extract(month from date_day) as month,
  extract(day from date_day) as day,
  extract(dayofweek from date_day) as day_of_week,
  format_date('%B', date_day) as month_name,
  format_date('%A', date_day) as day_name,
  case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend
from date_spine
    );
  
[0m11:38:51.238774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:bba3706f-6933-457f-87f4-482ee1e1290e&page=queryresults
[0m11:38:53.715134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b19c890>]}
[0m11:38:53.716050 [info ] [Thread-1 (]: 1 of 18 OK created sql table model olist_raw_analytics.dim_date ................ [[32mCREATE TABLE (1.5k rows, 0 processed)[0m in 4.00s]
[0m11:38:53.716625 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_date
[0m11:38:53.717008 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m11:38:53.717534 [info ] [Thread-1 (]: 2 of 18 START sql view model olist_raw_staging.stg_customers ................... [RUN]
[0m11:38:53.717967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_date, now model.olist_analytics.stg_customers)
[0m11:38:53.718269 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m11:38:53.721025 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m11:38:53.722038 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m11:38:53.736448 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m11:38:53.737206 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m11:38:53.737522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:54.611839 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3ae43627-a508-47c6-b07e-2588ce384937&page=queryresults
[0m11:38:55.627931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f61cdd0>]}
[0m11:38:55.629282 [info ] [Thread-1 (]: 2 of 18 OK created sql view model olist_raw_staging.stg_customers .............. [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m11:38:55.630072 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m11:38:55.630618 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m11:38:55.631474 [info ] [Thread-1 (]: 3 of 18 START sql view model olist_raw_staging.stg_geolocation ................. [RUN]
[0m11:38:55.632199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m11:38:55.632718 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m11:38:55.636940 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m11:38:55.638236 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m11:38:55.641515 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m11:38:55.642554 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m11:38:55.642990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:56.446770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:e6abd861-8a4d-4f56-a51f-d8ecd42cd568&page=queryresults
[0m11:38:57.377405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f6125d0>]}
[0m11:38:57.378089 [info ] [Thread-1 (]: 3 of 18 OK created sql view model olist_raw_staging.stg_geolocation ............ [[32mCREATE VIEW (0 processed)[0m in 1.75s]
[0m11:38:57.378527 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m11:38:57.378836 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m11:38:57.379284 [info ] [Thread-1 (]: 4 of 18 START sql view model olist_raw_staging.stg_order_items ................. [RUN]
[0m11:38:57.379611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m11:38:57.379882 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m11:38:57.382156 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m11:38:57.383663 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m11:38:57.385884 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m11:38:57.386631 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m11:38:57.386948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:58.300568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:be15c04d-7d7a-4043-b464-7b7b3018b760&page=queryresults
[0m11:38:59.531177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dea3050>]}
[0m11:38:59.532589 [info ] [Thread-1 (]: 4 of 18 OK created sql view model olist_raw_staging.stg_order_items ............ [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m11:38:59.533299 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m11:38:59.533768 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m11:38:59.534438 [info ] [Thread-1 (]: 5 of 18 START sql view model olist_raw_staging.stg_order_payments .............. [RUN]
[0m11:38:59.535027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m11:38:59.535466 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m11:38:59.539186 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m11:38:59.540311 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m11:38:59.545151 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m11:38:59.546500 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m11:38:59.546955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:00.756644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:d2fec684-1783-4665-be02-d8ec00ae8b7a&page=queryresults
[0m11:39:01.993343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f763ed0>]}
[0m11:39:01.994579 [info ] [Thread-1 (]: 5 of 18 OK created sql view model olist_raw_staging.stg_order_payments ......... [[32mCREATE VIEW (0 processed)[0m in 2.46s]
[0m11:39:01.995248 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m11:39:01.995707 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m11:39:01.996358 [info ] [Thread-1 (]: 6 of 18 START sql view model olist_raw_staging.stg_order_reviews ............... [RUN]
[0m11:39:01.996830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m11:39:01.997204 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m11:39:02.001427 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m11:39:02.002724 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m11:39:02.005095 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m11:39:02.005715 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m11:39:02.006008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:02.911454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:fd0dfb32-2033-43d8-ba43-0a03e309374a&page=queryresults
[0m11:39:04.139555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f763e90>]}
[0m11:39:04.140656 [info ] [Thread-1 (]: 6 of 18 OK created sql view model olist_raw_staging.stg_order_reviews .......... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m11:39:04.141247 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m11:39:04.141667 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m11:39:04.142291 [info ] [Thread-1 (]: 7 of 18 START sql view model olist_raw_staging.stg_orders ...................... [RUN]
[0m11:39:04.142728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m11:39:04.143075 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m11:39:04.146536 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m11:39:04.148886 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m11:39:04.151807 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m11:39:04.153590 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m11:39:04.154062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:05.055908 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:58cf06a0-aa10-4401-99ef-821d5d474143&page=queryresults
[0m11:39:06.288496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16df56110>]}
[0m11:39:06.289628 [info ] [Thread-1 (]: 7 of 18 OK created sql view model olist_raw_staging.stg_orders ................. [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m11:39:06.290474 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m11:39:06.290980 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m11:39:06.291506 [info ] [Thread-1 (]: 8 of 18 START sql view model olist_raw_staging.stg_product_category_name_translation  [RUN]
[0m11:39:06.292278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m11:39:06.292800 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m11:39:06.296296 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m11:39:06.297335 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m11:39:06.299553 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m11:39:06.300359 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m11:39:06.300734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:07.206806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:52930c6d-dc5a-4b7f-b35e-867a0a1a26f2&page=queryresults
[0m11:39:08.443655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16de80950>]}
[0m11:39:08.444998 [info ] [Thread-1 (]: 8 of 18 OK created sql view model olist_raw_staging.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m11:39:08.445783 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m11:39:08.446323 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m11:39:08.447095 [info ] [Thread-1 (]: 9 of 18 START sql view model olist_raw_staging.stg_products .................... [RUN]
[0m11:39:08.447785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m11:39:08.448303 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m11:39:08.452360 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m11:39:08.455105 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m11:39:08.458702 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m11:39:08.460092 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m11:39:08.460682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:09.358851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:1ebfe2df-64b4-4f28-b919-5cbc2cf4d02a&page=queryresults
[0m11:39:10.594156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f6d4790>]}
[0m11:39:10.595444 [info ] [Thread-1 (]: 9 of 18 OK created sql view model olist_raw_staging.stg_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m11:39:10.596208 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m11:39:10.596766 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m11:39:10.597540 [info ] [Thread-1 (]: 10 of 18 START sql view model olist_raw_staging.stg_sellers .................... [RUN]
[0m11:39:10.598106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m11:39:10.598571 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m11:39:10.605162 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m11:39:10.606313 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m11:39:10.609712 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m11:39:10.610997 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m11:39:10.611505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:11.341452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:16d4142f-50df-423a-b18a-d9e01f54efce&page=queryresults
[0m11:39:12.130969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11028d8d0>]}
[0m11:39:12.132237 [info ] [Thread-1 (]: 10 of 18 OK created sql view model olist_raw_staging.stg_sellers ............... [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m11:39:12.133017 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m11:39:12.133548 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_customers
[0m11:39:12.134377 [info ] [Thread-1 (]: 11 of 18 START sql table model olist_raw_analytics.dim_customers ............... [RUN]
[0m11:39:12.135049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_sellers, now model.olist_analytics.dim_customers)
[0m11:39:12.135563 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_customers
[0m11:39:12.139936 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m11:39:12.141259 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_customers
[0m11:39:12.143717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:12.737661 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m11:39:12.739302 [debug] [Thread-1 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
)

select
    customer_id,        -- Included as requested (Primary Key)
    customer_unique_id, -- The actual person's ID (Foreign Key to user history)
    zip_code,
    city,
    state
from customers
    );
  
[0m11:39:13.659991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:bddc12d3-ee1d-4f38-b60c-7365e4d4bb8d&page=queryresults
[0m11:39:17.343813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b175110>]}
[0m11:39:17.344334 [info ] [Thread-1 (]: 11 of 18 OK created sql table model olist_raw_analytics.dim_customers .......... [[32mCREATE TABLE (99.4k rows, 8.6 MiB processed)[0m in 5.21s]
[0m11:39:17.344672 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_customers
[0m11:39:17.344912 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_geolocation
[0m11:39:17.345213 [info ] [Thread-1 (]: 12 of 18 START sql table model olist_raw_analytics.dim_geolocation ............. [RUN]
[0m11:39:17.345487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_customers, now model.olist_analytics.dim_geolocation)
[0m11:39:17.345715 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_geolocation
[0m11:39:17.347489 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_geolocation"
[0m11:39:17.348197 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_geolocation
[0m11:39:17.349483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:17.962262 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_geolocation"
[0m11:39:17.964223 [debug] [Thread-1 (]: On model.olist_analytics.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_geolocation"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      with geolocation as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
)

select
    zip_code,
    -- Calculate the center point of the zip code
    avg(latitude) as latitude,
    avg(longitude) as longitude,
    max(city) as city,
    max(state) as state
from geolocation
group by zip_code
    );
  
[0m11:39:19.187746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:63e3176d-a169-4e53-a9d5-03e02533445f&page=queryresults
[0m11:39:25.951202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f671710>]}
[0m11:39:25.952253 [info ] [Thread-1 (]: 12 of 18 OK created sql table model olist_raw_analytics.dim_geolocation ........ [[32mCREATE TABLE (19.0k rows, 58.4 MiB processed)[0m in 8.61s]
[0m11:39:25.952909 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_geolocation
[0m11:39:25.953344 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_payments
[0m11:39:25.953960 [info ] [Thread-1 (]: 13 of 18 START sql table model olist_raw_analytics.dim_payments ................ [RUN]
[0m11:39:25.954478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_geolocation, now model.olist_analytics.dim_payments)
[0m11:39:25.954855 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_payments
[0m11:39:25.958121 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_payments"
[0m11:39:25.960479 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_payments
[0m11:39:25.962831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:26.489357 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_payments"
[0m11:39:26.492257 [debug] [Thread-1 (]: On model.olist_analytics.dim_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_payments"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_payments`
      
    
    

    OPTIONS()
    as (
      with payments as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
)

select
    -- Generate a unique key for each payment row
    concat(order_id, '-', cast(payment_sequential as string)) as payment_sk,
    
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from payments
    );
  
[0m11:39:27.243930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:a38ac8c1-c809-4b07-aa34-25f45830abb1&page=queryresults
[0m11:39:30.930035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e0cf390>]}
[0m11:39:30.931201 [info ] [Thread-1 (]: 13 of 18 OK created sql table model olist_raw_analytics.dim_payments ........... [[32mCREATE TABLE (103.9k rows, 5.5 MiB processed)[0m in 4.98s]
[0m11:39:30.931982 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_payments
[0m11:39:30.932514 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_reviews
[0m11:39:30.933229 [info ] [Thread-1 (]: 14 of 18 START sql table model olist_raw_analytics.dim_reviews ................. [RUN]
[0m11:39:30.933817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_payments, now model.olist_analytics.dim_reviews)
[0m11:39:30.934175 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_reviews
[0m11:39:30.937421 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_reviews"
[0m11:39:30.939813 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_reviews
[0m11:39:30.942634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:31.475811 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_reviews"
[0m11:39:31.477795 [debug] [Thread-1 (]: On model.olist_analytics.dim_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_reviews"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_reviews`
      
    
    

    OPTIONS()
    as (
      with reviews as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
)

select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    created_at as review_created_at,
    answer_timestamp as review_answered_at
from reviews
    );
  
[0m11:39:32.399232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:8ff68d8e-2251-4104-b6d9-ae07630ad7f2&page=queryresults
[0m11:39:37.010394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f7d4990>]}
[0m11:39:37.011530 [info ] [Thread-1 (]: 14 of 18 OK created sql table model olist_raw_analytics.dim_reviews ............ [[32mCREATE TABLE (99.2k rows, 13.8 MiB processed)[0m in 6.08s]
[0m11:39:37.012209 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_reviews
[0m11:39:37.012686 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_order_items
[0m11:39:37.013304 [info ] [Thread-1 (]: 15 of 18 START sql table model olist_raw_analytics.fct_order_items ............. [RUN]
[0m11:39:37.013872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_reviews, now model.olist_analytics.fct_order_items)
[0m11:39:37.014288 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_order_items
[0m11:39:37.018053 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_order_items"
[0m11:39:37.020451 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_order_items
[0m11:39:37.022849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:37.623791 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_order_items"
[0m11:39:37.628504 [debug] [Thread-1 (]: On model.olist_analytics.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_order_items"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_order_items`
      
    
    

    OPTIONS()
    as (
      with items as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
),

orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    -- Surrogate Key (Good practice to have a unique string for every row)
    concat(items.order_id, '-', cast(items.order_item_id as string)) as order_item_sk,
    
    items.order_id,
    items.order_item_id,
    items.product_id,
    items.seller_id,
    
    -- We bring in Customer ID from the orders table so we can slice sales by customer location later
    orders.customer_id,
    
    items.price,
    items.freight_value,
    
    -- Calculated Total
    (items.price + items.freight_value) as total_order_value

from items
left join orders 
    on items.order_id = orders.order_id
    );
  
[0m11:39:38.545207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:02074944-567f-4f45-9845-980cb4edc0b0&page=queryresults
[0m11:39:44.691668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f6da190>]}
[0m11:39:44.692901 [info ] [Thread-1 (]: 15 of 18 OK created sql table model olist_raw_analytics.fct_order_items ........ [[32mCREATE TABLE (112.7k rows, 31.6 MiB processed)[0m in 7.68s]
[0m11:39:44.693688 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_order_items
[0m11:39:44.694224 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m11:39:44.694797 [info ] [Thread-1 (]: 16 of 18 START sql table model olist_raw_analytics.fct_orders .................. [RUN]
[0m11:39:44.695488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_order_items, now model.olist_analytics.fct_orders)
[0m11:39:44.696074 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m11:39:44.699956 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m11:39:44.701302 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m11:39:44.703904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:45.164327 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m11:39:45.168918 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_orders`
      
    
    

    OPTIONS()
    as (
      with orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    order_id,
    customer_id,
    order_status,
    
    -- Timestamps
    purchase_at,
    approved_at,
    delivered_carrier_at,
    delivered_customer_at,
    estimated_delivery_at,

    -- Calculated Metrics (BigQuery Syntax)
    -- 1. How long did it take to deliver?
    timestamp_diff(delivered_customer_at, purchase_at, hour) as time_to_delivery_hours,
    
    -- 2. Was it late? (Difference between estimated and actual)
    -- Positive numbers mean it arrived early, Negative means it was late
    timestamp_diff(estimated_delivery_at, delivered_customer_at, day) as days_early_or_late

from orders
    );
  
[0m11:39:45.955782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:a6fbacab-ae8d-4757-8a02-709a27a631ed&page=queryresults
[0m11:39:51.450329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f6da1d0>]}
[0m11:39:51.451726 [info ] [Thread-1 (]: 16 of 18 OK created sql table model olist_raw_analytics.fct_orders ............. [[32mCREATE TABLE (99.4k rows, 16.8 MiB processed)[0m in 6.75s]
[0m11:39:51.452518 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m11:39:51.453069 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m11:39:51.453805 [info ] [Thread-1 (]: 17 of 18 START sql table model olist_raw_analytics.dim_products ................ [RUN]
[0m11:39:51.454473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_orders, now model.olist_analytics.dim_products)
[0m11:39:51.454986 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m11:39:51.459546 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m11:39:51.460763 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m11:39:51.463675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:52.061523 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m11:39:52.063656 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with products as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
),

translations as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
)

select
    p.product_id,
    -- If english name is null, fall back to original name, then to 'Unknown'
    coalesce(t.product_category_name_english, p.product_category_name, 'Unknown') as category_name,
    p.photos_quantity,
    p.weight_g,
    p.length_cm,
    p.height_cm,
    p.width_cm
from products p
left join translations t 
    on p.product_category_name = t.product_category_name
    );
  
[0m11:39:52.981456 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:1b1f64f0-f904-42cb-98e6-001caa8342d8&page=queryresults
[0m11:39:56.414449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17b166050>]}
[0m11:39:56.415599 [info ] [Thread-1 (]: 17 of 18 OK created sql table model olist_raw_analytics.dim_products ........... [[32mCREATE TABLE (33.0k rows, 2.3 MiB processed)[0m in 4.96s]
[0m11:39:56.416522 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m11:39:56.417141 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_sellers
[0m11:39:56.417890 [info ] [Thread-1 (]: 18 of 18 START sql table model olist_raw_analytics.dim_sellers ................. [RUN]
[0m11:39:56.418612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_products, now model.olist_analytics.dim_sellers)
[0m11:39:56.419171 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_sellers
[0m11:39:56.423105 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_sellers"
[0m11:39:56.424122 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_sellers
[0m11:39:56.426622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:56.977153 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_sellers"
[0m11:39:56.979278 [debug] [Thread-1 (]: On model.olist_analytics.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_sellers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_sellers`
      
    
    

    OPTIONS()
    as (
      with sellers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
)

select
    seller_id,
    zip_code,
    city,
    state
from sellers
    );
  
[0m11:39:57.896017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:99bda322-1a33-407a-a8d4-3b61d62d11fb&page=queryresults
[0m11:40:00.428132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58042f04-56fc-468c-b6d1-eba9d94b7c25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f7d48d0>]}
[0m11:40:00.429550 [info ] [Thread-1 (]: 18 of 18 OK created sql table model olist_raw_analytics.dim_sellers ............ [[32mCREATE TABLE (3.1k rows, 170.5 KiB processed)[0m in 4.01s]
[0m11:40:00.430344 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_sellers
[0m11:40:00.432166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:40:00.433081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:00.433517 [debug] [MainThread]: Connection 'model.olist_analytics.dim_sellers' was properly closed.
[0m11:40:00.434139 [info ] [MainThread]: 
[0m11:40:00.434593 [info ] [MainThread]: Finished running 9 table models, 9 view models in 0 hours 1 minutes and 13.62 seconds (73.62s).
[0m11:40:00.437654 [debug] [MainThread]: Command end result
[0m11:40:00.463982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/manifest.json
[0m11:40:00.465907 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/semantic_manifest.json
[0m11:40:00.470662 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/M2_PROJECT/dbt/olist_analytics/target/run_results.json
[0m11:40:00.470919 [info ] [MainThread]: 
[0m11:40:00.471205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:40:00.471439 [info ] [MainThread]: 
[0m11:40:00.471704 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m11:40:00.472109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 107.865166, "process_in_blocks": "0", "process_kernel_time": 2.973386, "process_mem_max_rss": "474267648", "process_out_blocks": "0", "process_user_time": 5.788009}
[0m11:40:00.472442 [debug] [MainThread]: Command `dbt run` succeeded at 11:40:00.472386 after 107.87 seconds
[0m11:40:00.472768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113276390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028f7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11347aed0>]}
[0m11:40:00.473054 [debug] [MainThread]: Flushing usage events
[0m11:40:02.810638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:24.237854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107751890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077de110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077de550>]}


============================== 14:26:24.240706 | 1ba994f2-c2d0-4134-b65a-4ffc11048ac5 ==============================
[0m14:26:24.240706 [info ] [MainThread]: Running with dbt=1.9.6
[0m14:26:24.241065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:28.675836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3087b9010>]}
[0m14:26:28.712261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d51f10>]}
[0m14:26:28.712647 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:26:28.882282 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m14:26:28.951722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:26:28.951969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:26:28.970006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x308ab6290>]}
[0m14:26:29.009115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/manifest.json
[0m14:26:29.010291 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/semantic_manifest.json
[0m14:26:29.024085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fa3fe90>]}
[0m14:26:29.024389 [info ] [MainThread]: Found 18 models, 9 sources, 494 macros
[0m14:26:29.024592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077322d0>]}
[0m14:26:29.025987 [info ] [MainThread]: 
[0m14:26:29.026196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:29.026352 [info ] [MainThread]: 
[0m14:26:29.026620 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:26:29.029173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m14:26:29.029417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:29.577833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:30.013489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw_staging)
[0m14:26:30.014077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:30.476990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_staging, now list_stellar-verve-478012-n6_olist_raw_analytics)
[0m14:26:30.479543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:30.891248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x308938590>]}
[0m14:26:30.892346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:30.898415 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_date
[0m14:26:30.899125 [info ] [Thread-1 (]: 1 of 18 START sql table model olist_raw_analytics.dim_date ..................... [RUN]
[0m14:26:30.899676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_analytics, now model.olist_analytics.dim_date)
[0m14:26:30.900080 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_date
[0m14:26:30.911659 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_date"
[0m14:26:30.912982 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_date
[0m14:26:30.925950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:31.429970 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_date"
[0m14:26:31.430849 [debug] [Thread-1 (]: On model.olist_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_date"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_date`
      
    
    

    OPTIONS()
    as (
      -- Standard BigQuery SQL to generate dates
with date_spine as (
  select 
    * from 
    unnest(generate_date_array('2016-01-01', '2020-01-01', interval 1 day)) as date_day
)

select
  date_day,
  extract(year from date_day) as year,
  extract(month from date_day) as month,
  extract(day from date_day) as day,
  extract(dayofweek from date_day) as day_of_week,
  format_date('%B', date_day) as month_name,
  format_date('%A', date_day) as day_name,
  case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend
from date_spine
    );
  
[0m14:26:32.417881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:d6b696c8-217b-4ee6-a586-1d6cc8dea58d&page=queryresults
[0m14:26:34.792974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30ddfddd0>]}
[0m14:26:34.793750 [info ] [Thread-1 (]: 1 of 18 OK created sql table model olist_raw_analytics.dim_date ................ [[32mCREATE TABLE (1.5k rows, 0 processed)[0m in 3.89s]
[0m14:26:34.794374 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_date
[0m14:26:34.794773 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m14:26:34.795197 [info ] [Thread-1 (]: 2 of 18 START sql view model olist_raw_staging.stg_customers ................... [RUN]
[0m14:26:34.795625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_date, now model.olist_analytics.stg_customers)
[0m14:26:34.795957 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m14:26:34.799242 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m14:26:34.800079 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m14:26:34.815717 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m14:26:34.816511 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m14:26:34.816921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:35.628081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:05fd371b-7b4b-4e1f-82d7-2835309a6dc1&page=queryresults
[0m14:26:36.280851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x308f929d0>]}
[0m14:26:36.281548 [info ] [Thread-1 (]: 2 of 18 OK created sql view model olist_raw_staging.stg_customers .............. [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m14:26:36.281921 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m14:26:36.282151 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m14:26:36.282594 [info ] [Thread-1 (]: 3 of 18 START sql view model olist_raw_staging.stg_geolocation ................. [RUN]
[0m14:26:36.283068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m14:26:36.283323 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m14:26:36.285283 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m14:26:36.285875 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m14:26:36.287596 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m14:26:36.288190 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m14:26:36.288554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:36.946669 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:2a902f62-7c36-4645-9a68-481533f84186&page=queryresults
[0m14:26:37.847975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30dd89150>]}
[0m14:26:37.848724 [info ] [Thread-1 (]: 3 of 18 OK created sql view model olist_raw_staging.stg_geolocation ............ [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m14:26:37.849206 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m14:26:37.849517 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m14:26:37.849844 [info ] [Thread-1 (]: 4 of 18 START sql view model olist_raw_staging.stg_order_items ................. [RUN]
[0m14:26:37.850269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m14:26:37.850684 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m14:26:37.853380 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m14:26:37.854112 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m14:26:37.857570 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m14:26:37.858572 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m14:26:37.859041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:38.646930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:07ef72bc-edb4-4a9a-833e-095b8b1474f4&page=queryresults
[0m14:26:39.367378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f989410>]}
[0m14:26:39.368089 [info ] [Thread-1 (]: 4 of 18 OK created sql view model olist_raw_staging.stg_order_items ............ [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m14:26:39.368438 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m14:26:39.368655 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m14:26:39.368958 [info ] [Thread-1 (]: 5 of 18 START sql view model olist_raw_staging.stg_order_payments .............. [RUN]
[0m14:26:39.369826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m14:26:39.370268 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m14:26:39.372180 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m14:26:39.372667 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m14:26:39.375652 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m14:26:39.376344 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m14:26:39.376594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:39.954357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:e2dd7788-3d38-4d8d-b8a0-2aedb4c62bc0&page=queryresults
[0m14:26:40.613527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30de85450>]}
[0m14:26:40.613966 [info ] [Thread-1 (]: 5 of 18 OK created sql view model olist_raw_staging.stg_order_payments ......... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m14:26:40.614258 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m14:26:40.614457 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m14:26:40.614669 [info ] [Thread-1 (]: 6 of 18 START sql view model olist_raw_staging.stg_order_reviews ............... [RUN]
[0m14:26:40.614878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m14:26:40.615058 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m14:26:40.616978 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m14:26:40.617454 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m14:26:40.618918 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m14:26:40.619271 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m14:26:40.619480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:41.227987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:bfbb1603-ae18-4f53-ac98-328d5250ef3a&page=queryresults
[0m14:26:41.840333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30de84210>]}
[0m14:26:41.841212 [info ] [Thread-1 (]: 6 of 18 OK created sql view model olist_raw_staging.stg_order_reviews .......... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m14:26:41.841694 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m14:26:41.842034 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m14:26:41.842302 [info ] [Thread-1 (]: 7 of 18 START sql view model olist_raw_staging.stg_orders ...................... [RUN]
[0m14:26:41.842565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m14:26:41.842758 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m14:26:41.844503 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m14:26:41.844953 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m14:26:41.846480 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m14:26:41.846846 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m14:26:41.847070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:42.417007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:5ab4d7b5-8544-4405-9a52-9e286ff43770&page=queryresults
[0m14:26:43.037863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30dd9c750>]}
[0m14:26:43.038595 [info ] [Thread-1 (]: 7 of 18 OK created sql view model olist_raw_staging.stg_orders ................. [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m14:26:43.039438 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m14:26:43.039822 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m14:26:43.040357 [info ] [Thread-1 (]: 8 of 18 START sql view model olist_raw_staging.stg_product_category_name_translation  [RUN]
[0m14:26:43.040912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m14:26:43.041320 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m14:26:43.044078 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m14:26:43.044716 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m14:26:43.046840 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m14:26:43.047378 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m14:26:43.047700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:43.806418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:59e0e8fc-e8c6-4e96-901a-8e08212f3129&page=queryresults
[0m14:26:44.839672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fa8c110>]}
[0m14:26:44.840989 [info ] [Thread-1 (]: 8 of 18 OK created sql view model olist_raw_staging.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m14:26:44.841755 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m14:26:44.842310 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m14:26:44.842874 [info ] [Thread-1 (]: 9 of 18 START sql view model olist_raw_staging.stg_products .................... [RUN]
[0m14:26:44.843594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m14:26:44.844086 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m14:26:44.847935 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m14:26:44.848990 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m14:26:44.852046 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m14:26:44.852948 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m14:26:44.853403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:45.731002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:1cc890a5-2b7b-4fc1-86ac-9fb250cdbcd8&page=queryresults
[0m14:26:46.456102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x308f6bb10>]}
[0m14:26:46.457387 [info ] [Thread-1 (]: 9 of 18 OK created sql view model olist_raw_staging.stg_products ............... [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m14:26:46.458180 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m14:26:46.458709 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m14:26:46.459260 [info ] [Thread-1 (]: 10 of 18 START sql view model olist_raw_staging.stg_sellers .................... [RUN]
[0m14:26:46.459929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m14:26:46.460429 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m14:26:46.467107 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m14:26:46.468348 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m14:26:46.471143 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m14:26:46.472092 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m14:26:46.472652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:47.248764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:d73b1df8-a10f-4b25-bbb0-60f0bbbdfc3f&page=queryresults
[0m14:26:48.147925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30ddeaf50>]}
[0m14:26:48.149080 [info ] [Thread-1 (]: 10 of 18 OK created sql view model olist_raw_staging.stg_sellers ............... [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m14:26:48.149813 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m14:26:48.150316 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_customers
[0m14:26:48.151079 [info ] [Thread-1 (]: 11 of 18 START sql table model olist_raw_analytics.dim_customers ............... [RUN]
[0m14:26:48.151609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_sellers, now model.olist_analytics.dim_customers)
[0m14:26:48.152039 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_customers
[0m14:26:48.155814 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m14:26:48.156988 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_customers
[0m14:26:48.159929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:48.610946 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m14:26:48.612858 [debug] [Thread-1 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
)

select
    customer_id,        -- Included as requested (Primary Key)
    customer_unique_id, -- The actual person's ID (Foreign Key to user history)
    zip_code,
    city,
    state
from customers
    );
  
[0m14:26:49.827506 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:6ba15561-6551-4898-923c-5d4d149beb91&page=queryresults
[0m14:26:53.007405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30dd5d7d0>]}
[0m14:26:53.008510 [info ] [Thread-1 (]: 11 of 18 OK created sql table model olist_raw_analytics.dim_customers .......... [[32mCREATE TABLE (99.4k rows, 8.6 MiB processed)[0m in 4.86s]
[0m14:26:53.009431 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_customers
[0m14:26:53.010310 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_geolocation
[0m14:26:53.011096 [info ] [Thread-1 (]: 12 of 18 START sql table model olist_raw_analytics.dim_geolocation ............. [RUN]
[0m14:26:53.011724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_customers, now model.olist_analytics.dim_geolocation)
[0m14:26:53.012087 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_geolocation
[0m14:26:53.015412 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_geolocation"
[0m14:26:53.016320 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_geolocation
[0m14:26:53.018828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:53.415310 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_geolocation"
[0m14:26:53.417383 [debug] [Thread-1 (]: On model.olist_analytics.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_geolocation"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      with geolocation as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
)

select
    zip_code,
    -- Calculate the center point of the zip code
    avg(latitude) as latitude,
    avg(longitude) as longitude,
    max(city) as city,
    max(state) as state
from geolocation
group by zip_code
    );
  
[0m14:26:54.317951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:2b58f984-8d19-42c6-8c5b-7723bd346f79&page=queryresults
[0m14:27:01.724059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30dd85c90>]}
[0m14:27:01.725517 [info ] [Thread-1 (]: 12 of 18 OK created sql table model olist_raw_analytics.dim_geolocation ........ [[32mCREATE TABLE (19.0k rows, 58.4 MiB processed)[0m in 8.71s]
[0m14:27:01.726411 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_geolocation
[0m14:27:01.726954 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_payments
[0m14:27:01.727504 [info ] [Thread-1 (]: 13 of 18 START sql table model olist_raw_analytics.dim_payments ................ [RUN]
[0m14:27:01.728159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_geolocation, now model.olist_analytics.dim_payments)
[0m14:27:01.728718 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_payments
[0m14:27:01.733136 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_payments"
[0m14:27:01.734541 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_payments
[0m14:27:01.737676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:02.423750 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_payments"
[0m14:27:02.424991 [debug] [Thread-1 (]: On model.olist_analytics.dim_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_payments"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_payments`
      
    
    

    OPTIONS()
    as (
      with payments as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
)

select
    -- Generate a unique key for each payment row
    concat(order_id, '-', cast(payment_sequential as string)) as payment_sk,
    
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from payments
    );
  
[0m14:27:03.446625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:e8068722-f18f-4f14-be80-cc103597b018&page=queryresults
[0m14:27:06.574746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30de6c2d0>]}
[0m14:27:06.575315 [info ] [Thread-1 (]: 13 of 18 OK created sql table model olist_raw_analytics.dim_payments ........... [[32mCREATE TABLE (103.9k rows, 5.5 MiB processed)[0m in 4.85s]
[0m14:27:06.575634 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_payments
[0m14:27:06.575852 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_reviews
[0m14:27:06.576071 [info ] [Thread-1 (]: 14 of 18 START sql table model olist_raw_analytics.dim_reviews ................. [RUN]
[0m14:27:06.576443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_payments, now model.olist_analytics.dim_reviews)
[0m14:27:06.576818 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_reviews
[0m14:27:06.578726 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_reviews"
[0m14:27:06.579179 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_reviews
[0m14:27:06.580376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:06.990509 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_reviews"
[0m14:27:06.991963 [debug] [Thread-1 (]: On model.olist_analytics.dim_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_reviews"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_reviews`
      
    
    

    OPTIONS()
    as (
      with reviews as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
)

select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    created_at as review_created_at,
    answer_timestamp as review_answered_at
from reviews
    );
  
[0m14:27:07.661843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:c0f47270-5040-4d8c-b258-236d6a8430d8&page=queryresults
[0m14:27:11.730738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30dec4950>]}
[0m14:27:11.732446 [info ] [Thread-1 (]: 14 of 18 OK created sql table model olist_raw_analytics.dim_reviews ............ [[32mCREATE TABLE (99.2k rows, 13.8 MiB processed)[0m in 5.15s]
[0m14:27:11.733481 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_reviews
[0m14:27:11.734050 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_order_items
[0m14:27:11.734702 [info ] [Thread-1 (]: 15 of 18 START sql table model olist_raw_analytics.fct_order_items ............. [RUN]
[0m14:27:11.735276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_reviews, now model.olist_analytics.fct_order_items)
[0m14:27:11.735729 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_order_items
[0m14:27:11.740612 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_order_items"
[0m14:27:11.741798 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_order_items
[0m14:27:11.744690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:12.358679 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_order_items"
[0m14:27:12.359981 [debug] [Thread-1 (]: On model.olist_analytics.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_order_items"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_order_items`
      
    
    

    OPTIONS()
    as (
      with items as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
),

orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    -- Surrogate Key (Good practice to have a unique string for every row)
    concat(items.order_id, '-', cast(items.order_item_id as string)) as order_item_sk,
    
    items.order_id,
    items.order_item_id,
    items.product_id,
    items.seller_id,
    
    -- We bring in Customer ID from the orders table so we can slice sales by customer location later
    orders.customer_id,
    
    items.price,
    items.freight_value,
    
    -- Calculated Total
    (items.price + items.freight_value) as total_order_value

from items
left join orders 
    on items.order_id = orders.order_id
    );
  
[0m14:27:13.246514 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:0e012a65-8e03-49cd-829f-16be308dc421&page=queryresults
[0m14:27:19.369886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x308b77d50>]}
[0m14:27:19.370798 [info ] [Thread-1 (]: 15 of 18 OK created sql table model olist_raw_analytics.fct_order_items ........ [[32mCREATE TABLE (112.7k rows, 31.6 MiB processed)[0m in 7.63s]
[0m14:27:19.371715 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_order_items
[0m14:27:19.372329 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m14:27:19.373096 [info ] [Thread-1 (]: 16 of 18 START sql table model olist_raw_analytics.fct_orders .................. [RUN]
[0m14:27:19.373746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_order_items, now model.olist_analytics.fct_orders)
[0m14:27:19.374229 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m14:27:19.378171 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m14:27:19.379315 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m14:27:19.382048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:19.834501 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m14:27:19.836181 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_orders`
      
    
    

    OPTIONS()
    as (
      with orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    order_id,
    customer_id,
    order_status,
    
    -- Timestamps
    purchase_at,
    approved_at,
    delivered_carrier_at,
    delivered_customer_at,
    estimated_delivery_at,

    -- Calculated Metrics (BigQuery Syntax)
    -- 1. How long did it take to deliver?
    timestamp_diff(delivered_customer_at, purchase_at, hour) as time_to_delivery_hours,
    
    -- 2. Was it late? (Difference between estimated and actual)
    -- Positive numbers mean it arrived early, Negative means it was late
    timestamp_diff(estimated_delivery_at, delivered_customer_at, day) as days_early_or_late

from orders
    );
  
[0m14:27:20.546622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:9903b865-3f9d-4789-808b-73d38eb27be2&page=queryresults
[0m14:27:24.419166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30de79690>]}
[0m14:27:24.420584 [info ] [Thread-1 (]: 16 of 18 OK created sql table model olist_raw_analytics.fct_orders ............. [[32mCREATE TABLE (99.4k rows, 16.8 MiB processed)[0m in 5.05s]
[0m14:27:24.421376 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m14:27:24.421919 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m14:27:24.422593 [info ] [Thread-1 (]: 17 of 18 START sql table model olist_raw_analytics.dim_products ................ [RUN]
[0m14:27:24.423249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_orders, now model.olist_analytics.dim_products)
[0m14:27:24.423738 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m14:27:24.428218 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m14:27:24.429544 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m14:27:24.432260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:24.788023 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m14:27:24.789841 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with products as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
),

translations as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
)

select
    p.product_id,
    -- If english name is null, fall back to original name, then to 'Unknown'
    coalesce(t.product_category_name_english, p.product_category_name, 'Unknown') as category_name,
    p.photos_quantity,
    p.weight_g,
    p.length_cm,
    p.height_cm,
    p.width_cm
from products p
left join translations t 
    on p.product_category_name = t.product_category_name
    );
  
[0m14:27:25.687275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:4be2070f-50ff-414d-84da-a0a66ab5262a&page=queryresults
[0m14:27:29.667108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30de8b450>]}
[0m14:27:29.668305 [info ] [Thread-1 (]: 17 of 18 OK created sql table model olist_raw_analytics.dim_products ........... [[32mCREATE TABLE (33.0k rows, 2.3 MiB processed)[0m in 5.24s]
[0m14:27:29.668978 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m14:27:29.669454 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_sellers
[0m14:27:29.670066 [info ] [Thread-1 (]: 18 of 18 START sql table model olist_raw_analytics.dim_sellers ................. [RUN]
[0m14:27:29.670558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_products, now model.olist_analytics.dim_sellers)
[0m14:27:29.670921 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_sellers
[0m14:27:29.674208 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_sellers"
[0m14:27:29.675185 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_sellers
[0m14:27:29.677544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:30.040388 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_sellers"
[0m14:27:30.044254 [debug] [Thread-1 (]: On model.olist_analytics.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_sellers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_sellers`
      
    
    

    OPTIONS()
    as (
      with sellers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
)

select
    seller_id,
    zip_code,
    city,
    state
from sellers
    );
  
[0m14:27:30.906232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:0da84591-b9b4-4a99-917e-187e012c4adc&page=queryresults
[0m14:27:33.086194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba994f2-c2d0-4134-b65a-4ffc11048ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f9bc650>]}
[0m14:27:33.087749 [info ] [Thread-1 (]: 18 of 18 OK created sql table model olist_raw_analytics.dim_sellers ............ [[32mCREATE TABLE (3.1k rows, 170.5 KiB processed)[0m in 3.42s]
[0m14:27:33.088678 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_sellers
[0m14:27:33.090703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:33.091512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:33.091899 [debug] [MainThread]: Connection 'model.olist_analytics.dim_sellers' was properly closed.
[0m14:27:33.092511 [info ] [MainThread]: 
[0m14:27:33.092961 [info ] [MainThread]: Finished running 9 table models, 9 view models in 0 hours 1 minutes and 4.07 seconds (64.07s).
[0m14:27:33.096465 [debug] [MainThread]: Command end result
[0m14:27:33.125164 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/manifest.json
[0m14:27:33.126993 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/semantic_manifest.json
[0m14:27:33.131681 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/run_results.json
[0m14:27:33.131887 [info ] [MainThread]: 
[0m14:27:33.132114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:33.132292 [info ] [MainThread]: 
[0m14:27:33.132480 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m14:27:33.132838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 68.93613, "process_in_blocks": "0", "process_kernel_time": 2.437818, "process_mem_max_rss": "474726400", "process_out_blocks": "0", "process_user_time": 5.897866}
[0m14:27:33.133137 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:33.133074 after 68.94 seconds
[0m14:27:33.133393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f1f590>]}
[0m14:27:33.133598 [debug] [MainThread]: Flushing usage events
[0m14:27:34.470489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:53.068582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8551d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8c0ed0>]}


============================== 11:48:53.071726 | e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6 ==============================
[0m11:48:53.071726 [info ] [MainThread]: Running with dbt=1.9.6
[0m11:48:53.072114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/govindandhanasekaran/.dbt', 'log_path': '/Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:48:56.621974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3151ef350>]}
[0m11:48:56.657970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977b410>]}
[0m11:48:56.658357 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:48:56.830907 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m11:48:56.904056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:56.904332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:56.922507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e1f3350>]}
[0m11:48:56.960978 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/manifest.json
[0m11:48:56.962177 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/semantic_manifest.json
[0m11:48:56.975671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x31537a190>]}
[0m11:48:56.975980 [info ] [MainThread]: Found 18 models, 9 sources, 494 macros
[0m11:48:56.976180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8310d0>]}
[0m11:48:56.977597 [info ] [MainThread]: 
[0m11:48:56.977820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:56.977985 [info ] [MainThread]: 
[0m11:48:56.978259 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:48:56.980815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_stellar-verve-478012-n6'
[0m11:48:56.981043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:57.772827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:58.270065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6, now list_stellar-verve-478012-n6_olist_raw_staging)
[0m11:48:58.270681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:58.757217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_staging, now list_stellar-verve-478012-n6_olist_raw_analytics)
[0m11:48:58.759159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:59.178478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3152fc890>]}
[0m11:48:59.180208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:59.184754 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_date
[0m11:48:59.185502 [info ] [Thread-1 (]: 1 of 18 START sql table model olist_raw_analytics.dim_date ..................... [RUN]
[0m11:48:59.186055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_stellar-verve-478012-n6_olist_raw_analytics, now model.olist_analytics.dim_date)
[0m11:48:59.186470 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_date
[0m11:48:59.197017 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_date"
[0m11:48:59.197967 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_date
[0m11:48:59.210792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:59.691179 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_date"
[0m11:48:59.693459 [debug] [Thread-1 (]: On model.olist_analytics.dim_date: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_date"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_date`
      
    
    

    OPTIONS()
    as (
      -- Standard BigQuery SQL to generate dates
with date_spine as (
  select 
    * from 
    unnest(generate_date_array('2016-01-01', '2020-01-01', interval 1 day)) as date_day
)

select
  date_day,
  extract(year from date_day) as year,
  extract(month from date_day) as month,
  extract(day from date_day) as day,
  extract(dayofweek from date_day) as day_of_week,
  format_date('%B', date_day) as month_name,
  format_date('%A', date_day) as day_name,
  case when extract(dayofweek from date_day) in (1, 7) then true else false end as is_weekend
from date_spine
    );
  
[0m11:49:00.299385 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:6911a0ae-2ebc-4e4d-9324-6cedc8f65990&page=queryresults
[0m11:49:03.015911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bab9c10>]}
[0m11:49:03.016682 [info ] [Thread-1 (]: 1 of 18 OK created sql table model olist_raw_analytics.dim_date ................ [[32mCREATE TABLE (1.5k rows, 0 processed)[0m in 3.83s]
[0m11:49:03.017272 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_date
[0m11:49:03.017668 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_customers
[0m11:49:03.018207 [info ] [Thread-1 (]: 2 of 18 START sql view model olist_raw_staging.stg_customers ................... [RUN]
[0m11:49:03.018655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_date, now model.olist_analytics.stg_customers)
[0m11:49:03.018977 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_customers
[0m11:49:03.021606 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_customers"
[0m11:49:03.022650 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_customers
[0m11:49:03.038627 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_customers"
[0m11:49:03.039676 [debug] [Thread-1 (]: On model.olist_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_customers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`customers`
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed;


[0m11:49:03.040039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:04.221645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:9d3d2466-3ba1-4414-b6b5-846bad320f0d&page=queryresults
[0m11:49:04.979015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x31542f290>]}
[0m11:49:04.979973 [info ] [Thread-1 (]: 2 of 18 OK created sql view model olist_raw_staging.stg_customers .............. [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m11:49:04.980431 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_customers
[0m11:49:04.980767 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_geolocation
[0m11:49:04.981271 [info ] [Thread-1 (]: 3 of 18 START sql view model olist_raw_staging.stg_geolocation ................. [RUN]
[0m11:49:04.981605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_customers, now model.olist_analytics.stg_geolocation)
[0m11:49:04.981869 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_geolocation
[0m11:49:04.984869 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_geolocation"
[0m11:49:04.985460 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_geolocation
[0m11:49:04.987677 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_geolocation"
[0m11:49:04.988390 [debug] [Thread-1 (]: On model.olist_analytics.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_geolocation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`geolocation`
),

renamed as (
    select distinct
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed;


[0m11:49:04.988689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:05.756631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:3737b1c0-1b02-48ad-9b9b-1aeb5ad2c1cf&page=queryresults
[0m11:49:06.985308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319a76950>]}
[0m11:49:06.986072 [info ] [Thread-1 (]: 3 of 18 OK created sql view model olist_raw_staging.stg_geolocation ............ [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m11:49:06.986629 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_geolocation
[0m11:49:06.987010 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_items
[0m11:49:06.987540 [info ] [Thread-1 (]: 4 of 18 START sql view model olist_raw_staging.stg_order_items ................. [RUN]
[0m11:49:06.988078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_geolocation, now model.olist_analytics.stg_order_items)
[0m11:49:06.988442 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_items
[0m11:49:06.990988 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_items"
[0m11:49:06.992563 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_items
[0m11:49:06.995341 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_items"
[0m11:49:06.996406 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_items"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`order_items`
),

renamed as (
    select
        order_id,
        order_item_id,
        product_id,
        seller_id,
        cast(shipping_limit_date as timestamp) as shipping_limit_date,
        price,
        freight_value
    from source
)

select * from renamed;


[0m11:49:06.996892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:07.876855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:7bfaddd5-15ee-49b0-80a0-c173140e368d&page=queryresults
[0m11:49:08.612552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319a37010>]}
[0m11:49:08.613947 [info ] [Thread-1 (]: 4 of 18 OK created sql view model olist_raw_staging.stg_order_items ............ [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m11:49:08.614770 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_items
[0m11:49:08.615320 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_payments
[0m11:49:08.616024 [info ] [Thread-1 (]: 5 of 18 START sql view model olist_raw_staging.stg_order_payments .............. [RUN]
[0m11:49:08.616667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_items, now model.olist_analytics.stg_order_payments)
[0m11:49:08.617158 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_payments
[0m11:49:08.621522 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_payments"
[0m11:49:08.623999 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_payments
[0m11:49:08.629323 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_payments"
[0m11:49:08.630404 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_payments"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`payments`
),

renamed as (
    select
        order_id,
        payment_sequential,
        payment_type,
        payment_installments,
        payment_value
    from source
)

select * from renamed;


[0m11:49:08.630826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:09.443712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:433634a6-c83e-464f-ba0f-a051146b98e5&page=queryresults
[0m11:49:10.192428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319b86490>]}
[0m11:49:10.192989 [info ] [Thread-1 (]: 5 of 18 OK created sql view model olist_raw_staging.stg_order_payments ......... [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m11:49:10.193381 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_payments
[0m11:49:10.193652 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_order_reviews
[0m11:49:10.194007 [info ] [Thread-1 (]: 6 of 18 START sql view model olist_raw_staging.stg_order_reviews ............... [RUN]
[0m11:49:10.194362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_payments, now model.olist_analytics.stg_order_reviews)
[0m11:49:10.194677 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_order_reviews
[0m11:49:10.196776 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_order_reviews"
[0m11:49:10.197363 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_order_reviews
[0m11:49:10.199264 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_order_reviews"
[0m11:49:10.199890 [debug] [Thread-1 (]: On model.olist_analytics.stg_order_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_order_reviews"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`reviews`
),

renamed as (
    select
        review_id,
        order_id,
        review_score,
        review_comment_title,
        review_comment_message,
        cast(review_creation_date as timestamp) as created_at,
        cast(review_answer_timestamp as timestamp) as answer_timestamp
    from source
)

select * from renamed;


[0m11:49:10.200206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:10.977142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:11376393-e236-437b-9a24-72d0188a8111&page=queryresults
[0m11:49:11.898956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319b5ec90>]}
[0m11:49:11.899467 [info ] [Thread-1 (]: 6 of 18 OK created sql view model olist_raw_staging.stg_order_reviews .......... [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m11:49:11.899826 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_order_reviews
[0m11:49:11.900079 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_orders
[0m11:49:11.900428 [info ] [Thread-1 (]: 7 of 18 START sql view model olist_raw_staging.stg_orders ...................... [RUN]
[0m11:49:11.900768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_order_reviews, now model.olist_analytics.stg_orders)
[0m11:49:11.901001 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_orders
[0m11:49:11.902934 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_orders"
[0m11:49:11.903436 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_orders
[0m11:49:11.905117 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_orders"
[0m11:49:11.905523 [debug] [Thread-1 (]: On model.olist_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_orders"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`orders`
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        -- Timestamp Conversions
        cast(order_purchase_timestamp as timestamp) as purchase_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as delivered_carrier_at,
        cast(order_delivered_customer_date as timestamp) as delivered_customer_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at
    from source
)

select * from renamed;


[0m11:49:11.905767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:12.820657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:7ddf15d9-dbf2-44b6-aeaa-0540e55d53d4&page=queryresults
[0m11:49:13.551624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319a2c210>]}
[0m11:49:13.552699 [info ] [Thread-1 (]: 7 of 18 OK created sql view model olist_raw_staging.stg_orders ................. [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m11:49:13.553356 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_orders
[0m11:49:13.553857 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_product_category_name_translation
[0m11:49:13.554550 [info ] [Thread-1 (]: 8 of 18 START sql view model olist_raw_staging.stg_product_category_name_translation  [RUN]
[0m11:49:13.555190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_orders, now model.olist_analytics.stg_product_category_name_translation)
[0m11:49:13.555746 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_product_category_name_translation
[0m11:49:13.559858 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_product_category_name_translation"
[0m11:49:13.561174 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_product_category_name_translation
[0m11:49:13.564334 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_product_category_name_translation"
[0m11:49:13.565003 [debug] [Thread-1 (]: On model.olist_analytics.stg_product_category_name_translation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_product_category_name_translation"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`category_translation`
),

renamed as (
    select
        string_field_0 as product_category_name,
        string_field_1 as product_category_name_english
    from source
)

select * from renamed;


[0m11:49:13.565393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:14.283136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:e2bfe5eb-1548-435a-a021-9cf44ea127d4&page=queryresults
[0m11:49:15.283243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bb52150>]}
[0m11:49:15.284407 [info ] [Thread-1 (]: 8 of 18 OK created sql view model olist_raw_staging.stg_product_category_name_translation  [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m11:49:15.285148 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_product_category_name_translation
[0m11:49:15.285652 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_products
[0m11:49:15.286198 [info ] [Thread-1 (]: 9 of 18 START sql view model olist_raw_staging.stg_products .................... [RUN]
[0m11:49:15.286851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_product_category_name_translation, now model.olist_analytics.stg_products)
[0m11:49:15.287443 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_products
[0m11:49:15.291331 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_products"
[0m11:49:15.292277 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_products
[0m11:49:15.295642 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_products"
[0m11:49:15.296302 [debug] [Thread-1 (]: On model.olist_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_products"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`products`
),

renamed as (
    select
        product_id,
        product_category_name,
        product_name_lenght as name_length, -- fixing typo in original dataset
        product_description_lenght as description_length,
        product_photos_qty as photos_quantity,
        product_weight_g as weight_g,
        product_length_cm as length_cm,
        product_height_cm as height_cm,
        product_width_cm as width_cm
    from source
)

select * from renamed;


[0m11:49:15.296801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:16.201146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:99e2b80f-a48e-4be6-81bc-fc840c45d6e6&page=queryresults
[0m11:49:17.311646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x315499150>]}
[0m11:49:17.312840 [info ] [Thread-1 (]: 9 of 18 OK created sql view model olist_raw_staging.stg_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m11:49:17.313588 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_products
[0m11:49:17.314119 [debug] [Thread-1 (]: Began running node model.olist_analytics.stg_sellers
[0m11:49:17.314788 [info ] [Thread-1 (]: 10 of 18 START sql view model olist_raw_staging.stg_sellers .................... [RUN]
[0m11:49:17.315338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_products, now model.olist_analytics.stg_sellers)
[0m11:49:17.315797 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.stg_sellers
[0m11:49:17.323055 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.stg_sellers"
[0m11:49:17.324447 [debug] [Thread-1 (]: Began executing node model.olist_analytics.stg_sellers
[0m11:49:17.327524 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.stg_sellers"
[0m11:49:17.328477 [debug] [Thread-1 (]: On model.olist_analytics.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.stg_sellers"} */


  create or replace view `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
  OPTIONS()
  as with source as (
    select * from `stellar-verve-478012-n6`.`olist_raw`.`sellers`
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as zip_code,
        seller_city as city,
        seller_state as state
    from source
)

select * from renamed;


[0m11:49:17.328931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:18.060861 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:8e25fd18-d62b-4389-8fcf-207a130b4c61&page=queryresults
[0m11:49:19.344857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3154aca50>]}
[0m11:49:19.346033 [info ] [Thread-1 (]: 10 of 18 OK created sql view model olist_raw_staging.stg_sellers ............... [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m11:49:19.346798 [debug] [Thread-1 (]: Finished running node model.olist_analytics.stg_sellers
[0m11:49:19.347336 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_customers
[0m11:49:19.347891 [info ] [Thread-1 (]: 11 of 18 START sql table model olist_raw_analytics.dim_customers ............... [RUN]
[0m11:49:19.348558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.stg_sellers, now model.olist_analytics.dim_customers)
[0m11:49:19.349142 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_customers
[0m11:49:19.353018 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_customers"
[0m11:49:19.354348 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_customers
[0m11:49:19.357450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:19.887132 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_customers"
[0m11:49:19.889812 [debug] [Thread-1 (]: On model.olist_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_customers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with customers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_customers`
)

select
    customer_id,        -- Included as requested (Primary Key)
    customer_unique_id, -- The actual person's ID (Foreign Key to user history)
    zip_code,
    city,
    state
from customers
    );
  
[0m11:49:20.807200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:aeb7c877-2d32-48f6-b5ca-7f3818659720&page=queryresults
[0m11:49:24.808411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319ab1450>]}
[0m11:49:24.809802 [info ] [Thread-1 (]: 11 of 18 OK created sql table model olist_raw_analytics.dim_customers .......... [[32mCREATE TABLE (99.4k rows, 8.6 MiB processed)[0m in 5.46s]
[0m11:49:24.810604 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_customers
[0m11:49:24.811153 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_geolocation
[0m11:49:24.811725 [info ] [Thread-1 (]: 12 of 18 START sql table model olist_raw_analytics.dim_geolocation ............. [RUN]
[0m11:49:24.812289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_customers, now model.olist_analytics.dim_geolocation)
[0m11:49:24.812899 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_geolocation
[0m11:49:24.817004 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_geolocation"
[0m11:49:24.819489 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_geolocation
[0m11:49:24.822289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:25.418869 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_geolocation"
[0m11:49:25.419991 [debug] [Thread-1 (]: On model.olist_analytics.dim_geolocation: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_geolocation"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_geolocation`
      
    
    

    OPTIONS()
    as (
      with geolocation as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_geolocation`
)

select
    zip_code,
    -- Calculate the center point of the zip code
    avg(latitude) as latitude,
    avg(longitude) as longitude,
    max(city) as city,
    max(state) as state
from geolocation
group by zip_code
    );
  
[0m11:49:26.349230 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:fb50c80e-7fd4-4a78-8465-31404d921442&page=queryresults
[0m11:49:33.538402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319ab1d10>]}
[0m11:49:33.540323 [info ] [Thread-1 (]: 12 of 18 OK created sql table model olist_raw_analytics.dim_geolocation ........ [[32mCREATE TABLE (19.0k rows, 58.4 MiB processed)[0m in 8.73s]
[0m11:49:33.540931 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_geolocation
[0m11:49:33.541270 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_payments
[0m11:49:33.541643 [info ] [Thread-1 (]: 13 of 18 START sql table model olist_raw_analytics.dim_payments ................ [RUN]
[0m11:49:33.542050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_geolocation, now model.olist_analytics.dim_payments)
[0m11:49:33.542412 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_payments
[0m11:49:33.544792 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_payments"
[0m11:49:33.545422 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_payments
[0m11:49:33.547313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:34.020926 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_payments"
[0m11:49:34.023588 [debug] [Thread-1 (]: On model.olist_analytics.dim_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_payments"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_payments`
      
    
    

    OPTIONS()
    as (
      with payments as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_payments`
)

select
    -- Generate a unique key for each payment row
    concat(order_id, '-', cast(payment_sequential as string)) as payment_sk,
    
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
from payments
    );
  
[0m11:49:34.672912 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:a0162102-386c-40d1-9167-e9fd1e051496&page=queryresults
[0m11:49:41.404612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319b643d0>]}
[0m11:49:41.405414 [info ] [Thread-1 (]: 13 of 18 OK created sql table model olist_raw_analytics.dim_payments ........... [[32mCREATE TABLE (103.9k rows, 5.5 MiB processed)[0m in 7.86s]
[0m11:49:41.405815 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_payments
[0m11:49:41.406057 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_reviews
[0m11:49:41.406362 [info ] [Thread-1 (]: 14 of 18 START sql table model olist_raw_analytics.dim_reviews ................. [RUN]
[0m11:49:41.406632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_payments, now model.olist_analytics.dim_reviews)
[0m11:49:41.406837 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_reviews
[0m11:49:41.408609 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_reviews"
[0m11:49:41.409148 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_reviews
[0m11:49:41.410665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:41.836058 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_reviews"
[0m11:49:41.838455 [debug] [Thread-1 (]: On model.olist_analytics.dim_reviews: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_reviews"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_reviews`
      
    
    

    OPTIONS()
    as (
      with reviews as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_reviews`
)

select
    review_id,
    order_id,
    review_score,
    review_comment_title,
    review_comment_message,
    created_at as review_created_at,
    answer_timestamp as review_answered_at
from reviews
    );
  
[0m11:49:42.609755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:64037e71-382b-4e5e-a899-093b98e1357c&page=queryresults
[0m11:49:47.035969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319bf9350>]}
[0m11:49:47.037968 [info ] [Thread-1 (]: 14 of 18 OK created sql table model olist_raw_analytics.dim_reviews ............ [[32mCREATE TABLE (99.2k rows, 13.8 MiB processed)[0m in 5.63s]
[0m11:49:47.038578 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_reviews
[0m11:49:47.039046 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_order_items
[0m11:49:47.039692 [info ] [Thread-1 (]: 15 of 18 START sql table model olist_raw_analytics.fct_order_items ............. [RUN]
[0m11:49:47.040252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_reviews, now model.olist_analytics.fct_order_items)
[0m11:49:47.040672 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_order_items
[0m11:49:47.045123 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_order_items"
[0m11:49:47.046970 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_order_items
[0m11:49:47.049624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:47.541907 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_order_items"
[0m11:49:47.545290 [debug] [Thread-1 (]: On model.olist_analytics.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_order_items"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_order_items`
      
    
    

    OPTIONS()
    as (
      with items as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_order_items`
),

orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    -- Surrogate Key (Good practice to have a unique string for every row)
    concat(items.order_id, '-', cast(items.order_item_id as string)) as order_item_sk,
    
    items.order_id,
    items.order_item_id,
    items.product_id,
    items.seller_id,
    
    -- We bring in Customer ID from the orders table so we can slice sales by customer location later
    orders.customer_id,
    
    items.price,
    items.freight_value,
    
    -- Calculated Total
    (items.price + items.freight_value) as total_order_value

from items
left join orders 
    on items.order_id = orders.order_id
    );
  
[0m11:49:48.460549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:87b82a15-4857-4b8f-bd60-3bde4282395b&page=queryresults
[0m11:49:53.997280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319ae0350>]}
[0m11:49:53.998617 [info ] [Thread-1 (]: 15 of 18 OK created sql table model olist_raw_analytics.fct_order_items ........ [[32mCREATE TABLE (112.7k rows, 31.6 MiB processed)[0m in 6.96s]
[0m11:49:53.999407 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_order_items
[0m11:49:53.999952 [debug] [Thread-1 (]: Began running node model.olist_analytics.fct_orders
[0m11:49:54.000668 [info ] [Thread-1 (]: 16 of 18 START sql table model olist_raw_analytics.fct_orders .................. [RUN]
[0m11:49:54.001334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_order_items, now model.olist_analytics.fct_orders)
[0m11:49:54.001839 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.fct_orders
[0m11:49:54.005946 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.fct_orders"
[0m11:49:54.007034 [debug] [Thread-1 (]: Began executing node model.olist_analytics.fct_orders
[0m11:49:54.009983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:54.604858 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.fct_orders"
[0m11:49:54.607231 [debug] [Thread-1 (]: On model.olist_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.fct_orders"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`fct_orders`
      
    
    

    OPTIONS()
    as (
      with orders as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_orders`
)

select
    order_id,
    customer_id,
    order_status,
    
    -- Timestamps
    purchase_at,
    approved_at,
    delivered_carrier_at,
    delivered_customer_at,
    estimated_delivery_at,

    -- Calculated Metrics (BigQuery Syntax)
    -- 1. How long did it take to deliver?
    timestamp_diff(delivered_customer_at, purchase_at, hour) as time_to_delivery_hours,
    
    -- 2. Was it late? (Difference between estimated and actual)
    -- Positive numbers mean it arrived early, Negative means it was late
    timestamp_diff(estimated_delivery_at, delivered_customer_at, day) as days_early_or_late

from orders
    );
  
[0m11:49:55.384586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:40f7f952-d750-439f-8339-f98b336bfcdc&page=queryresults
[0m11:49:59.527546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319a7cf50>]}
[0m11:49:59.529347 [info ] [Thread-1 (]: 16 of 18 OK created sql table model olist_raw_analytics.fct_orders ............. [[32mCREATE TABLE (99.4k rows, 16.8 MiB processed)[0m in 5.53s]
[0m11:49:59.530042 [debug] [Thread-1 (]: Finished running node model.olist_analytics.fct_orders
[0m11:49:59.530515 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_products
[0m11:49:59.530998 [info ] [Thread-1 (]: 17 of 18 START sql table model olist_raw_analytics.dim_products ................ [RUN]
[0m11:49:59.531489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.fct_orders, now model.olist_analytics.dim_products)
[0m11:49:59.531993 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_products
[0m11:49:59.536173 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_products"
[0m11:49:59.537211 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_products
[0m11:49:59.539729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:00.130848 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_products"
[0m11:50:00.131590 [debug] [Thread-1 (]: On model.olist_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_products"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with products as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_products`
),

translations as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_product_category_name_translation`
)

select
    p.product_id,
    -- If english name is null, fall back to original name, then to 'Unknown'
    coalesce(t.product_category_name_english, p.product_category_name, 'Unknown') as category_name,
    p.photos_quantity,
    p.weight_g,
    p.length_cm,
    p.height_cm,
    p.width_cm
from products p
left join translations t 
    on p.product_category_name = t.product_category_name
    );
  
[0m11:50:01.055187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:10854b3e-fcd9-461c-9d86-719a610cdbe1&page=queryresults
[0m11:50:03.916891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x319a418d0>]}
[0m11:50:03.918456 [info ] [Thread-1 (]: 17 of 18 OK created sql table model olist_raw_analytics.dim_products ........... [[32mCREATE TABLE (33.0k rows, 2.3 MiB processed)[0m in 4.39s]
[0m11:50:03.919253 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_products
[0m11:50:03.919809 [debug] [Thread-1 (]: Began running node model.olist_analytics.dim_sellers
[0m11:50:03.920523 [info ] [Thread-1 (]: 18 of 18 START sql table model olist_raw_analytics.dim_sellers ................. [RUN]
[0m11:50:03.921190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_analytics.dim_products, now model.olist_analytics.dim_sellers)
[0m11:50:03.921700 [debug] [Thread-1 (]: Began compiling node model.olist_analytics.dim_sellers
[0m11:50:03.925885 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_analytics.dim_sellers"
[0m11:50:03.928717 [debug] [Thread-1 (]: Began executing node model.olist_analytics.dim_sellers
[0m11:50:03.931737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:04.387955 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_analytics.dim_sellers"
[0m11:50:04.389377 [debug] [Thread-1 (]: On model.olist_analytics.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "olist_analytics", "target_name": "dev", "node_id": "model.olist_analytics.dim_sellers"} */

  
    

    create or replace table `stellar-verve-478012-n6`.`olist_raw_analytics`.`dim_sellers`
      
    
    

    OPTIONS()
    as (
      with sellers as (
    select * from `stellar-verve-478012-n6`.`olist_raw_staging`.`stg_sellers`
)

select
    seller_id,
    zip_code,
    city,
    state
from sellers
    );
  
[0m11:50:05.664387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=stellar-verve-478012-n6&j=bq:US:4f991bed-28a5-4103-a685-e720894294ae&page=queryresults
[0m11:50:08.128043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0bb25c8-2a4f-4ca0-890f-9a7a31a6f8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bce65d0>]}
[0m11:50:08.129268 [info ] [Thread-1 (]: 18 of 18 OK created sql table model olist_raw_analytics.dim_sellers ............ [[32mCREATE TABLE (3.1k rows, 170.5 KiB processed)[0m in 4.21s]
[0m11:50:08.129961 [debug] [Thread-1 (]: Finished running node model.olist_analytics.dim_sellers
[0m11:50:08.131610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:50:08.132321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:08.132655 [debug] [MainThread]: Connection 'model.olist_analytics.dim_sellers' was properly closed.
[0m11:50:08.133174 [info ] [MainThread]: 
[0m11:50:08.133557 [info ] [MainThread]: Finished running 9 table models, 9 view models in 0 hours 1 minutes and 11.15 seconds (71.15s).
[0m11:50:08.136828 [debug] [MainThread]: Command end result
[0m11:50:08.162742 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/manifest.json
[0m11:50:08.164562 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/semantic_manifest.json
[0m11:50:08.169538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/govindandhanasekaran/Dev/Github/DSAI-Group2-project/dbt/olist_analytics/target/run_results.json
[0m11:50:08.169802 [info ] [MainThread]: 
[0m11:50:08.170069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:08.170277 [info ] [MainThread]: 
[0m11:50:08.170492 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m11:50:08.170868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 75.14301, "process_in_blocks": "0", "process_kernel_time": 2.841559, "process_mem_max_rss": "470302720", "process_out_blocks": "0", "process_user_time": 5.502758}
[0m11:50:08.171171 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:08.171119 after 75.14 seconds
[0m11:50:08.171456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cca8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d6b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d70310>]}
[0m11:50:08.171693 [debug] [MainThread]: Flushing usage events
[0m11:50:09.960207 [debug] [MainThread]: An error was encountered while trying to flush usage events
